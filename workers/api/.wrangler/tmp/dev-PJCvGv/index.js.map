{
  "version": 3,
  "sources": ["../bundle-IpD7yv/checked-fetch.js", "../../../node_modules/hono/dist/compose.js", "../../../node_modules/hono/dist/request/constants.js", "../../../node_modules/hono/dist/utils/body.js", "../../../node_modules/hono/dist/utils/url.js", "../../../node_modules/hono/dist/request.js", "../../../node_modules/hono/dist/utils/html.js", "../../../node_modules/hono/dist/context.js", "../../../node_modules/hono/dist/router.js", "../../../node_modules/hono/dist/utils/constants.js", "../../../node_modules/hono/dist/hono-base.js", "../../../node_modules/hono/dist/router/reg-exp-router/matcher.js", "../../../node_modules/hono/dist/router/reg-exp-router/node.js", "../../../node_modules/hono/dist/router/reg-exp-router/trie.js", "../../../node_modules/hono/dist/router/reg-exp-router/router.js", "../../../node_modules/hono/dist/router/smart-router/router.js", "../../../node_modules/hono/dist/router/trie-router/node.js", "../../../node_modules/hono/dist/router/trie-router/router.js", "../../../node_modules/hono/dist/hono.js", "../../../node_modules/hono/dist/middleware/cors/index.js", "../../../node_modules/@anthropic-ai/sdk/internal/tslib.mjs", "../../../node_modules/@anthropic-ai/sdk/src/internal/utils/uuid.ts", "../../../node_modules/@anthropic-ai/sdk/src/internal/errors.ts", "../../../node_modules/@anthropic-ai/sdk/src/core/error.ts", "../../../node_modules/@anthropic-ai/sdk/src/internal/utils/values.ts", "../../../node_modules/@anthropic-ai/sdk/src/internal/utils/sleep.ts", "../../../node_modules/@anthropic-ai/sdk/src/version.ts", "../../../node_modules/@anthropic-ai/sdk/src/internal/detect-platform.ts", "../../../node_modules/@anthropic-ai/sdk/src/internal/shims.ts", "../../../node_modules/@anthropic-ai/sdk/src/internal/request-options.ts", "../../../node_modules/@anthropic-ai/sdk/src/internal/utils/bytes.ts", "../../../node_modules/@anthropic-ai/sdk/src/internal/decoders/line.ts", "../../../node_modules/@anthropic-ai/sdk/src/internal/utils/log.ts", "../../../node_modules/@anthropic-ai/sdk/src/core/streaming.ts", "../../../node_modules/@anthropic-ai/sdk/src/internal/parse.ts", "../../../node_modules/@anthropic-ai/sdk/src/core/api-promise.ts", "../../../node_modules/@anthropic-ai/sdk/src/core/pagination.ts", "../../../node_modules/@anthropic-ai/sdk/src/internal/uploads.ts", "../../../node_modules/@anthropic-ai/sdk/src/internal/to-file.ts", "../../../node_modules/@anthropic-ai/sdk/src/core/resource.ts", "../../../node_modules/@anthropic-ai/sdk/src/internal/headers.ts", "../../../node_modules/@anthropic-ai/sdk/src/internal/utils/path.ts", "../../../node_modules/@anthropic-ai/sdk/src/resources/beta/files.ts", "../../../node_modules/@anthropic-ai/sdk/src/resources/beta/models.ts", "../../../node_modules/@anthropic-ai/sdk/src/internal/constants.ts", "../../../node_modules/@anthropic-ai/sdk/src/lib/beta-parser.ts", "../../../node_modules/@anthropic-ai/sdk/src/_vendor/partial-json-parser/parser.ts", "../../../node_modules/@anthropic-ai/sdk/src/lib/BetaMessageStream.ts", "../../../node_modules/@anthropic-ai/sdk/src/lib/tools/CompactionControl.ts", "../../../node_modules/@anthropic-ai/sdk/src/lib/tools/BetaToolRunner.ts", "../../../node_modules/@anthropic-ai/sdk/src/internal/decoders/jsonl.ts", "../../../node_modules/@anthropic-ai/sdk/src/resources/beta/messages/batches.ts", "../../../node_modules/@anthropic-ai/sdk/src/resources/beta/messages/messages.ts", "../../../node_modules/@anthropic-ai/sdk/src/resources/beta/skills/versions.ts", "../../../node_modules/@anthropic-ai/sdk/src/resources/beta/skills/skills.ts", "../../../node_modules/@anthropic-ai/sdk/src/resources/beta/beta.ts", "../../../node_modules/@anthropic-ai/sdk/src/resources/completions.ts", "../../../node_modules/@anthropic-ai/sdk/src/lib/MessageStream.ts", "../../../node_modules/@anthropic-ai/sdk/src/resources/messages/batches.ts", "../../../node_modules/@anthropic-ai/sdk/src/resources/messages/messages.ts", "../../../node_modules/@anthropic-ai/sdk/src/resources/models.ts", "../../../node_modules/@anthropic-ai/sdk/src/internal/utils/env.ts", "../../../node_modules/@anthropic-ai/sdk/src/client.ts", "../../../src/index.ts", "../../../node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "../../../node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts", "../bundle-IpD7yv/middleware-insertion-facade.js", "../../../node_modules/wrangler/templates/middleware/common.ts", "../bundle-IpD7yv/middleware-loader.entry.ts"],
  "sourceRoot": "C:\\Users\\jrrhi\\workspace\\LeukemiaLens\\workers\\api\\.wrangler\\tmp\\dev-PJCvGv",
  "sourcesContent": ["const urls = new Set();\n\nfunction checkURL(request, init) {\n\tconst url =\n\t\trequest instanceof URL\n\t\t\t? request\n\t\t\t: new URL(\n\t\t\t\t\t(typeof request === \"string\"\n\t\t\t\t\t\t? new Request(request, init)\n\t\t\t\t\t\t: request\n\t\t\t\t\t).url\n\t\t\t\t);\n\tif (url.port && url.port !== \"443\" && url.protocol === \"https:\") {\n\t\tif (!urls.has(url.toString())) {\n\t\t\turls.add(url.toString());\n\t\t\tconsole.warn(\n\t\t\t\t`WARNING: known issue with \\`fetch()\\` requests to custom HTTPS ports in published Workers:\\n` +\n\t\t\t\t\t` - ${url.toString()} - the custom port will be ignored when the Worker is published using the \\`wrangler deploy\\` command.\\n`\n\t\t\t);\n\t\t}\n\t}\n}\n\nglobalThis.fetch = new Proxy(globalThis.fetch, {\n\tapply(target, thisArg, argArray) {\n\t\tconst [request, init] = argArray;\n\t\tcheckURL(request, init);\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n", "// src/compose.ts\nvar compose = (middleware, onError, onNotFound) => {\n  return (context, next) => {\n    let index = -1;\n    return dispatch(0);\n    async function dispatch(i) {\n      if (i <= index) {\n        throw new Error(\"next() called multiple times\");\n      }\n      index = i;\n      let res;\n      let isError = false;\n      let handler;\n      if (middleware[i]) {\n        handler = middleware[i][0][0];\n        context.req.routeIndex = i;\n      } else {\n        handler = i === middleware.length && next || void 0;\n      }\n      if (handler) {\n        try {\n          res = await handler(context, () => dispatch(i + 1));\n        } catch (err) {\n          if (err instanceof Error && onError) {\n            context.error = err;\n            res = await onError(err, context);\n            isError = true;\n          } else {\n            throw err;\n          }\n        }\n      } else {\n        if (context.finalized === false && onNotFound) {\n          res = await onNotFound(context);\n        }\n      }\n      if (res && (context.finalized === false || isError)) {\n        context.res = res;\n      }\n      return context;\n    }\n  };\n};\nexport {\n  compose\n};\n", "// src/request/constants.ts\nvar GET_MATCH_RESULT = Symbol();\nexport {\n  GET_MATCH_RESULT\n};\n", "// src/utils/body.ts\nimport { HonoRequest } from \"../request.js\";\nvar parseBody = async (request, options = /* @__PURE__ */ Object.create(null)) => {\n  const { all = false, dot = false } = options;\n  const headers = request instanceof HonoRequest ? request.raw.headers : request.headers;\n  const contentType = headers.get(\"Content-Type\");\n  if (contentType?.startsWith(\"multipart/form-data\") || contentType?.startsWith(\"application/x-www-form-urlencoded\")) {\n    return parseFormData(request, { all, dot });\n  }\n  return {};\n};\nasync function parseFormData(request, options) {\n  const formData = await request.formData();\n  if (formData) {\n    return convertFormDataToBodyData(formData, options);\n  }\n  return {};\n}\nfunction convertFormDataToBodyData(formData, options) {\n  const form = /* @__PURE__ */ Object.create(null);\n  formData.forEach((value, key) => {\n    const shouldParseAllValues = options.all || key.endsWith(\"[]\");\n    if (!shouldParseAllValues) {\n      form[key] = value;\n    } else {\n      handleParsingAllValues(form, key, value);\n    }\n  });\n  if (options.dot) {\n    Object.entries(form).forEach(([key, value]) => {\n      const shouldParseDotValues = key.includes(\".\");\n      if (shouldParseDotValues) {\n        handleParsingNestedValues(form, key, value);\n        delete form[key];\n      }\n    });\n  }\n  return form;\n}\nvar handleParsingAllValues = (form, key, value) => {\n  if (form[key] !== void 0) {\n    if (Array.isArray(form[key])) {\n      ;\n      form[key].push(value);\n    } else {\n      form[key] = [form[key], value];\n    }\n  } else {\n    if (!key.endsWith(\"[]\")) {\n      form[key] = value;\n    } else {\n      form[key] = [value];\n    }\n  }\n};\nvar handleParsingNestedValues = (form, key, value) => {\n  let nestedForm = form;\n  const keys = key.split(\".\");\n  keys.forEach((key2, index) => {\n    if (index === keys.length - 1) {\n      nestedForm[key2] = value;\n    } else {\n      if (!nestedForm[key2] || typeof nestedForm[key2] !== \"object\" || Array.isArray(nestedForm[key2]) || nestedForm[key2] instanceof File) {\n        nestedForm[key2] = /* @__PURE__ */ Object.create(null);\n      }\n      nestedForm = nestedForm[key2];\n    }\n  });\n};\nexport {\n  parseBody\n};\n", "// src/utils/url.ts\nvar splitPath = (path) => {\n  const paths = path.split(\"/\");\n  if (paths[0] === \"\") {\n    paths.shift();\n  }\n  return paths;\n};\nvar splitRoutingPath = (routePath) => {\n  const { groups, path } = extractGroupsFromPath(routePath);\n  const paths = splitPath(path);\n  return replaceGroupMarks(paths, groups);\n};\nvar extractGroupsFromPath = (path) => {\n  const groups = [];\n  path = path.replace(/\\{[^}]+\\}/g, (match, index) => {\n    const mark = `@${index}`;\n    groups.push([mark, match]);\n    return mark;\n  });\n  return { groups, path };\n};\nvar replaceGroupMarks = (paths, groups) => {\n  for (let i = groups.length - 1; i >= 0; i--) {\n    const [mark] = groups[i];\n    for (let j = paths.length - 1; j >= 0; j--) {\n      if (paths[j].includes(mark)) {\n        paths[j] = paths[j].replace(mark, groups[i][1]);\n        break;\n      }\n    }\n  }\n  return paths;\n};\nvar patternCache = {};\nvar getPattern = (label, next) => {\n  if (label === \"*\") {\n    return \"*\";\n  }\n  const match = label.match(/^\\:([^\\{\\}]+)(?:\\{(.+)\\})?$/);\n  if (match) {\n    const cacheKey = `${label}#${next}`;\n    if (!patternCache[cacheKey]) {\n      if (match[2]) {\n        patternCache[cacheKey] = next && next[0] !== \":\" && next[0] !== \"*\" ? [cacheKey, match[1], new RegExp(`^${match[2]}(?=/${next})`)] : [label, match[1], new RegExp(`^${match[2]}$`)];\n      } else {\n        patternCache[cacheKey] = [label, match[1], true];\n      }\n    }\n    return patternCache[cacheKey];\n  }\n  return null;\n};\nvar tryDecode = (str, decoder) => {\n  try {\n    return decoder(str);\n  } catch {\n    return str.replace(/(?:%[0-9A-Fa-f]{2})+/g, (match) => {\n      try {\n        return decoder(match);\n      } catch {\n        return match;\n      }\n    });\n  }\n};\nvar tryDecodeURI = (str) => tryDecode(str, decodeURI);\nvar getPath = (request) => {\n  const url = request.url;\n  const start = url.indexOf(\"/\", url.indexOf(\":\") + 4);\n  let i = start;\n  for (; i < url.length; i++) {\n    const charCode = url.charCodeAt(i);\n    if (charCode === 37) {\n      const queryIndex = url.indexOf(\"?\", i);\n      const path = url.slice(start, queryIndex === -1 ? void 0 : queryIndex);\n      return tryDecodeURI(path.includes(\"%25\") ? path.replace(/%25/g, \"%2525\") : path);\n    } else if (charCode === 63) {\n      break;\n    }\n  }\n  return url.slice(start, i);\n};\nvar getQueryStrings = (url) => {\n  const queryIndex = url.indexOf(\"?\", 8);\n  return queryIndex === -1 ? \"\" : \"?\" + url.slice(queryIndex + 1);\n};\nvar getPathNoStrict = (request) => {\n  const result = getPath(request);\n  return result.length > 1 && result.at(-1) === \"/\" ? result.slice(0, -1) : result;\n};\nvar mergePath = (base, sub, ...rest) => {\n  if (rest.length) {\n    sub = mergePath(sub, ...rest);\n  }\n  return `${base?.[0] === \"/\" ? \"\" : \"/\"}${base}${sub === \"/\" ? \"\" : `${base?.at(-1) === \"/\" ? \"\" : \"/\"}${sub?.[0] === \"/\" ? sub.slice(1) : sub}`}`;\n};\nvar checkOptionalParameter = (path) => {\n  if (path.charCodeAt(path.length - 1) !== 63 || !path.includes(\":\")) {\n    return null;\n  }\n  const segments = path.split(\"/\");\n  const results = [];\n  let basePath = \"\";\n  segments.forEach((segment) => {\n    if (segment !== \"\" && !/\\:/.test(segment)) {\n      basePath += \"/\" + segment;\n    } else if (/\\:/.test(segment)) {\n      if (/\\?/.test(segment)) {\n        if (results.length === 0 && basePath === \"\") {\n          results.push(\"/\");\n        } else {\n          results.push(basePath);\n        }\n        const optionalSegment = segment.replace(\"?\", \"\");\n        basePath += \"/\" + optionalSegment;\n        results.push(basePath);\n      } else {\n        basePath += \"/\" + segment;\n      }\n    }\n  });\n  return results.filter((v, i, a) => a.indexOf(v) === i);\n};\nvar _decodeURI = (value) => {\n  if (!/[%+]/.test(value)) {\n    return value;\n  }\n  if (value.indexOf(\"+\") !== -1) {\n    value = value.replace(/\\+/g, \" \");\n  }\n  return value.indexOf(\"%\") !== -1 ? tryDecode(value, decodeURIComponent_) : value;\n};\nvar _getQueryParam = (url, key, multiple) => {\n  let encoded;\n  if (!multiple && key && !/[%+]/.test(key)) {\n    let keyIndex2 = url.indexOf(\"?\", 8);\n    if (keyIndex2 === -1) {\n      return void 0;\n    }\n    if (!url.startsWith(key, keyIndex2 + 1)) {\n      keyIndex2 = url.indexOf(`&${key}`, keyIndex2 + 1);\n    }\n    while (keyIndex2 !== -1) {\n      const trailingKeyCode = url.charCodeAt(keyIndex2 + key.length + 1);\n      if (trailingKeyCode === 61) {\n        const valueIndex = keyIndex2 + key.length + 2;\n        const endIndex = url.indexOf(\"&\", valueIndex);\n        return _decodeURI(url.slice(valueIndex, endIndex === -1 ? void 0 : endIndex));\n      } else if (trailingKeyCode == 38 || isNaN(trailingKeyCode)) {\n        return \"\";\n      }\n      keyIndex2 = url.indexOf(`&${key}`, keyIndex2 + 1);\n    }\n    encoded = /[%+]/.test(url);\n    if (!encoded) {\n      return void 0;\n    }\n  }\n  const results = {};\n  encoded ??= /[%+]/.test(url);\n  let keyIndex = url.indexOf(\"?\", 8);\n  while (keyIndex !== -1) {\n    const nextKeyIndex = url.indexOf(\"&\", keyIndex + 1);\n    let valueIndex = url.indexOf(\"=\", keyIndex);\n    if (valueIndex > nextKeyIndex && nextKeyIndex !== -1) {\n      valueIndex = -1;\n    }\n    let name = url.slice(\n      keyIndex + 1,\n      valueIndex === -1 ? nextKeyIndex === -1 ? void 0 : nextKeyIndex : valueIndex\n    );\n    if (encoded) {\n      name = _decodeURI(name);\n    }\n    keyIndex = nextKeyIndex;\n    if (name === \"\") {\n      continue;\n    }\n    let value;\n    if (valueIndex === -1) {\n      value = \"\";\n    } else {\n      value = url.slice(valueIndex + 1, nextKeyIndex === -1 ? void 0 : nextKeyIndex);\n      if (encoded) {\n        value = _decodeURI(value);\n      }\n    }\n    if (multiple) {\n      if (!(results[name] && Array.isArray(results[name]))) {\n        results[name] = [];\n      }\n      ;\n      results[name].push(value);\n    } else {\n      results[name] ??= value;\n    }\n  }\n  return key ? results[key] : results;\n};\nvar getQueryParam = _getQueryParam;\nvar getQueryParams = (url, key) => {\n  return _getQueryParam(url, key, true);\n};\nvar decodeURIComponent_ = decodeURIComponent;\nexport {\n  checkOptionalParameter,\n  decodeURIComponent_,\n  getPath,\n  getPathNoStrict,\n  getPattern,\n  getQueryParam,\n  getQueryParams,\n  getQueryStrings,\n  mergePath,\n  splitPath,\n  splitRoutingPath,\n  tryDecode\n};\n", "// src/request.ts\nimport { HTTPException } from \"./http-exception.js\";\nimport { GET_MATCH_RESULT } from \"./request/constants.js\";\nimport { parseBody } from \"./utils/body.js\";\nimport { decodeURIComponent_, getQueryParam, getQueryParams, tryDecode } from \"./utils/url.js\";\nvar tryDecodeURIComponent = (str) => tryDecode(str, decodeURIComponent_);\nvar HonoRequest = class {\n  raw;\n  #validatedData;\n  #matchResult;\n  routeIndex = 0;\n  path;\n  bodyCache = {};\n  constructor(request, path = \"/\", matchResult = [[]]) {\n    this.raw = request;\n    this.path = path;\n    this.#matchResult = matchResult;\n    this.#validatedData = {};\n  }\n  param(key) {\n    return key ? this.#getDecodedParam(key) : this.#getAllDecodedParams();\n  }\n  #getDecodedParam(key) {\n    const paramKey = this.#matchResult[0][this.routeIndex][1][key];\n    const param = this.#getParamValue(paramKey);\n    return param && /\\%/.test(param) ? tryDecodeURIComponent(param) : param;\n  }\n  #getAllDecodedParams() {\n    const decoded = {};\n    const keys = Object.keys(this.#matchResult[0][this.routeIndex][1]);\n    for (const key of keys) {\n      const value = this.#getParamValue(this.#matchResult[0][this.routeIndex][1][key]);\n      if (value !== void 0) {\n        decoded[key] = /\\%/.test(value) ? tryDecodeURIComponent(value) : value;\n      }\n    }\n    return decoded;\n  }\n  #getParamValue(paramKey) {\n    return this.#matchResult[1] ? this.#matchResult[1][paramKey] : paramKey;\n  }\n  query(key) {\n    return getQueryParam(this.url, key);\n  }\n  queries(key) {\n    return getQueryParams(this.url, key);\n  }\n  header(name) {\n    if (name) {\n      return this.raw.headers.get(name) ?? void 0;\n    }\n    const headerData = {};\n    this.raw.headers.forEach((value, key) => {\n      headerData[key] = value;\n    });\n    return headerData;\n  }\n  async parseBody(options) {\n    return this.bodyCache.parsedBody ??= await parseBody(this, options);\n  }\n  #cachedBody = (key) => {\n    const { bodyCache, raw } = this;\n    const cachedBody = bodyCache[key];\n    if (cachedBody) {\n      return cachedBody;\n    }\n    const anyCachedKey = Object.keys(bodyCache)[0];\n    if (anyCachedKey) {\n      return bodyCache[anyCachedKey].then((body) => {\n        if (anyCachedKey === \"json\") {\n          body = JSON.stringify(body);\n        }\n        return new Response(body)[key]();\n      });\n    }\n    return bodyCache[key] = raw[key]();\n  };\n  json() {\n    return this.#cachedBody(\"text\").then((text) => JSON.parse(text));\n  }\n  text() {\n    return this.#cachedBody(\"text\");\n  }\n  arrayBuffer() {\n    return this.#cachedBody(\"arrayBuffer\");\n  }\n  blob() {\n    return this.#cachedBody(\"blob\");\n  }\n  formData() {\n    return this.#cachedBody(\"formData\");\n  }\n  addValidatedData(target, data) {\n    this.#validatedData[target] = data;\n  }\n  valid(target) {\n    return this.#validatedData[target];\n  }\n  get url() {\n    return this.raw.url;\n  }\n  get method() {\n    return this.raw.method;\n  }\n  get [GET_MATCH_RESULT]() {\n    return this.#matchResult;\n  }\n  get matchedRoutes() {\n    return this.#matchResult[0].map(([[, route]]) => route);\n  }\n  get routePath() {\n    return this.#matchResult[0].map(([[, route]]) => route)[this.routeIndex].path;\n  }\n};\nvar cloneRawRequest = async (req) => {\n  if (!req.raw.bodyUsed) {\n    return req.raw.clone();\n  }\n  const cacheKey = Object.keys(req.bodyCache)[0];\n  if (!cacheKey) {\n    throw new HTTPException(500, {\n      message: \"Cannot clone request: body was already consumed and not cached. Please use HonoRequest methods (e.g., req.json(), req.text()) instead of consuming req.raw directly.\"\n    });\n  }\n  const requestInit = {\n    body: await req[cacheKey](),\n    cache: req.raw.cache,\n    credentials: req.raw.credentials,\n    headers: req.header(),\n    integrity: req.raw.integrity,\n    keepalive: req.raw.keepalive,\n    method: req.method,\n    mode: req.raw.mode,\n    redirect: req.raw.redirect,\n    referrer: req.raw.referrer,\n    referrerPolicy: req.raw.referrerPolicy,\n    signal: req.raw.signal\n  };\n  return new Request(req.url, requestInit);\n};\nexport {\n  HonoRequest,\n  cloneRawRequest\n};\n", "// src/utils/html.ts\nvar HtmlEscapedCallbackPhase = {\n  Stringify: 1,\n  BeforeStream: 2,\n  Stream: 3\n};\nvar raw = (value, callbacks) => {\n  const escapedString = new String(value);\n  escapedString.isEscaped = true;\n  escapedString.callbacks = callbacks;\n  return escapedString;\n};\nvar escapeRe = /[&<>'\"]/;\nvar stringBufferToString = async (buffer, callbacks) => {\n  let str = \"\";\n  callbacks ||= [];\n  const resolvedBuffer = await Promise.all(buffer);\n  for (let i = resolvedBuffer.length - 1; ; i--) {\n    str += resolvedBuffer[i];\n    i--;\n    if (i < 0) {\n      break;\n    }\n    let r = resolvedBuffer[i];\n    if (typeof r === \"object\") {\n      callbacks.push(...r.callbacks || []);\n    }\n    const isEscaped = r.isEscaped;\n    r = await (typeof r === \"object\" ? r.toString() : r);\n    if (typeof r === \"object\") {\n      callbacks.push(...r.callbacks || []);\n    }\n    if (r.isEscaped ?? isEscaped) {\n      str += r;\n    } else {\n      const buf = [str];\n      escapeToBuffer(r, buf);\n      str = buf[0];\n    }\n  }\n  return raw(str, callbacks);\n};\nvar escapeToBuffer = (str, buffer) => {\n  const match = str.search(escapeRe);\n  if (match === -1) {\n    buffer[0] += str;\n    return;\n  }\n  let escape;\n  let index;\n  let lastIndex = 0;\n  for (index = match; index < str.length; index++) {\n    switch (str.charCodeAt(index)) {\n      case 34:\n        escape = \"&quot;\";\n        break;\n      case 39:\n        escape = \"&#39;\";\n        break;\n      case 38:\n        escape = \"&amp;\";\n        break;\n      case 60:\n        escape = \"&lt;\";\n        break;\n      case 62:\n        escape = \"&gt;\";\n        break;\n      default:\n        continue;\n    }\n    buffer[0] += str.substring(lastIndex, index) + escape;\n    lastIndex = index + 1;\n  }\n  buffer[0] += str.substring(lastIndex, index);\n};\nvar resolveCallbackSync = (str) => {\n  const callbacks = str.callbacks;\n  if (!callbacks?.length) {\n    return str;\n  }\n  const buffer = [str];\n  const context = {};\n  callbacks.forEach((c) => c({ phase: HtmlEscapedCallbackPhase.Stringify, buffer, context }));\n  return buffer[0];\n};\nvar resolveCallback = async (str, phase, preserveCallbacks, context, buffer) => {\n  if (typeof str === \"object\" && !(str instanceof String)) {\n    if (!(str instanceof Promise)) {\n      str = str.toString();\n    }\n    if (str instanceof Promise) {\n      str = await str;\n    }\n  }\n  const callbacks = str.callbacks;\n  if (!callbacks?.length) {\n    return Promise.resolve(str);\n  }\n  if (buffer) {\n    buffer[0] += str;\n  } else {\n    buffer = [str];\n  }\n  const resStr = Promise.all(callbacks.map((c) => c({ phase, buffer, context }))).then(\n    (res) => Promise.all(\n      res.filter(Boolean).map((str2) => resolveCallback(str2, phase, false, context, buffer))\n    ).then(() => buffer[0])\n  );\n  if (preserveCallbacks) {\n    return raw(await resStr, callbacks);\n  } else {\n    return resStr;\n  }\n};\nexport {\n  HtmlEscapedCallbackPhase,\n  escapeToBuffer,\n  raw,\n  resolveCallback,\n  resolveCallbackSync,\n  stringBufferToString\n};\n", "// src/context.ts\nimport { HonoRequest } from \"./request.js\";\nimport { HtmlEscapedCallbackPhase, resolveCallback } from \"./utils/html.js\";\nvar TEXT_PLAIN = \"text/plain; charset=UTF-8\";\nvar setDefaultContentType = (contentType, headers) => {\n  return {\n    \"Content-Type\": contentType,\n    ...headers\n  };\n};\nvar Context = class {\n  #rawRequest;\n  #req;\n  env = {};\n  #var;\n  finalized = false;\n  error;\n  #status;\n  #executionCtx;\n  #res;\n  #layout;\n  #renderer;\n  #notFoundHandler;\n  #preparedHeaders;\n  #matchResult;\n  #path;\n  constructor(req, options) {\n    this.#rawRequest = req;\n    if (options) {\n      this.#executionCtx = options.executionCtx;\n      this.env = options.env;\n      this.#notFoundHandler = options.notFoundHandler;\n      this.#path = options.path;\n      this.#matchResult = options.matchResult;\n    }\n  }\n  get req() {\n    this.#req ??= new HonoRequest(this.#rawRequest, this.#path, this.#matchResult);\n    return this.#req;\n  }\n  get event() {\n    if (this.#executionCtx && \"respondWith\" in this.#executionCtx) {\n      return this.#executionCtx;\n    } else {\n      throw Error(\"This context has no FetchEvent\");\n    }\n  }\n  get executionCtx() {\n    if (this.#executionCtx) {\n      return this.#executionCtx;\n    } else {\n      throw Error(\"This context has no ExecutionContext\");\n    }\n  }\n  get res() {\n    return this.#res ||= new Response(null, {\n      headers: this.#preparedHeaders ??= new Headers()\n    });\n  }\n  set res(_res) {\n    if (this.#res && _res) {\n      _res = new Response(_res.body, _res);\n      for (const [k, v] of this.#res.headers.entries()) {\n        if (k === \"content-type\") {\n          continue;\n        }\n        if (k === \"set-cookie\") {\n          const cookies = this.#res.headers.getSetCookie();\n          _res.headers.delete(\"set-cookie\");\n          for (const cookie of cookies) {\n            _res.headers.append(\"set-cookie\", cookie);\n          }\n        } else {\n          _res.headers.set(k, v);\n        }\n      }\n    }\n    this.#res = _res;\n    this.finalized = true;\n  }\n  render = (...args) => {\n    this.#renderer ??= (content) => this.html(content);\n    return this.#renderer(...args);\n  };\n  setLayout = (layout) => this.#layout = layout;\n  getLayout = () => this.#layout;\n  setRenderer = (renderer) => {\n    this.#renderer = renderer;\n  };\n  header = (name, value, options) => {\n    if (this.finalized) {\n      this.#res = new Response(this.#res.body, this.#res);\n    }\n    const headers = this.#res ? this.#res.headers : this.#preparedHeaders ??= new Headers();\n    if (value === void 0) {\n      headers.delete(name);\n    } else if (options?.append) {\n      headers.append(name, value);\n    } else {\n      headers.set(name, value);\n    }\n  };\n  status = (status) => {\n    this.#status = status;\n  };\n  set = (key, value) => {\n    this.#var ??= /* @__PURE__ */ new Map();\n    this.#var.set(key, value);\n  };\n  get = (key) => {\n    return this.#var ? this.#var.get(key) : void 0;\n  };\n  get var() {\n    if (!this.#var) {\n      return {};\n    }\n    return Object.fromEntries(this.#var);\n  }\n  #newResponse(data, arg, headers) {\n    const responseHeaders = this.#res ? new Headers(this.#res.headers) : this.#preparedHeaders ?? new Headers();\n    if (typeof arg === \"object\" && \"headers\" in arg) {\n      const argHeaders = arg.headers instanceof Headers ? arg.headers : new Headers(arg.headers);\n      for (const [key, value] of argHeaders) {\n        if (key.toLowerCase() === \"set-cookie\") {\n          responseHeaders.append(key, value);\n        } else {\n          responseHeaders.set(key, value);\n        }\n      }\n    }\n    if (headers) {\n      for (const [k, v] of Object.entries(headers)) {\n        if (typeof v === \"string\") {\n          responseHeaders.set(k, v);\n        } else {\n          responseHeaders.delete(k);\n          for (const v2 of v) {\n            responseHeaders.append(k, v2);\n          }\n        }\n      }\n    }\n    const status = typeof arg === \"number\" ? arg : arg?.status ?? this.#status;\n    return new Response(data, { status, headers: responseHeaders });\n  }\n  newResponse = (...args) => this.#newResponse(...args);\n  body = (data, arg, headers) => this.#newResponse(data, arg, headers);\n  text = (text, arg, headers) => {\n    return !this.#preparedHeaders && !this.#status && !arg && !headers && !this.finalized ? new Response(text) : this.#newResponse(\n      text,\n      arg,\n      setDefaultContentType(TEXT_PLAIN, headers)\n    );\n  };\n  json = (object, arg, headers) => {\n    return this.#newResponse(\n      JSON.stringify(object),\n      arg,\n      setDefaultContentType(\"application/json\", headers)\n    );\n  };\n  html = (html, arg, headers) => {\n    const res = (html2) => this.#newResponse(html2, arg, setDefaultContentType(\"text/html; charset=UTF-8\", headers));\n    return typeof html === \"object\" ? resolveCallback(html, HtmlEscapedCallbackPhase.Stringify, false, {}).then(res) : res(html);\n  };\n  redirect = (location, status) => {\n    const locationString = String(location);\n    this.header(\n      \"Location\",\n      !/[^\\x00-\\xFF]/.test(locationString) ? locationString : encodeURI(locationString)\n    );\n    return this.newResponse(null, status ?? 302);\n  };\n  notFound = () => {\n    this.#notFoundHandler ??= () => new Response();\n    return this.#notFoundHandler(this);\n  };\n};\nexport {\n  Context,\n  TEXT_PLAIN\n};\n", "// src/router.ts\nvar METHOD_NAME_ALL = \"ALL\";\nvar METHOD_NAME_ALL_LOWERCASE = \"all\";\nvar METHODS = [\"get\", \"post\", \"put\", \"delete\", \"options\", \"patch\"];\nvar MESSAGE_MATCHER_IS_ALREADY_BUILT = \"Can not add a route since the matcher is already built.\";\nvar UnsupportedPathError = class extends Error {\n};\nexport {\n  MESSAGE_MATCHER_IS_ALREADY_BUILT,\n  METHODS,\n  METHOD_NAME_ALL,\n  METHOD_NAME_ALL_LOWERCASE,\n  UnsupportedPathError\n};\n", "// src/utils/constants.ts\nvar COMPOSED_HANDLER = \"__COMPOSED_HANDLER\";\nexport {\n  COMPOSED_HANDLER\n};\n", "// src/hono-base.ts\nimport { compose } from \"./compose.js\";\nimport { Context } from \"./context.js\";\nimport { METHODS, METHOD_NAME_ALL, METHOD_NAME_ALL_LOWERCASE } from \"./router.js\";\nimport { COMPOSED_HANDLER } from \"./utils/constants.js\";\nimport { getPath, getPathNoStrict, mergePath } from \"./utils/url.js\";\nvar notFoundHandler = (c) => {\n  return c.text(\"404 Not Found\", 404);\n};\nvar errorHandler = (err, c) => {\n  if (\"getResponse\" in err) {\n    const res = err.getResponse();\n    return c.newResponse(res.body, res);\n  }\n  console.error(err);\n  return c.text(\"Internal Server Error\", 500);\n};\nvar Hono = class {\n  get;\n  post;\n  put;\n  delete;\n  options;\n  patch;\n  all;\n  on;\n  use;\n  router;\n  getPath;\n  _basePath = \"/\";\n  #path = \"/\";\n  routes = [];\n  constructor(options = {}) {\n    const allMethods = [...METHODS, METHOD_NAME_ALL_LOWERCASE];\n    allMethods.forEach((method) => {\n      this[method] = (args1, ...args) => {\n        if (typeof args1 === \"string\") {\n          this.#path = args1;\n        } else {\n          this.#addRoute(method, this.#path, args1);\n        }\n        args.forEach((handler) => {\n          this.#addRoute(method, this.#path, handler);\n        });\n        return this;\n      };\n    });\n    this.on = (method, path, ...handlers) => {\n      for (const p of [path].flat()) {\n        this.#path = p;\n        for (const m of [method].flat()) {\n          handlers.map((handler) => {\n            this.#addRoute(m.toUpperCase(), this.#path, handler);\n          });\n        }\n      }\n      return this;\n    };\n    this.use = (arg1, ...handlers) => {\n      if (typeof arg1 === \"string\") {\n        this.#path = arg1;\n      } else {\n        this.#path = \"*\";\n        handlers.unshift(arg1);\n      }\n      handlers.forEach((handler) => {\n        this.#addRoute(METHOD_NAME_ALL, this.#path, handler);\n      });\n      return this;\n    };\n    const { strict, ...optionsWithoutStrict } = options;\n    Object.assign(this, optionsWithoutStrict);\n    this.getPath = strict ?? true ? options.getPath ?? getPath : getPathNoStrict;\n  }\n  #clone() {\n    const clone = new Hono({\n      router: this.router,\n      getPath: this.getPath\n    });\n    clone.errorHandler = this.errorHandler;\n    clone.#notFoundHandler = this.#notFoundHandler;\n    clone.routes = this.routes;\n    return clone;\n  }\n  #notFoundHandler = notFoundHandler;\n  errorHandler = errorHandler;\n  route(path, app) {\n    const subApp = this.basePath(path);\n    app.routes.map((r) => {\n      let handler;\n      if (app.errorHandler === errorHandler) {\n        handler = r.handler;\n      } else {\n        handler = async (c, next) => (await compose([], app.errorHandler)(c, () => r.handler(c, next))).res;\n        handler[COMPOSED_HANDLER] = r.handler;\n      }\n      subApp.#addRoute(r.method, r.path, handler);\n    });\n    return this;\n  }\n  basePath(path) {\n    const subApp = this.#clone();\n    subApp._basePath = mergePath(this._basePath, path);\n    return subApp;\n  }\n  onError = (handler) => {\n    this.errorHandler = handler;\n    return this;\n  };\n  notFound = (handler) => {\n    this.#notFoundHandler = handler;\n    return this;\n  };\n  mount(path, applicationHandler, options) {\n    let replaceRequest;\n    let optionHandler;\n    if (options) {\n      if (typeof options === \"function\") {\n        optionHandler = options;\n      } else {\n        optionHandler = options.optionHandler;\n        if (options.replaceRequest === false) {\n          replaceRequest = (request) => request;\n        } else {\n          replaceRequest = options.replaceRequest;\n        }\n      }\n    }\n    const getOptions = optionHandler ? (c) => {\n      const options2 = optionHandler(c);\n      return Array.isArray(options2) ? options2 : [options2];\n    } : (c) => {\n      let executionContext = void 0;\n      try {\n        executionContext = c.executionCtx;\n      } catch {\n      }\n      return [c.env, executionContext];\n    };\n    replaceRequest ||= (() => {\n      const mergedPath = mergePath(this._basePath, path);\n      const pathPrefixLength = mergedPath === \"/\" ? 0 : mergedPath.length;\n      return (request) => {\n        const url = new URL(request.url);\n        url.pathname = url.pathname.slice(pathPrefixLength) || \"/\";\n        return new Request(url, request);\n      };\n    })();\n    const handler = async (c, next) => {\n      const res = await applicationHandler(replaceRequest(c.req.raw), ...getOptions(c));\n      if (res) {\n        return res;\n      }\n      await next();\n    };\n    this.#addRoute(METHOD_NAME_ALL, mergePath(path, \"*\"), handler);\n    return this;\n  }\n  #addRoute(method, path, handler) {\n    method = method.toUpperCase();\n    path = mergePath(this._basePath, path);\n    const r = { basePath: this._basePath, path, method, handler };\n    this.router.add(method, path, [handler, r]);\n    this.routes.push(r);\n  }\n  #handleError(err, c) {\n    if (err instanceof Error) {\n      return this.errorHandler(err, c);\n    }\n    throw err;\n  }\n  #dispatch(request, executionCtx, env, method) {\n    if (method === \"HEAD\") {\n      return (async () => new Response(null, await this.#dispatch(request, executionCtx, env, \"GET\")))();\n    }\n    const path = this.getPath(request, { env });\n    const matchResult = this.router.match(method, path);\n    const c = new Context(request, {\n      path,\n      matchResult,\n      env,\n      executionCtx,\n      notFoundHandler: this.#notFoundHandler\n    });\n    if (matchResult[0].length === 1) {\n      let res;\n      try {\n        res = matchResult[0][0][0][0](c, async () => {\n          c.res = await this.#notFoundHandler(c);\n        });\n      } catch (err) {\n        return this.#handleError(err, c);\n      }\n      return res instanceof Promise ? res.then(\n        (resolved) => resolved || (c.finalized ? c.res : this.#notFoundHandler(c))\n      ).catch((err) => this.#handleError(err, c)) : res ?? this.#notFoundHandler(c);\n    }\n    const composed = compose(matchResult[0], this.errorHandler, this.#notFoundHandler);\n    return (async () => {\n      try {\n        const context = await composed(c);\n        if (!context.finalized) {\n          throw new Error(\n            \"Context is not finalized. Did you forget to return a Response object or `await next()`?\"\n          );\n        }\n        return context.res;\n      } catch (err) {\n        return this.#handleError(err, c);\n      }\n    })();\n  }\n  fetch = (request, ...rest) => {\n    return this.#dispatch(request, rest[1], rest[0], request.method);\n  };\n  request = (input, requestInit, Env, executionCtx) => {\n    if (input instanceof Request) {\n      return this.fetch(requestInit ? new Request(input, requestInit) : input, Env, executionCtx);\n    }\n    input = input.toString();\n    return this.fetch(\n      new Request(\n        /^https?:\\/\\//.test(input) ? input : `http://localhost${mergePath(\"/\", input)}`,\n        requestInit\n      ),\n      Env,\n      executionCtx\n    );\n  };\n  fire = () => {\n    addEventListener(\"fetch\", (event) => {\n      event.respondWith(this.#dispatch(event.request, event, void 0, event.request.method));\n    });\n  };\n};\nexport {\n  Hono as HonoBase\n};\n", "// src/router/reg-exp-router/matcher.ts\nimport { METHOD_NAME_ALL } from \"../../router.js\";\nvar emptyParam = [];\nfunction match(method, path) {\n  const matchers = this.buildAllMatchers();\n  const match2 = (method2, path2) => {\n    const matcher = matchers[method2] || matchers[METHOD_NAME_ALL];\n    const staticMatch = matcher[2][path2];\n    if (staticMatch) {\n      return staticMatch;\n    }\n    const match3 = path2.match(matcher[0]);\n    if (!match3) {\n      return [[], emptyParam];\n    }\n    const index = match3.indexOf(\"\", 1);\n    return [matcher[1][index], match3];\n  };\n  this.match = match2;\n  return match2(method, path);\n}\nexport {\n  emptyParam,\n  match\n};\n", "// src/router/reg-exp-router/node.ts\nvar LABEL_REG_EXP_STR = \"[^/]+\";\nvar ONLY_WILDCARD_REG_EXP_STR = \".*\";\nvar TAIL_WILDCARD_REG_EXP_STR = \"(?:|/.*)\";\nvar PATH_ERROR = Symbol();\nvar regExpMetaChars = new Set(\".\\\\+*[^]$()\");\nfunction compareKey(a, b) {\n  if (a.length === 1) {\n    return b.length === 1 ? a < b ? -1 : 1 : -1;\n  }\n  if (b.length === 1) {\n    return 1;\n  }\n  if (a === ONLY_WILDCARD_REG_EXP_STR || a === TAIL_WILDCARD_REG_EXP_STR) {\n    return 1;\n  } else if (b === ONLY_WILDCARD_REG_EXP_STR || b === TAIL_WILDCARD_REG_EXP_STR) {\n    return -1;\n  }\n  if (a === LABEL_REG_EXP_STR) {\n    return 1;\n  } else if (b === LABEL_REG_EXP_STR) {\n    return -1;\n  }\n  return a.length === b.length ? a < b ? -1 : 1 : b.length - a.length;\n}\nvar Node = class {\n  #index;\n  #varIndex;\n  #children = /* @__PURE__ */ Object.create(null);\n  insert(tokens, index, paramMap, context, pathErrorCheckOnly) {\n    if (tokens.length === 0) {\n      if (this.#index !== void 0) {\n        throw PATH_ERROR;\n      }\n      if (pathErrorCheckOnly) {\n        return;\n      }\n      this.#index = index;\n      return;\n    }\n    const [token, ...restTokens] = tokens;\n    const pattern = token === \"*\" ? restTokens.length === 0 ? [\"\", \"\", ONLY_WILDCARD_REG_EXP_STR] : [\"\", \"\", LABEL_REG_EXP_STR] : token === \"/*\" ? [\"\", \"\", TAIL_WILDCARD_REG_EXP_STR] : token.match(/^\\:([^\\{\\}]+)(?:\\{(.+)\\})?$/);\n    let node;\n    if (pattern) {\n      const name = pattern[1];\n      let regexpStr = pattern[2] || LABEL_REG_EXP_STR;\n      if (name && pattern[2]) {\n        if (regexpStr === \".*\") {\n          throw PATH_ERROR;\n        }\n        regexpStr = regexpStr.replace(/^\\((?!\\?:)(?=[^)]+\\)$)/, \"(?:\");\n        if (/\\((?!\\?:)/.test(regexpStr)) {\n          throw PATH_ERROR;\n        }\n      }\n      node = this.#children[regexpStr];\n      if (!node) {\n        if (Object.keys(this.#children).some(\n          (k) => k !== ONLY_WILDCARD_REG_EXP_STR && k !== TAIL_WILDCARD_REG_EXP_STR\n        )) {\n          throw PATH_ERROR;\n        }\n        if (pathErrorCheckOnly) {\n          return;\n        }\n        node = this.#children[regexpStr] = new Node();\n        if (name !== \"\") {\n          node.#varIndex = context.varIndex++;\n        }\n      }\n      if (!pathErrorCheckOnly && name !== \"\") {\n        paramMap.push([name, node.#varIndex]);\n      }\n    } else {\n      node = this.#children[token];\n      if (!node) {\n        if (Object.keys(this.#children).some(\n          (k) => k.length > 1 && k !== ONLY_WILDCARD_REG_EXP_STR && k !== TAIL_WILDCARD_REG_EXP_STR\n        )) {\n          throw PATH_ERROR;\n        }\n        if (pathErrorCheckOnly) {\n          return;\n        }\n        node = this.#children[token] = new Node();\n      }\n    }\n    node.insert(restTokens, index, paramMap, context, pathErrorCheckOnly);\n  }\n  buildRegExpStr() {\n    const childKeys = Object.keys(this.#children).sort(compareKey);\n    const strList = childKeys.map((k) => {\n      const c = this.#children[k];\n      return (typeof c.#varIndex === \"number\" ? `(${k})@${c.#varIndex}` : regExpMetaChars.has(k) ? `\\\\${k}` : k) + c.buildRegExpStr();\n    });\n    if (typeof this.#index === \"number\") {\n      strList.unshift(`#${this.#index}`);\n    }\n    if (strList.length === 0) {\n      return \"\";\n    }\n    if (strList.length === 1) {\n      return strList[0];\n    }\n    return \"(?:\" + strList.join(\"|\") + \")\";\n  }\n};\nexport {\n  Node,\n  PATH_ERROR\n};\n", "// src/router/reg-exp-router/trie.ts\nimport { Node } from \"./node.js\";\nvar Trie = class {\n  #context = { varIndex: 0 };\n  #root = new Node();\n  insert(path, index, pathErrorCheckOnly) {\n    const paramAssoc = [];\n    const groups = [];\n    for (let i = 0; ; ) {\n      let replaced = false;\n      path = path.replace(/\\{[^}]+\\}/g, (m) => {\n        const mark = `@\\\\${i}`;\n        groups[i] = [mark, m];\n        i++;\n        replaced = true;\n        return mark;\n      });\n      if (!replaced) {\n        break;\n      }\n    }\n    const tokens = path.match(/(?::[^\\/]+)|(?:\\/\\*$)|./g) || [];\n    for (let i = groups.length - 1; i >= 0; i--) {\n      const [mark] = groups[i];\n      for (let j = tokens.length - 1; j >= 0; j--) {\n        if (tokens[j].indexOf(mark) !== -1) {\n          tokens[j] = tokens[j].replace(mark, groups[i][1]);\n          break;\n        }\n      }\n    }\n    this.#root.insert(tokens, index, paramAssoc, this.#context, pathErrorCheckOnly);\n    return paramAssoc;\n  }\n  buildRegExp() {\n    let regexp = this.#root.buildRegExpStr();\n    if (regexp === \"\") {\n      return [/^$/, [], []];\n    }\n    let captureIndex = 0;\n    const indexReplacementMap = [];\n    const paramReplacementMap = [];\n    regexp = regexp.replace(/#(\\d+)|@(\\d+)|\\.\\*\\$/g, (_, handlerIndex, paramIndex) => {\n      if (handlerIndex !== void 0) {\n        indexReplacementMap[++captureIndex] = Number(handlerIndex);\n        return \"$()\";\n      }\n      if (paramIndex !== void 0) {\n        paramReplacementMap[Number(paramIndex)] = ++captureIndex;\n        return \"\";\n      }\n      return \"\";\n    });\n    return [new RegExp(`^${regexp}`), indexReplacementMap, paramReplacementMap];\n  }\n};\nexport {\n  Trie\n};\n", "// src/router/reg-exp-router/router.ts\nimport {\n  MESSAGE_MATCHER_IS_ALREADY_BUILT,\n  METHOD_NAME_ALL,\n  UnsupportedPathError\n} from \"../../router.js\";\nimport { checkOptionalParameter } from \"../../utils/url.js\";\nimport { match, emptyParam } from \"./matcher.js\";\nimport { PATH_ERROR } from \"./node.js\";\nimport { Trie } from \"./trie.js\";\nvar nullMatcher = [/^$/, [], /* @__PURE__ */ Object.create(null)];\nvar wildcardRegExpCache = /* @__PURE__ */ Object.create(null);\nfunction buildWildcardRegExp(path) {\n  return wildcardRegExpCache[path] ??= new RegExp(\n    path === \"*\" ? \"\" : `^${path.replace(\n      /\\/\\*$|([.\\\\+*[^\\]$()])/g,\n      (_, metaChar) => metaChar ? `\\\\${metaChar}` : \"(?:|/.*)\"\n    )}$`\n  );\n}\nfunction clearWildcardRegExpCache() {\n  wildcardRegExpCache = /* @__PURE__ */ Object.create(null);\n}\nfunction buildMatcherFromPreprocessedRoutes(routes) {\n  const trie = new Trie();\n  const handlerData = [];\n  if (routes.length === 0) {\n    return nullMatcher;\n  }\n  const routesWithStaticPathFlag = routes.map(\n    (route) => [!/\\*|\\/:/.test(route[0]), ...route]\n  ).sort(\n    ([isStaticA, pathA], [isStaticB, pathB]) => isStaticA ? 1 : isStaticB ? -1 : pathA.length - pathB.length\n  );\n  const staticMap = /* @__PURE__ */ Object.create(null);\n  for (let i = 0, j = -1, len = routesWithStaticPathFlag.length; i < len; i++) {\n    const [pathErrorCheckOnly, path, handlers] = routesWithStaticPathFlag[i];\n    if (pathErrorCheckOnly) {\n      staticMap[path] = [handlers.map(([h]) => [h, /* @__PURE__ */ Object.create(null)]), emptyParam];\n    } else {\n      j++;\n    }\n    let paramAssoc;\n    try {\n      paramAssoc = trie.insert(path, j, pathErrorCheckOnly);\n    } catch (e) {\n      throw e === PATH_ERROR ? new UnsupportedPathError(path) : e;\n    }\n    if (pathErrorCheckOnly) {\n      continue;\n    }\n    handlerData[j] = handlers.map(([h, paramCount]) => {\n      const paramIndexMap = /* @__PURE__ */ Object.create(null);\n      paramCount -= 1;\n      for (; paramCount >= 0; paramCount--) {\n        const [key, value] = paramAssoc[paramCount];\n        paramIndexMap[key] = value;\n      }\n      return [h, paramIndexMap];\n    });\n  }\n  const [regexp, indexReplacementMap, paramReplacementMap] = trie.buildRegExp();\n  for (let i = 0, len = handlerData.length; i < len; i++) {\n    for (let j = 0, len2 = handlerData[i].length; j < len2; j++) {\n      const map = handlerData[i][j]?.[1];\n      if (!map) {\n        continue;\n      }\n      const keys = Object.keys(map);\n      for (let k = 0, len3 = keys.length; k < len3; k++) {\n        map[keys[k]] = paramReplacementMap[map[keys[k]]];\n      }\n    }\n  }\n  const handlerMap = [];\n  for (const i in indexReplacementMap) {\n    handlerMap[i] = handlerData[indexReplacementMap[i]];\n  }\n  return [regexp, handlerMap, staticMap];\n}\nfunction findMiddleware(middleware, path) {\n  if (!middleware) {\n    return void 0;\n  }\n  for (const k of Object.keys(middleware).sort((a, b) => b.length - a.length)) {\n    if (buildWildcardRegExp(k).test(path)) {\n      return [...middleware[k]];\n    }\n  }\n  return void 0;\n}\nvar RegExpRouter = class {\n  name = \"RegExpRouter\";\n  #middleware;\n  #routes;\n  constructor() {\n    this.#middleware = { [METHOD_NAME_ALL]: /* @__PURE__ */ Object.create(null) };\n    this.#routes = { [METHOD_NAME_ALL]: /* @__PURE__ */ Object.create(null) };\n  }\n  add(method, path, handler) {\n    const middleware = this.#middleware;\n    const routes = this.#routes;\n    if (!middleware || !routes) {\n      throw new Error(MESSAGE_MATCHER_IS_ALREADY_BUILT);\n    }\n    if (!middleware[method]) {\n      ;\n      [middleware, routes].forEach((handlerMap) => {\n        handlerMap[method] = /* @__PURE__ */ Object.create(null);\n        Object.keys(handlerMap[METHOD_NAME_ALL]).forEach((p) => {\n          handlerMap[method][p] = [...handlerMap[METHOD_NAME_ALL][p]];\n        });\n      });\n    }\n    if (path === \"/*\") {\n      path = \"*\";\n    }\n    const paramCount = (path.match(/\\/:/g) || []).length;\n    if (/\\*$/.test(path)) {\n      const re = buildWildcardRegExp(path);\n      if (method === METHOD_NAME_ALL) {\n        Object.keys(middleware).forEach((m) => {\n          middleware[m][path] ||= findMiddleware(middleware[m], path) || findMiddleware(middleware[METHOD_NAME_ALL], path) || [];\n        });\n      } else {\n        middleware[method][path] ||= findMiddleware(middleware[method], path) || findMiddleware(middleware[METHOD_NAME_ALL], path) || [];\n      }\n      Object.keys(middleware).forEach((m) => {\n        if (method === METHOD_NAME_ALL || method === m) {\n          Object.keys(middleware[m]).forEach((p) => {\n            re.test(p) && middleware[m][p].push([handler, paramCount]);\n          });\n        }\n      });\n      Object.keys(routes).forEach((m) => {\n        if (method === METHOD_NAME_ALL || method === m) {\n          Object.keys(routes[m]).forEach(\n            (p) => re.test(p) && routes[m][p].push([handler, paramCount])\n          );\n        }\n      });\n      return;\n    }\n    const paths = checkOptionalParameter(path) || [path];\n    for (let i = 0, len = paths.length; i < len; i++) {\n      const path2 = paths[i];\n      Object.keys(routes).forEach((m) => {\n        if (method === METHOD_NAME_ALL || method === m) {\n          routes[m][path2] ||= [\n            ...findMiddleware(middleware[m], path2) || findMiddleware(middleware[METHOD_NAME_ALL], path2) || []\n          ];\n          routes[m][path2].push([handler, paramCount - len + i + 1]);\n        }\n      });\n    }\n  }\n  match = match;\n  buildAllMatchers() {\n    const matchers = /* @__PURE__ */ Object.create(null);\n    Object.keys(this.#routes).concat(Object.keys(this.#middleware)).forEach((method) => {\n      matchers[method] ||= this.#buildMatcher(method);\n    });\n    this.#middleware = this.#routes = void 0;\n    clearWildcardRegExpCache();\n    return matchers;\n  }\n  #buildMatcher(method) {\n    const routes = [];\n    let hasOwnRoute = method === METHOD_NAME_ALL;\n    [this.#middleware, this.#routes].forEach((r) => {\n      const ownRoute = r[method] ? Object.keys(r[method]).map((path) => [path, r[method][path]]) : [];\n      if (ownRoute.length !== 0) {\n        hasOwnRoute ||= true;\n        routes.push(...ownRoute);\n      } else if (method !== METHOD_NAME_ALL) {\n        routes.push(\n          ...Object.keys(r[METHOD_NAME_ALL]).map((path) => [path, r[METHOD_NAME_ALL][path]])\n        );\n      }\n    });\n    if (!hasOwnRoute) {\n      return null;\n    } else {\n      return buildMatcherFromPreprocessedRoutes(routes);\n    }\n  }\n};\nexport {\n  RegExpRouter\n};\n", "// src/router/smart-router/router.ts\nimport { MESSAGE_MATCHER_IS_ALREADY_BUILT, UnsupportedPathError } from \"../../router.js\";\nvar SmartRouter = class {\n  name = \"SmartRouter\";\n  #routers = [];\n  #routes = [];\n  constructor(init) {\n    this.#routers = init.routers;\n  }\n  add(method, path, handler) {\n    if (!this.#routes) {\n      throw new Error(MESSAGE_MATCHER_IS_ALREADY_BUILT);\n    }\n    this.#routes.push([method, path, handler]);\n  }\n  match(method, path) {\n    if (!this.#routes) {\n      throw new Error(\"Fatal error\");\n    }\n    const routers = this.#routers;\n    const routes = this.#routes;\n    const len = routers.length;\n    let i = 0;\n    let res;\n    for (; i < len; i++) {\n      const router = routers[i];\n      try {\n        for (let i2 = 0, len2 = routes.length; i2 < len2; i2++) {\n          router.add(...routes[i2]);\n        }\n        res = router.match(method, path);\n      } catch (e) {\n        if (e instanceof UnsupportedPathError) {\n          continue;\n        }\n        throw e;\n      }\n      this.match = router.match.bind(router);\n      this.#routers = [router];\n      this.#routes = void 0;\n      break;\n    }\n    if (i === len) {\n      throw new Error(\"Fatal error\");\n    }\n    this.name = `SmartRouter + ${this.activeRouter.name}`;\n    return res;\n  }\n  get activeRouter() {\n    if (this.#routes || this.#routers.length !== 1) {\n      throw new Error(\"No active router has been determined yet.\");\n    }\n    return this.#routers[0];\n  }\n};\nexport {\n  SmartRouter\n};\n", "// src/router/trie-router/node.ts\nimport { METHOD_NAME_ALL } from \"../../router.js\";\nimport { getPattern, splitPath, splitRoutingPath } from \"../../utils/url.js\";\nvar emptyParams = /* @__PURE__ */ Object.create(null);\nvar Node = class {\n  #methods;\n  #children;\n  #patterns;\n  #order = 0;\n  #params = emptyParams;\n  constructor(method, handler, children) {\n    this.#children = children || /* @__PURE__ */ Object.create(null);\n    this.#methods = [];\n    if (method && handler) {\n      const m = /* @__PURE__ */ Object.create(null);\n      m[method] = { handler, possibleKeys: [], score: 0 };\n      this.#methods = [m];\n    }\n    this.#patterns = [];\n  }\n  insert(method, path, handler) {\n    this.#order = ++this.#order;\n    let curNode = this;\n    const parts = splitRoutingPath(path);\n    const possibleKeys = [];\n    for (let i = 0, len = parts.length; i < len; i++) {\n      const p = parts[i];\n      const nextP = parts[i + 1];\n      const pattern = getPattern(p, nextP);\n      const key = Array.isArray(pattern) ? pattern[0] : p;\n      if (key in curNode.#children) {\n        curNode = curNode.#children[key];\n        if (pattern) {\n          possibleKeys.push(pattern[1]);\n        }\n        continue;\n      }\n      curNode.#children[key] = new Node();\n      if (pattern) {\n        curNode.#patterns.push(pattern);\n        possibleKeys.push(pattern[1]);\n      }\n      curNode = curNode.#children[key];\n    }\n    curNode.#methods.push({\n      [method]: {\n        handler,\n        possibleKeys: possibleKeys.filter((v, i, a) => a.indexOf(v) === i),\n        score: this.#order\n      }\n    });\n    return curNode;\n  }\n  #getHandlerSets(node, method, nodeParams, params) {\n    const handlerSets = [];\n    for (let i = 0, len = node.#methods.length; i < len; i++) {\n      const m = node.#methods[i];\n      const handlerSet = m[method] || m[METHOD_NAME_ALL];\n      const processedSet = {};\n      if (handlerSet !== void 0) {\n        handlerSet.params = /* @__PURE__ */ Object.create(null);\n        handlerSets.push(handlerSet);\n        if (nodeParams !== emptyParams || params && params !== emptyParams) {\n          for (let i2 = 0, len2 = handlerSet.possibleKeys.length; i2 < len2; i2++) {\n            const key = handlerSet.possibleKeys[i2];\n            const processed = processedSet[handlerSet.score];\n            handlerSet.params[key] = params?.[key] && !processed ? params[key] : nodeParams[key] ?? params?.[key];\n            processedSet[handlerSet.score] = true;\n          }\n        }\n      }\n    }\n    return handlerSets;\n  }\n  search(method, path) {\n    const handlerSets = [];\n    this.#params = emptyParams;\n    const curNode = this;\n    let curNodes = [curNode];\n    const parts = splitPath(path);\n    const curNodesQueue = [];\n    for (let i = 0, len = parts.length; i < len; i++) {\n      const part = parts[i];\n      const isLast = i === len - 1;\n      const tempNodes = [];\n      for (let j = 0, len2 = curNodes.length; j < len2; j++) {\n        const node = curNodes[j];\n        const nextNode = node.#children[part];\n        if (nextNode) {\n          nextNode.#params = node.#params;\n          if (isLast) {\n            if (nextNode.#children[\"*\"]) {\n              handlerSets.push(\n                ...this.#getHandlerSets(nextNode.#children[\"*\"], method, node.#params)\n              );\n            }\n            handlerSets.push(...this.#getHandlerSets(nextNode, method, node.#params));\n          } else {\n            tempNodes.push(nextNode);\n          }\n        }\n        for (let k = 0, len3 = node.#patterns.length; k < len3; k++) {\n          const pattern = node.#patterns[k];\n          const params = node.#params === emptyParams ? {} : { ...node.#params };\n          if (pattern === \"*\") {\n            const astNode = node.#children[\"*\"];\n            if (astNode) {\n              handlerSets.push(...this.#getHandlerSets(astNode, method, node.#params));\n              astNode.#params = params;\n              tempNodes.push(astNode);\n            }\n            continue;\n          }\n          const [key, name, matcher] = pattern;\n          if (!part && !(matcher instanceof RegExp)) {\n            continue;\n          }\n          const child = node.#children[key];\n          const restPathString = parts.slice(i).join(\"/\");\n          if (matcher instanceof RegExp) {\n            const m = matcher.exec(restPathString);\n            if (m) {\n              params[name] = m[0];\n              handlerSets.push(...this.#getHandlerSets(child, method, node.#params, params));\n              if (Object.keys(child.#children).length) {\n                child.#params = params;\n                const componentCount = m[0].match(/\\//)?.length ?? 0;\n                const targetCurNodes = curNodesQueue[componentCount] ||= [];\n                targetCurNodes.push(child);\n              }\n              continue;\n            }\n          }\n          if (matcher === true || matcher.test(part)) {\n            params[name] = part;\n            if (isLast) {\n              handlerSets.push(...this.#getHandlerSets(child, method, params, node.#params));\n              if (child.#children[\"*\"]) {\n                handlerSets.push(\n                  ...this.#getHandlerSets(child.#children[\"*\"], method, params, node.#params)\n                );\n              }\n            } else {\n              child.#params = params;\n              tempNodes.push(child);\n            }\n          }\n        }\n      }\n      curNodes = tempNodes.concat(curNodesQueue.shift() ?? []);\n    }\n    if (handlerSets.length > 1) {\n      handlerSets.sort((a, b) => {\n        return a.score - b.score;\n      });\n    }\n    return [handlerSets.map(({ handler, params }) => [handler, params])];\n  }\n};\nexport {\n  Node\n};\n", "// src/router/trie-router/router.ts\nimport { checkOptionalParameter } from \"../../utils/url.js\";\nimport { Node } from \"./node.js\";\nvar TrieRouter = class {\n  name = \"TrieRouter\";\n  #node;\n  constructor() {\n    this.#node = new Node();\n  }\n  add(method, path, handler) {\n    const results = checkOptionalParameter(path);\n    if (results) {\n      for (let i = 0, len = results.length; i < len; i++) {\n        this.#node.insert(method, results[i], handler);\n      }\n      return;\n    }\n    this.#node.insert(method, path, handler);\n  }\n  match(method, path) {\n    return this.#node.search(method, path);\n  }\n};\nexport {\n  TrieRouter\n};\n", "// src/hono.ts\nimport { HonoBase } from \"./hono-base.js\";\nimport { RegExpRouter } from \"./router/reg-exp-router/index.js\";\nimport { SmartRouter } from \"./router/smart-router/index.js\";\nimport { TrieRouter } from \"./router/trie-router/index.js\";\nvar Hono = class extends HonoBase {\n  constructor(options = {}) {\n    super(options);\n    this.router = options.router ?? new SmartRouter({\n      routers: [new RegExpRouter(), new TrieRouter()]\n    });\n  }\n};\nexport {\n  Hono\n};\n", "// src/middleware/cors/index.ts\nvar cors = (options) => {\n  const defaults = {\n    origin: \"*\",\n    allowMethods: [\"GET\", \"HEAD\", \"PUT\", \"POST\", \"DELETE\", \"PATCH\"],\n    allowHeaders: [],\n    exposeHeaders: []\n  };\n  const opts = {\n    ...defaults,\n    ...options\n  };\n  const findAllowOrigin = ((optsOrigin) => {\n    if (typeof optsOrigin === \"string\") {\n      if (optsOrigin === \"*\") {\n        return () => optsOrigin;\n      } else {\n        return (origin) => optsOrigin === origin ? origin : null;\n      }\n    } else if (typeof optsOrigin === \"function\") {\n      return optsOrigin;\n    } else {\n      return (origin) => optsOrigin.includes(origin) ? origin : null;\n    }\n  })(opts.origin);\n  const findAllowMethods = ((optsAllowMethods) => {\n    if (typeof optsAllowMethods === \"function\") {\n      return optsAllowMethods;\n    } else if (Array.isArray(optsAllowMethods)) {\n      return () => optsAllowMethods;\n    } else {\n      return () => [];\n    }\n  })(opts.allowMethods);\n  return async function cors2(c, next) {\n    function set(key, value) {\n      c.res.headers.set(key, value);\n    }\n    const allowOrigin = await findAllowOrigin(c.req.header(\"origin\") || \"\", c);\n    if (allowOrigin) {\n      set(\"Access-Control-Allow-Origin\", allowOrigin);\n    }\n    if (opts.credentials) {\n      set(\"Access-Control-Allow-Credentials\", \"true\");\n    }\n    if (opts.exposeHeaders?.length) {\n      set(\"Access-Control-Expose-Headers\", opts.exposeHeaders.join(\",\"));\n    }\n    if (c.req.method === \"OPTIONS\") {\n      if (opts.origin !== \"*\") {\n        set(\"Vary\", \"Origin\");\n      }\n      if (opts.maxAge != null) {\n        set(\"Access-Control-Max-Age\", opts.maxAge.toString());\n      }\n      const allowMethods = await findAllowMethods(c.req.header(\"origin\") || \"\", c);\n      if (allowMethods.length) {\n        set(\"Access-Control-Allow-Methods\", allowMethods.join(\",\"));\n      }\n      let headers = opts.allowHeaders;\n      if (!headers?.length) {\n        const requestHeaders = c.req.header(\"Access-Control-Request-Headers\");\n        if (requestHeaders) {\n          headers = requestHeaders.split(/\\s*,\\s*/);\n        }\n      }\n      if (headers?.length) {\n        set(\"Access-Control-Allow-Headers\", headers.join(\",\"));\n        c.res.headers.append(\"Vary\", \"Access-Control-Request-Headers\");\n      }\n      c.res.headers.delete(\"Content-Length\");\n      c.res.headers.delete(\"Content-Type\");\n      return new Response(null, {\n        headers: c.res.headers,\n        status: 204,\n        statusText: \"No Content\"\n      });\n    }\n    await next();\n    if (opts.origin !== \"*\") {\n      c.header(\"Vary\", \"Origin\", { append: true });\n    }\n  };\n};\nexport {\n  cors\n};\n", "function __classPrivateFieldSet(receiver, state, value, kind, f) {\n    if (kind === \"m\")\n        throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f)\n        throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver))\n        throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return kind === \"a\" ? f.call(receiver, value) : f ? (f.value = value) : state.set(receiver, value), value;\n}\nfunction __classPrivateFieldGet(receiver, state, kind, f) {\n    if (kind === \"a\" && !f)\n        throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver))\n        throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\nexport { __classPrivateFieldSet, __classPrivateFieldGet };\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\n/**\n * https://stackoverflow.com/a/2117523\n */\nexport let uuid4 = function () {\n  const { crypto } = globalThis as any;\n  if (crypto?.randomUUID) {\n    uuid4 = crypto.randomUUID.bind(crypto);\n    return crypto.randomUUID();\n  }\n  const u8 = new Uint8Array(1);\n  const randomByte = crypto ? () => crypto.getRandomValues(u8)[0]! : () => (Math.random() * 0xff) & 0xff;\n  return '10000000-1000-4000-8000-100000000000'.replace(/[018]/g, (c) =>\n    (+c ^ (randomByte() & (15 >> (+c / 4)))).toString(16),\n  );\n};\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nexport function isAbortError(err: unknown) {\n  return (\n    typeof err === 'object' &&\n    err !== null &&\n    // Spec-compliant fetch implementations\n    (('name' in err && (err as any).name === 'AbortError') ||\n      // Expo fetch\n      ('message' in err && String((err as any).message).includes('FetchRequestCanceledException')))\n  );\n}\n\nexport const castToError = (err: any): Error => {\n  if (err instanceof Error) return err;\n  if (typeof err === 'object' && err !== null) {\n    try {\n      if (Object.prototype.toString.call(err) === '[object Error]') {\n        // @ts-ignore - not all envs have native support for cause yet\n        const error = new Error(err.message, err.cause ? { cause: err.cause } : {});\n        if (err.stack) error.stack = err.stack;\n        // @ts-ignore - not all envs have native support for cause yet\n        if (err.cause && !error.cause) error.cause = err.cause;\n        if (err.name) error.name = err.name;\n        return error;\n      }\n    } catch {}\n    try {\n      return new Error(JSON.stringify(err));\n    } catch {}\n  }\n  return new Error(err);\n};\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { castToError } from '../internal/errors';\n\nexport class AnthropicError extends Error {}\n\nexport class APIError<\n  TStatus extends number | undefined = number | undefined,\n  THeaders extends Headers | undefined = Headers | undefined,\n  TError extends Object | undefined = Object | undefined,\n> extends AnthropicError {\n  /** HTTP status for the response that caused the error */\n  readonly status: TStatus;\n  /** HTTP headers for the response that caused the error */\n  readonly headers: THeaders;\n  /** JSON body of the response that caused the error */\n  readonly error: TError;\n\n  readonly requestID: string | null | undefined;\n\n  constructor(status: TStatus, error: TError, message: string | undefined, headers: THeaders) {\n    super(`${APIError.makeMessage(status, error, message)}`);\n    this.status = status;\n    this.headers = headers;\n    this.requestID = headers?.get('request-id');\n    this.error = error;\n  }\n\n  private static makeMessage(status: number | undefined, error: any, message: string | undefined) {\n    const msg =\n      error?.message ?\n        typeof error.message === 'string' ?\n          error.message\n        : JSON.stringify(error.message)\n      : error ? JSON.stringify(error)\n      : message;\n\n    if (status && msg) {\n      return `${status} ${msg}`;\n    }\n    if (status) {\n      return `${status} status code (no body)`;\n    }\n    if (msg) {\n      return msg;\n    }\n    return '(no status code or body)';\n  }\n\n  static generate(\n    status: number | undefined,\n    errorResponse: Object | undefined,\n    message: string | undefined,\n    headers: Headers | undefined,\n  ): APIError {\n    if (!status || !headers) {\n      return new APIConnectionError({ message, cause: castToError(errorResponse) });\n    }\n\n    const error = errorResponse as Record<string, any>;\n\n    if (status === 400) {\n      return new BadRequestError(status, error, message, headers);\n    }\n\n    if (status === 401) {\n      return new AuthenticationError(status, error, message, headers);\n    }\n\n    if (status === 403) {\n      return new PermissionDeniedError(status, error, message, headers);\n    }\n\n    if (status === 404) {\n      return new NotFoundError(status, error, message, headers);\n    }\n\n    if (status === 409) {\n      return new ConflictError(status, error, message, headers);\n    }\n\n    if (status === 422) {\n      return new UnprocessableEntityError(status, error, message, headers);\n    }\n\n    if (status === 429) {\n      return new RateLimitError(status, error, message, headers);\n    }\n\n    if (status >= 500) {\n      return new InternalServerError(status, error, message, headers);\n    }\n\n    return new APIError(status, error, message, headers);\n  }\n}\n\nexport class APIUserAbortError extends APIError<undefined, undefined, undefined> {\n  constructor({ message }: { message?: string } = {}) {\n    super(undefined, undefined, message || 'Request was aborted.', undefined);\n  }\n}\n\nexport class APIConnectionError extends APIError<undefined, undefined, undefined> {\n  constructor({ message, cause }: { message?: string | undefined; cause?: Error | undefined }) {\n    super(undefined, undefined, message || 'Connection error.', undefined);\n    // in some environments the 'cause' property is already declared\n    // @ts-ignore\n    if (cause) this.cause = cause;\n  }\n}\n\nexport class APIConnectionTimeoutError extends APIConnectionError {\n  constructor({ message }: { message?: string } = {}) {\n    super({ message: message ?? 'Request timed out.' });\n  }\n}\n\nexport class BadRequestError extends APIError<400, Headers> {}\n\nexport class AuthenticationError extends APIError<401, Headers> {}\n\nexport class PermissionDeniedError extends APIError<403, Headers> {}\n\nexport class NotFoundError extends APIError<404, Headers> {}\n\nexport class ConflictError extends APIError<409, Headers> {}\n\nexport class UnprocessableEntityError extends APIError<422, Headers> {}\n\nexport class RateLimitError extends APIError<429, Headers> {}\n\nexport class InternalServerError extends APIError<number, Headers> {}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { AnthropicError } from '../../core/error';\n\n// https://url.spec.whatwg.org/#url-scheme-string\nconst startsWithSchemeRegexp = /^[a-z][a-z0-9+.-]*:/i;\n\nexport const isAbsoluteURL = (url: string): boolean => {\n  return startsWithSchemeRegexp.test(url);\n};\n\nexport let isArray = (val: unknown): val is unknown[] => ((isArray = Array.isArray), isArray(val));\nexport let isReadonlyArray = isArray as (val: unknown) => val is readonly unknown[];\n\n/** Returns an object if the given value isn't an object, otherwise returns as-is */\nexport function maybeObj(x: unknown): object {\n  if (typeof x !== 'object') {\n    return {};\n  }\n\n  return x ?? {};\n}\n\n// https://stackoverflow.com/a/34491287\nexport function isEmptyObj(obj: Object | null | undefined): boolean {\n  if (!obj) return true;\n  for (const _k in obj) return false;\n  return true;\n}\n\n// https://eslint.org/docs/latest/rules/no-prototype-builtins\nexport function hasOwn<T extends object = object>(obj: T, key: PropertyKey): key is keyof T {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n}\n\nexport function isObj(obj: unknown): obj is Record<string, unknown> {\n  return obj != null && typeof obj === 'object' && !Array.isArray(obj);\n}\n\nexport const ensurePresent = <T>(value: T | null | undefined): T => {\n  if (value == null) {\n    throw new AnthropicError(`Expected a value to be given but received ${value} instead.`);\n  }\n\n  return value;\n};\n\nexport const validatePositiveInteger = (name: string, n: unknown): number => {\n  if (typeof n !== 'number' || !Number.isInteger(n)) {\n    throw new AnthropicError(`${name} must be an integer`);\n  }\n  if (n < 0) {\n    throw new AnthropicError(`${name} must be a positive integer`);\n  }\n  return n;\n};\n\nexport const coerceInteger = (value: unknown): number => {\n  if (typeof value === 'number') return Math.round(value);\n  if (typeof value === 'string') return parseInt(value, 10);\n\n  throw new AnthropicError(`Could not coerce ${value} (type: ${typeof value}) into a number`);\n};\n\nexport const coerceFloat = (value: unknown): number => {\n  if (typeof value === 'number') return value;\n  if (typeof value === 'string') return parseFloat(value);\n\n  throw new AnthropicError(`Could not coerce ${value} (type: ${typeof value}) into a number`);\n};\n\nexport const coerceBoolean = (value: unknown): boolean => {\n  if (typeof value === 'boolean') return value;\n  if (typeof value === 'string') return value === 'true';\n  return Boolean(value);\n};\n\nexport const maybeCoerceInteger = (value: unknown): number | undefined => {\n  if (value == null) {\n    return undefined;\n  }\n  return coerceInteger(value);\n};\n\nexport const maybeCoerceFloat = (value: unknown): number | undefined => {\n  if (value == null) {\n    return undefined;\n  }\n  return coerceFloat(value);\n};\n\nexport const maybeCoerceBoolean = (value: unknown): boolean | undefined => {\n  if (value == null) {\n    return undefined;\n  }\n  return coerceBoolean(value);\n};\n\nexport const safeJSON = (text: string) => {\n  try {\n    return JSON.parse(text);\n  } catch (err) {\n    return undefined;\n  }\n};\n\n// Gets a value from an object, deletes the key, and returns the value (or undefined if not found)\nexport const pop = <T extends Record<string, any>, K extends string>(obj: T, key: K): T[K] => {\n  const value = obj[key];\n  delete obj[key];\n  return value;\n};\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nexport const sleep = (ms: number) => new Promise<void>((resolve) => setTimeout(resolve, ms));\n", "export const VERSION = '0.71.2'; // x-release-please-version\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { VERSION } from '../version';\n\nexport const isRunningInBrowser = () => {\n  return (\n    // @ts-ignore\n    typeof window !== 'undefined' &&\n    // @ts-ignore\n    typeof window.document !== 'undefined' &&\n    // @ts-ignore\n    typeof navigator !== 'undefined'\n  );\n};\n\ntype DetectedPlatform = 'deno' | 'node' | 'edge' | 'unknown';\n\n/**\n * Note this does not detect 'browser'; for that, use getBrowserInfo().\n */\nfunction getDetectedPlatform(): DetectedPlatform {\n  if (typeof Deno !== 'undefined' && Deno.build != null) {\n    return 'deno';\n  }\n  if (typeof EdgeRuntime !== 'undefined') {\n    return 'edge';\n  }\n  if (\n    Object.prototype.toString.call(\n      typeof (globalThis as any).process !== 'undefined' ? (globalThis as any).process : 0,\n    ) === '[object process]'\n  ) {\n    return 'node';\n  }\n  return 'unknown';\n}\n\ndeclare const Deno: any;\ndeclare const EdgeRuntime: any;\ntype Arch = 'x32' | 'x64' | 'arm' | 'arm64' | `other:${string}` | 'unknown';\ntype PlatformName =\n  | 'MacOS'\n  | 'Linux'\n  | 'Windows'\n  | 'FreeBSD'\n  | 'OpenBSD'\n  | 'iOS'\n  | 'Android'\n  | `Other:${string}`\n  | 'Unknown';\ntype Browser = 'ie' | 'edge' | 'chrome' | 'firefox' | 'safari';\ntype PlatformProperties = {\n  'X-Stainless-Lang': 'js';\n  'X-Stainless-Package-Version': string;\n  'X-Stainless-OS': PlatformName;\n  'X-Stainless-Arch': Arch;\n  'X-Stainless-Runtime': 'node' | 'deno' | 'edge' | `browser:${Browser}` | 'unknown';\n  'X-Stainless-Runtime-Version': string;\n};\nconst getPlatformProperties = (): PlatformProperties => {\n  const detectedPlatform = getDetectedPlatform();\n  if (detectedPlatform === 'deno') {\n    return {\n      'X-Stainless-Lang': 'js',\n      'X-Stainless-Package-Version': VERSION,\n      'X-Stainless-OS': normalizePlatform(Deno.build.os),\n      'X-Stainless-Arch': normalizeArch(Deno.build.arch),\n      'X-Stainless-Runtime': 'deno',\n      'X-Stainless-Runtime-Version':\n        typeof Deno.version === 'string' ? Deno.version : Deno.version?.deno ?? 'unknown',\n    };\n  }\n  if (typeof EdgeRuntime !== 'undefined') {\n    return {\n      'X-Stainless-Lang': 'js',\n      'X-Stainless-Package-Version': VERSION,\n      'X-Stainless-OS': 'Unknown',\n      'X-Stainless-Arch': `other:${EdgeRuntime}`,\n      'X-Stainless-Runtime': 'edge',\n      'X-Stainless-Runtime-Version': (globalThis as any).process.version,\n    };\n  }\n  // Check if Node.js\n  if (detectedPlatform === 'node') {\n    return {\n      'X-Stainless-Lang': 'js',\n      'X-Stainless-Package-Version': VERSION,\n      'X-Stainless-OS': normalizePlatform((globalThis as any).process.platform ?? 'unknown'),\n      'X-Stainless-Arch': normalizeArch((globalThis as any).process.arch ?? 'unknown'),\n      'X-Stainless-Runtime': 'node',\n      'X-Stainless-Runtime-Version': (globalThis as any).process.version ?? 'unknown',\n    };\n  }\n\n  const browserInfo = getBrowserInfo();\n  if (browserInfo) {\n    return {\n      'X-Stainless-Lang': 'js',\n      'X-Stainless-Package-Version': VERSION,\n      'X-Stainless-OS': 'Unknown',\n      'X-Stainless-Arch': 'unknown',\n      'X-Stainless-Runtime': `browser:${browserInfo.browser}`,\n      'X-Stainless-Runtime-Version': browserInfo.version,\n    };\n  }\n\n  // TODO add support for Cloudflare workers, etc.\n  return {\n    'X-Stainless-Lang': 'js',\n    'X-Stainless-Package-Version': VERSION,\n    'X-Stainless-OS': 'Unknown',\n    'X-Stainless-Arch': 'unknown',\n    'X-Stainless-Runtime': 'unknown',\n    'X-Stainless-Runtime-Version': 'unknown',\n  };\n};\n\ntype BrowserInfo = {\n  browser: Browser;\n  version: string;\n};\n\ndeclare const navigator: { userAgent: string } | undefined;\n\n// Note: modified from https://github.com/JS-DevTools/host-environment/blob/b1ab79ecde37db5d6e163c050e54fe7d287d7c92/src/isomorphic.browser.ts\nfunction getBrowserInfo(): BrowserInfo | null {\n  if (typeof navigator === 'undefined' || !navigator) {\n    return null;\n  }\n\n  // NOTE: The order matters here!\n  const browserPatterns = [\n    { key: 'edge' as const, pattern: /Edge(?:\\W+(\\d+)\\.(\\d+)(?:\\.(\\d+))?)?/ },\n    { key: 'ie' as const, pattern: /MSIE(?:\\W+(\\d+)\\.(\\d+)(?:\\.(\\d+))?)?/ },\n    { key: 'ie' as const, pattern: /Trident(?:.*rv\\:(\\d+)\\.(\\d+)(?:\\.(\\d+))?)?/ },\n    { key: 'chrome' as const, pattern: /Chrome(?:\\W+(\\d+)\\.(\\d+)(?:\\.(\\d+))?)?/ },\n    { key: 'firefox' as const, pattern: /Firefox(?:\\W+(\\d+)\\.(\\d+)(?:\\.(\\d+))?)?/ },\n    { key: 'safari' as const, pattern: /(?:Version\\W+(\\d+)\\.(\\d+)(?:\\.(\\d+))?)?(?:\\W+Mobile\\S*)?\\W+Safari/ },\n  ];\n\n  // Find the FIRST matching browser\n  for (const { key, pattern } of browserPatterns) {\n    const match = pattern.exec(navigator.userAgent);\n    if (match) {\n      const major = match[1] || 0;\n      const minor = match[2] || 0;\n      const patch = match[3] || 0;\n\n      return { browser: key, version: `${major}.${minor}.${patch}` };\n    }\n  }\n\n  return null;\n}\n\nconst normalizeArch = (arch: string): Arch => {\n  // Node docs:\n  // - https://nodejs.org/api/process.html#processarch\n  // Deno docs:\n  // - https://doc.deno.land/deno/stable/~/Deno.build\n  if (arch === 'x32') return 'x32';\n  if (arch === 'x86_64' || arch === 'x64') return 'x64';\n  if (arch === 'arm') return 'arm';\n  if (arch === 'aarch64' || arch === 'arm64') return 'arm64';\n  if (arch) return `other:${arch}`;\n  return 'unknown';\n};\n\nconst normalizePlatform = (platform: string): PlatformName => {\n  // Node platforms:\n  // - https://nodejs.org/api/process.html#processplatform\n  // Deno platforms:\n  // - https://doc.deno.land/deno/stable/~/Deno.build\n  // - https://github.com/denoland/deno/issues/14799\n\n  platform = platform.toLowerCase();\n\n  // NOTE: this iOS check is untested and may not work\n  // Node does not work natively on IOS, there is a fork at\n  // https://github.com/nodejs-mobile/nodejs-mobile\n  // however it is unknown at the time of writing how to detect if it is running\n  if (platform.includes('ios')) return 'iOS';\n  if (platform === 'android') return 'Android';\n  if (platform === 'darwin') return 'MacOS';\n  if (platform === 'win32') return 'Windows';\n  if (platform === 'freebsd') return 'FreeBSD';\n  if (platform === 'openbsd') return 'OpenBSD';\n  if (platform === 'linux') return 'Linux';\n  if (platform) return `Other:${platform}`;\n  return 'Unknown';\n};\n\nlet _platformHeaders: PlatformProperties;\nexport const getPlatformHeaders = () => {\n  return (_platformHeaders ??= getPlatformProperties());\n};\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\n/**\n * This module provides internal shims and utility functions for environments where certain Node.js or global types may not be available.\n *\n * These are used to ensure we can provide a consistent behaviour between different JavaScript environments and good error\n * messages in cases where an environment isn't fully supported.\n */\n\nimport type { Fetch } from './builtin-types';\nimport type { ReadableStream } from './shim-types';\n\nexport function getDefaultFetch(): Fetch {\n  if (typeof fetch !== 'undefined') {\n    return fetch as any;\n  }\n\n  throw new Error(\n    '`fetch` is not defined as a global; Either pass `fetch` to the client, `new Anthropic({ fetch })` or polyfill the global, `globalThis.fetch = fetch`',\n  );\n}\n\ntype ReadableStreamArgs = ConstructorParameters<typeof ReadableStream>;\n\nexport function makeReadableStream(...args: ReadableStreamArgs): ReadableStream {\n  const ReadableStream = (globalThis as any).ReadableStream;\n  if (typeof ReadableStream === 'undefined') {\n    // Note: All of the platforms / runtimes we officially support already define\n    // `ReadableStream` as a global, so this should only ever be hit on unsupported runtimes.\n    throw new Error(\n      '`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`',\n    );\n  }\n\n  return new ReadableStream(...args);\n}\n\nexport function ReadableStreamFrom<T>(iterable: Iterable<T> | AsyncIterable<T>): ReadableStream<T> {\n  let iter: AsyncIterator<T> | Iterator<T> =\n    Symbol.asyncIterator in iterable ? iterable[Symbol.asyncIterator]() : iterable[Symbol.iterator]();\n\n  return makeReadableStream({\n    start() {},\n    async pull(controller: any) {\n      const { done, value } = await iter.next();\n      if (done) {\n        controller.close();\n      } else {\n        controller.enqueue(value);\n      }\n    },\n    async cancel() {\n      await iter.return?.();\n    },\n  });\n}\n\n/**\n * Most browsers don't yet have async iterable support for ReadableStream,\n * and Node has a very different way of reading bytes from its \"ReadableStream\".\n *\n * This polyfill was pulled from https://github.com/MattiasBuelens/web-streams-polyfill/pull/122#issuecomment-1627354490\n */\nexport function ReadableStreamToAsyncIterable<T>(stream: any): AsyncIterableIterator<T> {\n  if (stream[Symbol.asyncIterator]) return stream;\n\n  const reader = stream.getReader();\n  return {\n    async next() {\n      try {\n        const result = await reader.read();\n        if (result?.done) reader.releaseLock(); // release lock when stream becomes closed\n        return result;\n      } catch (e) {\n        reader.releaseLock(); // release lock when stream becomes errored\n        throw e;\n      }\n    },\n    async return() {\n      const cancelPromise = reader.cancel();\n      reader.releaseLock();\n      await cancelPromise;\n      return { done: true, value: undefined };\n    },\n    [Symbol.asyncIterator]() {\n      return this;\n    },\n  };\n}\n\n/**\n * Cancels a ReadableStream we don't need to consume.\n * See https://undici.nodejs.org/#/?id=garbage-collection\n */\nexport async function CancelReadableStream(stream: any): Promise<void> {\n  if (stream === null || typeof stream !== 'object') return;\n\n  if (stream[Symbol.asyncIterator]) {\n    await stream[Symbol.asyncIterator]().return?.();\n    return;\n  }\n\n  const reader = stream.getReader();\n  const cancelPromise = reader.cancel();\n  reader.releaseLock();\n  await cancelPromise;\n}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { NullableHeaders } from './headers';\n\nimport type { BodyInit } from './builtin-types';\nimport { Stream } from '../core/streaming';\nimport type { HTTPMethod, MergedRequestInit } from './types';\nimport { type HeadersLike } from './headers';\n\nexport type FinalRequestOptions = RequestOptions & { method: HTTPMethod; path: string };\n\nexport type RequestOptions = {\n  /**\n   * The HTTP method for the request (e.g., 'get', 'post', 'put', 'delete').\n   */\n  method?: HTTPMethod;\n\n  /**\n   * The URL path for the request.\n   *\n   * @example \"/v1/foo\"\n   */\n  path?: string;\n\n  /**\n   * Query parameters to include in the request URL.\n   */\n  query?: object | undefined | null;\n\n  /**\n   * The request body. Can be a string, JSON object, FormData, or other supported types.\n   */\n  body?: unknown;\n\n  /**\n   * HTTP headers to include with the request. Can be a Headers object, plain object, or array of tuples.\n   */\n  headers?: HeadersLike;\n\n  /**\n   * The maximum number of times that the client will retry a request in case of a\n   * temporary failure, like a network error or a 5XX error from the server.\n   *\n   * @default 2\n   */\n  maxRetries?: number;\n\n  stream?: boolean | undefined;\n\n  /**\n   * The maximum amount of time (in milliseconds) that the client should wait for a response\n   * from the server before timing out a single request.\n   *\n   * @unit milliseconds\n   */\n  timeout?: number;\n\n  /**\n   * Additional `RequestInit` options to be passed to the underlying `fetch` call.\n   * These options will be merged with the client's default fetch options.\n   */\n  fetchOptions?: MergedRequestInit;\n\n  /**\n   * An AbortSignal that can be used to cancel the request.\n   */\n  signal?: AbortSignal | undefined | null;\n\n  /**\n   * A unique key for this request to enable idempotency.\n   */\n  idempotencyKey?: string;\n\n  /**\n   * Override the default base URL for this specific request.\n   */\n  defaultBaseURL?: string | undefined;\n\n  __binaryResponse?: boolean | undefined;\n  __streamClass?: typeof Stream;\n};\n\nexport type EncodedContent = { bodyHeaders: HeadersLike; body: BodyInit };\nexport type RequestEncoder = (request: { headers: NullableHeaders; body: unknown }) => EncodedContent;\n\nexport const FallbackEncoder: RequestEncoder = ({ headers, body }) => {\n  return {\n    bodyHeaders: {\n      'content-type': 'application/json',\n    },\n    body: JSON.stringify(body),\n  };\n};\n", "export function concatBytes(buffers: Uint8Array[]): Uint8Array {\n  let length = 0;\n  for (const buffer of buffers) {\n    length += buffer.length;\n  }\n  const output = new Uint8Array(length);\n  let index = 0;\n  for (const buffer of buffers) {\n    output.set(buffer, index);\n    index += buffer.length;\n  }\n\n  return output;\n}\n\nlet encodeUTF8_: (str: string) => Uint8Array;\nexport function encodeUTF8(str: string) {\n  let encoder;\n  return (\n    encodeUTF8_ ??\n    ((encoder = new (globalThis as any).TextEncoder()), (encodeUTF8_ = encoder.encode.bind(encoder)))\n  )(str);\n}\n\nlet decodeUTF8_: (bytes: Uint8Array) => string;\nexport function decodeUTF8(bytes: Uint8Array) {\n  let decoder;\n  return (\n    decodeUTF8_ ??\n    ((decoder = new (globalThis as any).TextDecoder()), (decodeUTF8_ = decoder.decode.bind(decoder)))\n  )(bytes);\n}\n", "import { concatBytes, decodeUTF8, encodeUTF8 } from '../utils/bytes';\n\nexport type Bytes = string | ArrayBuffer | Uint8Array | null | undefined;\n\n/**\n * A re-implementation of httpx's `LineDecoder` in Python that handles incrementally\n * reading lines from text.\n *\n * https://github.com/encode/httpx/blob/920333ea98118e9cf617f246905d7b202510941c/httpx/_decoders.py#L258\n */\nexport class LineDecoder {\n  // prettier-ignore\n  static NEWLINE_CHARS = new Set(['\\n', '\\r']);\n  static NEWLINE_REGEXP = /\\r\\n|[\\n\\r]/g;\n\n  #buffer: Uint8Array;\n  #carriageReturnIndex: number | null;\n\n  constructor() {\n    this.#buffer = new Uint8Array();\n    this.#carriageReturnIndex = null;\n  }\n\n  decode(chunk: Bytes): string[] {\n    if (chunk == null) {\n      return [];\n    }\n\n    const binaryChunk =\n      chunk instanceof ArrayBuffer ? new Uint8Array(chunk)\n      : typeof chunk === 'string' ? encodeUTF8(chunk)\n      : chunk;\n\n    this.#buffer = concatBytes([this.#buffer, binaryChunk]);\n\n    const lines: string[] = [];\n    let patternIndex;\n    while ((patternIndex = findNewlineIndex(this.#buffer, this.#carriageReturnIndex)) != null) {\n      if (patternIndex.carriage && this.#carriageReturnIndex == null) {\n        // skip until we either get a corresponding `\\n`, a new `\\r` or nothing\n        this.#carriageReturnIndex = patternIndex.index;\n        continue;\n      }\n\n      // we got double \\r or \\rtext\\n\n      if (\n        this.#carriageReturnIndex != null &&\n        (patternIndex.index !== this.#carriageReturnIndex + 1 || patternIndex.carriage)\n      ) {\n        lines.push(decodeUTF8(this.#buffer.subarray(0, this.#carriageReturnIndex - 1)));\n        this.#buffer = this.#buffer.subarray(this.#carriageReturnIndex);\n        this.#carriageReturnIndex = null;\n        continue;\n      }\n\n      const endIndex =\n        this.#carriageReturnIndex !== null ? patternIndex.preceding - 1 : patternIndex.preceding;\n\n      const line = decodeUTF8(this.#buffer.subarray(0, endIndex));\n      lines.push(line);\n\n      this.#buffer = this.#buffer.subarray(patternIndex.index);\n      this.#carriageReturnIndex = null;\n    }\n\n    return lines;\n  }\n\n  flush(): string[] {\n    if (!this.#buffer.length) {\n      return [];\n    }\n    return this.decode('\\n');\n  }\n}\n\n/**\n * This function searches the buffer for the end patterns, (\\r or \\n)\n * and returns an object with the index preceding the matched newline and the\n * index after the newline char. `null` is returned if no new line is found.\n *\n * ```ts\n * findNewLineIndex('abc\\ndef') -> { preceding: 2, index: 3 }\n * ```\n */\nfunction findNewlineIndex(\n  buffer: Uint8Array,\n  startIndex: number | null,\n): { preceding: number; index: number; carriage: boolean } | null {\n  const newline = 0x0a; // \\n\n  const carriage = 0x0d; // \\r\n\n  for (let i = startIndex ?? 0; i < buffer.length; i++) {\n    if (buffer[i] === newline) {\n      return { preceding: i, index: i + 1, carriage: false };\n    }\n\n    if (buffer[i] === carriage) {\n      return { preceding: i, index: i + 1, carriage: true };\n    }\n  }\n\n  return null;\n}\n\nexport function findDoubleNewlineIndex(buffer: Uint8Array): number {\n  // This function searches the buffer for the end patterns (\\r\\r, \\n\\n, \\r\\n\\r\\n)\n  // and returns the index right after the first occurrence of any pattern,\n  // or -1 if none of the patterns are found.\n  const newline = 0x0a; // \\n\n  const carriage = 0x0d; // \\r\n\n  for (let i = 0; i < buffer.length - 1; i++) {\n    if (buffer[i] === newline && buffer[i + 1] === newline) {\n      // \\n\\n\n      return i + 2;\n    }\n    if (buffer[i] === carriage && buffer[i + 1] === carriage) {\n      // \\r\\r\n      return i + 2;\n    }\n    if (\n      buffer[i] === carriage &&\n      buffer[i + 1] === newline &&\n      i + 3 < buffer.length &&\n      buffer[i + 2] === carriage &&\n      buffer[i + 3] === newline\n    ) {\n      // \\r\\n\\r\\n\n      return i + 4;\n    }\n  }\n\n  return -1;\n}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { hasOwn } from './values';\nimport { type BaseAnthropic } from '../../client';\nimport { RequestOptions } from '../request-options';\n\ntype LogFn = (message: string, ...rest: unknown[]) => void;\nexport type Logger = {\n  error: LogFn;\n  warn: LogFn;\n  info: LogFn;\n  debug: LogFn;\n};\nexport type LogLevel = 'off' | 'error' | 'warn' | 'info' | 'debug';\n\nconst levelNumbers = {\n  off: 0,\n  error: 200,\n  warn: 300,\n  info: 400,\n  debug: 500,\n};\n\nexport const parseLogLevel = (\n  maybeLevel: string | undefined,\n  sourceName: string,\n  client: BaseAnthropic,\n): LogLevel | undefined => {\n  if (!maybeLevel) {\n    return undefined;\n  }\n  if (hasOwn(levelNumbers, maybeLevel)) {\n    return maybeLevel;\n  }\n  loggerFor(client).warn(\n    `${sourceName} was set to ${JSON.stringify(maybeLevel)}, expected one of ${JSON.stringify(\n      Object.keys(levelNumbers),\n    )}`,\n  );\n  return undefined;\n};\n\nfunction noop() {}\n\nfunction makeLogFn(fnLevel: keyof Logger, logger: Logger | undefined, logLevel: LogLevel) {\n  if (!logger || levelNumbers[fnLevel] > levelNumbers[logLevel]) {\n    return noop;\n  } else {\n    // Don't wrap logger functions, we want the stacktrace intact!\n    return logger[fnLevel].bind(logger);\n  }\n}\n\nconst noopLogger = {\n  error: noop,\n  warn: noop,\n  info: noop,\n  debug: noop,\n};\n\nlet cachedLoggers = /* @__PURE__ */ new WeakMap<Logger, [LogLevel, Logger]>();\n\nexport function loggerFor(client: BaseAnthropic): Logger {\n  const logger = client.logger;\n  const logLevel = client.logLevel ?? 'off';\n  if (!logger) {\n    return noopLogger;\n  }\n\n  const cachedLogger = cachedLoggers.get(logger);\n  if (cachedLogger && cachedLogger[0] === logLevel) {\n    return cachedLogger[1];\n  }\n\n  const levelLogger = {\n    error: makeLogFn('error', logger, logLevel),\n    warn: makeLogFn('warn', logger, logLevel),\n    info: makeLogFn('info', logger, logLevel),\n    debug: makeLogFn('debug', logger, logLevel),\n  };\n\n  cachedLoggers.set(logger, [logLevel, levelLogger]);\n\n  return levelLogger;\n}\n\nexport const formatRequestDetails = (details: {\n  options?: RequestOptions | undefined;\n  headers?: Headers | Record<string, string> | undefined;\n  retryOfRequestLogID?: string | undefined;\n  retryOf?: string | undefined;\n  url?: string | undefined;\n  status?: number | undefined;\n  method?: string | undefined;\n  durationMs?: number | undefined;\n  message?: unknown;\n  body?: unknown;\n}) => {\n  if (details.options) {\n    details.options = { ...details.options };\n    delete details.options['headers']; // redundant + leaks internals\n  }\n  if (details.headers) {\n    details.headers = Object.fromEntries(\n      (details.headers instanceof Headers ? [...details.headers] : Object.entries(details.headers)).map(\n        ([name, value]) => [\n          name,\n          (\n            name.toLowerCase() === 'x-api-key' ||\n            name.toLowerCase() === 'authorization' ||\n            name.toLowerCase() === 'cookie' ||\n            name.toLowerCase() === 'set-cookie'\n          ) ?\n            '***'\n          : value,\n        ],\n      ),\n    );\n  }\n  if ('retryOfRequestLogID' in details) {\n    if (details.retryOfRequestLogID) {\n      details.retryOf = details.retryOfRequestLogID;\n    }\n    delete details.retryOfRequestLogID;\n  }\n  return details;\n};\n", "import { AnthropicError } from './error';\nimport { type ReadableStream } from '../internal/shim-types';\nimport { makeReadableStream } from '../internal/shims';\nimport { findDoubleNewlineIndex, LineDecoder } from '../internal/decoders/line';\nimport { ReadableStreamToAsyncIterable } from '../internal/shims';\nimport { isAbortError } from '../internal/errors';\nimport { safeJSON } from '../internal/utils/values';\nimport { encodeUTF8 } from '../internal/utils/bytes';\nimport { loggerFor } from '../internal/utils/log';\nimport type { BaseAnthropic } from '../client';\n\nimport { APIError } from './error';\n\ntype Bytes = string | ArrayBuffer | Uint8Array | null | undefined;\n\nexport type ServerSentEvent = {\n  event: string | null;\n  data: string;\n  raw: string[];\n};\n\nexport class Stream<Item> implements AsyncIterable<Item> {\n  controller: AbortController;\n  #client: BaseAnthropic | undefined;\n\n  constructor(\n    private iterator: () => AsyncIterator<Item>,\n    controller: AbortController,\n    client?: BaseAnthropic,\n  ) {\n    this.controller = controller;\n    this.#client = client;\n  }\n\n  static fromSSEResponse<Item>(\n    response: Response,\n    controller: AbortController,\n    client?: BaseAnthropic,\n  ): Stream<Item> {\n    let consumed = false;\n    const logger = client ? loggerFor(client) : console;\n\n    async function* iterator(): AsyncIterator<Item, any, undefined> {\n      if (consumed) {\n        throw new AnthropicError('Cannot iterate over a consumed stream, use `.tee()` to split the stream.');\n      }\n      consumed = true;\n      let done = false;\n      try {\n        for await (const sse of _iterSSEMessages(response, controller)) {\n          if (sse.event === 'completion') {\n            try {\n              yield JSON.parse(sse.data);\n            } catch (e) {\n              logger.error(`Could not parse message into JSON:`, sse.data);\n              logger.error(`From chunk:`, sse.raw);\n              throw e;\n            }\n          }\n\n          if (\n            sse.event === 'message_start' ||\n            sse.event === 'message_delta' ||\n            sse.event === 'message_stop' ||\n            sse.event === 'content_block_start' ||\n            sse.event === 'content_block_delta' ||\n            sse.event === 'content_block_stop'\n          ) {\n            try {\n              yield JSON.parse(sse.data);\n            } catch (e) {\n              logger.error(`Could not parse message into JSON:`, sse.data);\n              logger.error(`From chunk:`, sse.raw);\n              throw e;\n            }\n          }\n\n          if (sse.event === 'ping') {\n            continue;\n          }\n\n          if (sse.event === 'error') {\n            throw new APIError(undefined, safeJSON(sse.data) ?? sse.data, undefined, response.headers);\n          }\n        }\n        done = true;\n      } catch (e) {\n        // If the user calls `stream.controller.abort()`, we should exit without throwing.\n        if (isAbortError(e)) return;\n        throw e;\n      } finally {\n        // If the user `break`s, abort the ongoing request.\n        if (!done) controller.abort();\n      }\n    }\n\n    return new Stream(iterator, controller, client);\n  }\n\n  /**\n   * Generates a Stream from a newline-separated ReadableStream\n   * where each item is a JSON value.\n   */\n  static fromReadableStream<Item>(\n    readableStream: ReadableStream,\n    controller: AbortController,\n    client?: BaseAnthropic,\n  ): Stream<Item> {\n    let consumed = false;\n\n    async function* iterLines(): AsyncGenerator<string, void, unknown> {\n      const lineDecoder = new LineDecoder();\n\n      const iter = ReadableStreamToAsyncIterable<Bytes>(readableStream);\n      for await (const chunk of iter) {\n        for (const line of lineDecoder.decode(chunk)) {\n          yield line;\n        }\n      }\n\n      for (const line of lineDecoder.flush()) {\n        yield line;\n      }\n    }\n\n    async function* iterator(): AsyncIterator<Item, any, undefined> {\n      if (consumed) {\n        throw new AnthropicError('Cannot iterate over a consumed stream, use `.tee()` to split the stream.');\n      }\n      consumed = true;\n      let done = false;\n      try {\n        for await (const line of iterLines()) {\n          if (done) continue;\n          if (line) yield JSON.parse(line);\n        }\n        done = true;\n      } catch (e) {\n        // If the user calls `stream.controller.abort()`, we should exit without throwing.\n        if (isAbortError(e)) return;\n        throw e;\n      } finally {\n        // If the user `break`s, abort the ongoing request.\n        if (!done) controller.abort();\n      }\n    }\n\n    return new Stream(iterator, controller, client);\n  }\n\n  [Symbol.asyncIterator](): AsyncIterator<Item> {\n    return this.iterator();\n  }\n\n  /**\n   * Splits the stream into two streams which can be\n   * independently read from at different speeds.\n   */\n  tee(): [Stream<Item>, Stream<Item>] {\n    const left: Array<Promise<IteratorResult<Item>>> = [];\n    const right: Array<Promise<IteratorResult<Item>>> = [];\n    const iterator = this.iterator();\n\n    const teeIterator = (queue: Array<Promise<IteratorResult<Item>>>): AsyncIterator<Item> => {\n      return {\n        next: () => {\n          if (queue.length === 0) {\n            const result = iterator.next();\n            left.push(result);\n            right.push(result);\n          }\n          return queue.shift()!;\n        },\n      };\n    };\n\n    return [\n      new Stream(() => teeIterator(left), this.controller, this.#client),\n      new Stream(() => teeIterator(right), this.controller, this.#client),\n    ];\n  }\n\n  /**\n   * Converts this stream to a newline-separated ReadableStream of\n   * JSON stringified values in the stream\n   * which can be turned back into a Stream with `Stream.fromReadableStream()`.\n   */\n  toReadableStream(): ReadableStream {\n    const self = this;\n    let iter: AsyncIterator<Item>;\n\n    return makeReadableStream({\n      async start() {\n        iter = self[Symbol.asyncIterator]();\n      },\n      async pull(ctrl: any) {\n        try {\n          const { value, done } = await iter.next();\n          if (done) return ctrl.close();\n\n          const bytes = encodeUTF8(JSON.stringify(value) + '\\n');\n\n          ctrl.enqueue(bytes);\n        } catch (err) {\n          ctrl.error(err);\n        }\n      },\n      async cancel() {\n        await iter.return?.();\n      },\n    });\n  }\n}\n\nexport async function* _iterSSEMessages(\n  response: Response,\n  controller: AbortController,\n): AsyncGenerator<ServerSentEvent, void, unknown> {\n  if (!response.body) {\n    controller.abort();\n    if (\n      typeof (globalThis as any).navigator !== 'undefined' &&\n      (globalThis as any).navigator.product === 'ReactNative'\n    ) {\n      throw new AnthropicError(\n        `The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api`,\n      );\n    }\n    throw new AnthropicError(`Attempted to iterate over a response with no body`);\n  }\n\n  const sseDecoder = new SSEDecoder();\n  const lineDecoder = new LineDecoder();\n\n  const iter = ReadableStreamToAsyncIterable<Bytes>(response.body);\n  for await (const sseChunk of iterSSEChunks(iter)) {\n    for (const line of lineDecoder.decode(sseChunk)) {\n      const sse = sseDecoder.decode(line);\n      if (sse) yield sse;\n    }\n  }\n\n  for (const line of lineDecoder.flush()) {\n    const sse = sseDecoder.decode(line);\n    if (sse) yield sse;\n  }\n}\n\n/**\n * Given an async iterable iterator, iterates over it and yields full\n * SSE chunks, i.e. yields when a double new-line is encountered.\n */\nasync function* iterSSEChunks(iterator: AsyncIterableIterator<Bytes>): AsyncGenerator<Uint8Array> {\n  let data = new Uint8Array();\n\n  for await (const chunk of iterator) {\n    if (chunk == null) {\n      continue;\n    }\n\n    const binaryChunk =\n      chunk instanceof ArrayBuffer ? new Uint8Array(chunk)\n      : typeof chunk === 'string' ? encodeUTF8(chunk)\n      : chunk;\n\n    let newData = new Uint8Array(data.length + binaryChunk.length);\n    newData.set(data);\n    newData.set(binaryChunk, data.length);\n    data = newData;\n\n    let patternIndex;\n    while ((patternIndex = findDoubleNewlineIndex(data)) !== -1) {\n      yield data.slice(0, patternIndex);\n      data = data.slice(patternIndex);\n    }\n  }\n\n  if (data.length > 0) {\n    yield data;\n  }\n}\n\nclass SSEDecoder {\n  private data: string[];\n  private event: string | null;\n  private chunks: string[];\n\n  constructor() {\n    this.event = null;\n    this.data = [];\n    this.chunks = [];\n  }\n\n  decode(line: string) {\n    if (line.endsWith('\\r')) {\n      line = line.substring(0, line.length - 1);\n    }\n\n    if (!line) {\n      // empty line and we didn't previously encounter any messages\n      if (!this.event && !this.data.length) return null;\n\n      const sse: ServerSentEvent = {\n        event: this.event,\n        data: this.data.join('\\n'),\n        raw: this.chunks,\n      };\n\n      this.event = null;\n      this.data = [];\n      this.chunks = [];\n\n      return sse;\n    }\n\n    this.chunks.push(line);\n\n    if (line.startsWith(':')) {\n      return null;\n    }\n\n    let [fieldname, _, value] = partition(line, ':');\n\n    if (value.startsWith(' ')) {\n      value = value.substring(1);\n    }\n\n    if (fieldname === 'event') {\n      this.event = value;\n    } else if (fieldname === 'data') {\n      this.data.push(value);\n    }\n\n    return null;\n  }\n}\n\nfunction partition(str: string, delimiter: string): [string, string, string] {\n  const index = str.indexOf(delimiter);\n  if (index !== -1) {\n    return [str.substring(0, index), delimiter, str.substring(index + delimiter.length)];\n  }\n\n  return [str, '', ''];\n}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport type { FinalRequestOptions } from './request-options';\nimport { Stream } from '../core/streaming';\nimport { type BaseAnthropic } from '../client';\nimport { formatRequestDetails, loggerFor } from './utils/log';\nimport type { AbstractPage } from '../core/pagination';\n\nexport type APIResponseProps = {\n  response: Response;\n  options: FinalRequestOptions;\n  controller: AbortController;\n  requestLogID: string;\n  retryOfRequestLogID: string | undefined;\n  startTime: number;\n};\n\nexport async function defaultParseResponse<T>(\n  client: BaseAnthropic,\n  props: APIResponseProps,\n): Promise<WithRequestID<T>> {\n  const { response, requestLogID, retryOfRequestLogID, startTime } = props;\n  const body = await (async () => {\n    if (props.options.stream) {\n      loggerFor(client).debug('response', response.status, response.url, response.headers, response.body);\n\n      // Note: there is an invariant here that isn't represented in the type system\n      // that if you set `stream: true` the response type must also be `Stream<T>`\n\n      if (props.options.__streamClass) {\n        return props.options.__streamClass.fromSSEResponse(response, props.controller) as any;\n      }\n\n      return Stream.fromSSEResponse(response, props.controller) as any;\n    }\n\n    // fetch refuses to read the body when the status code is 204.\n    if (response.status === 204) {\n      return null as T;\n    }\n\n    if (props.options.__binaryResponse) {\n      return response as unknown as T;\n    }\n\n    const contentType = response.headers.get('content-type');\n    const mediaType = contentType?.split(';')[0]?.trim();\n    const isJSON = mediaType?.includes('application/json') || mediaType?.endsWith('+json');\n    if (isJSON) {\n      const json = await response.json();\n      return addRequestID(json as T, response);\n    }\n\n    const text = await response.text();\n    return text as unknown as T;\n  })();\n  loggerFor(client).debug(\n    `[${requestLogID}] response parsed`,\n    formatRequestDetails({\n      retryOfRequestLogID,\n      url: response.url,\n      status: response.status,\n      body,\n      durationMs: Date.now() - startTime,\n    }),\n  );\n  return body;\n}\n\nexport type WithRequestID<T> =\n  T extends Array<any> | Response | AbstractPage<any> ? T\n  : T extends Record<string, any> ? T & { _request_id?: string | null }\n  : T;\n\nexport function addRequestID<T>(value: T, response: Response): WithRequestID<T> {\n  if (!value || typeof value !== 'object' || Array.isArray(value)) {\n    return value as WithRequestID<T>;\n  }\n\n  return Object.defineProperty(value, '_request_id', {\n    value: response.headers.get('request-id'),\n    enumerable: false,\n  }) as WithRequestID<T>;\n}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { type BaseAnthropic } from '../client';\n\nimport { type PromiseOrValue } from '../internal/types';\nimport {\n  type APIResponseProps,\n  type WithRequestID,\n  defaultParseResponse,\n  addRequestID,\n} from '../internal/parse';\n\n/**\n * A subclass of `Promise` providing additional helper methods\n * for interacting with the SDK.\n */\nexport class APIPromise<T> extends Promise<WithRequestID<T>> {\n  private parsedPromise: Promise<WithRequestID<T>> | undefined;\n  #client: BaseAnthropic;\n\n  constructor(\n    client: BaseAnthropic,\n    private responsePromise: Promise<APIResponseProps>,\n    private parseResponse: (\n      client: BaseAnthropic,\n      props: APIResponseProps,\n    ) => PromiseOrValue<WithRequestID<T>> = defaultParseResponse,\n  ) {\n    super((resolve) => {\n      // this is maybe a bit weird but this has to be a no-op to not implicitly\n      // parse the response body; instead .then, .catch, .finally are overridden\n      // to parse the response\n      resolve(null as any);\n    });\n    this.#client = client;\n  }\n\n  _thenUnwrap<U>(transform: (data: T, props: APIResponseProps) => U): APIPromise<U> {\n    return new APIPromise(this.#client, this.responsePromise, async (client, props) =>\n      addRequestID(transform(await this.parseResponse(client, props), props), props.response),\n    );\n  }\n\n  /**\n   * Gets the raw `Response` instance instead of parsing the response\n   * data.\n   *\n   * If you want to parse the response body but still get the `Response`\n   * instance, you can use {@link withResponse()}.\n   *\n   * \uD83D\uDC4B Getting the wrong TypeScript type for `Response`?\n   * Try setting `\"moduleResolution\": \"NodeNext\"` or add `\"lib\": [\"DOM\"]`\n   * to your `tsconfig.json`.\n   */\n  asResponse(): Promise<Response> {\n    return this.responsePromise.then((p) => p.response);\n  }\n\n  /**\n   * Gets the parsed response data, the raw `Response` instance and the ID of the request,\n   * returned via the `request-id` header which is useful for debugging requests and resporting\n   * issues to Anthropic.\n   *\n   * If you just want to get the raw `Response` instance without parsing it,\n   * you can use {@link asResponse()}.\n   *\n   * \uD83D\uDC4B Getting the wrong TypeScript type for `Response`?\n   * Try setting `\"moduleResolution\": \"NodeNext\"` or add `\"lib\": [\"DOM\"]`\n   * to your `tsconfig.json`.\n   */\n  async withResponse(): Promise<{ data: T; response: Response; request_id: string | null | undefined }> {\n    const [data, response] = await Promise.all([this.parse(), this.asResponse()]);\n    return { data, response, request_id: response.headers.get('request-id') };\n  }\n\n  private parse(): Promise<WithRequestID<T>> {\n    if (!this.parsedPromise) {\n      this.parsedPromise = this.responsePromise.then(\n        (data) => this.parseResponse(this.#client, data) as any as Promise<WithRequestID<T>>,\n      );\n    }\n    return this.parsedPromise;\n  }\n\n  override then<TResult1 = WithRequestID<T>, TResult2 = never>(\n    onfulfilled?: ((value: WithRequestID<T>) => TResult1 | PromiseLike<TResult1>) | undefined | null,\n    onrejected?: ((reason: any) => TResult2 | PromiseLike<TResult2>) | undefined | null,\n  ): Promise<TResult1 | TResult2> {\n    return this.parse().then(onfulfilled, onrejected);\n  }\n\n  override catch<TResult = never>(\n    onrejected?: ((reason: any) => TResult | PromiseLike<TResult>) | undefined | null,\n  ): Promise<WithRequestID<T> | TResult> {\n    return this.parse().catch(onrejected);\n  }\n\n  override finally(onfinally?: (() => void) | undefined | null): Promise<WithRequestID<T>> {\n    return this.parse().finally(onfinally);\n  }\n}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { AnthropicError } from './error';\nimport { FinalRequestOptions } from '../internal/request-options';\nimport { defaultParseResponse, WithRequestID } from '../internal/parse';\nimport { type BaseAnthropic } from '../client';\nimport { APIPromise } from './api-promise';\nimport { type APIResponseProps } from '../internal/parse';\nimport { maybeObj } from '../internal/utils/values';\n\nexport type PageRequestOptions = Pick<FinalRequestOptions, 'query' | 'headers' | 'body' | 'path' | 'method'>;\n\nexport abstract class AbstractPage<Item> implements AsyncIterable<Item> {\n  #client: BaseAnthropic;\n  protected options: FinalRequestOptions;\n\n  protected response: Response;\n  protected body: unknown;\n\n  constructor(client: BaseAnthropic, response: Response, body: unknown, options: FinalRequestOptions) {\n    this.#client = client;\n    this.options = options;\n    this.response = response;\n    this.body = body;\n  }\n\n  abstract nextPageRequestOptions(): PageRequestOptions | null;\n\n  abstract getPaginatedItems(): Item[];\n\n  hasNextPage(): boolean {\n    const items = this.getPaginatedItems();\n    if (!items.length) return false;\n    return this.nextPageRequestOptions() != null;\n  }\n\n  async getNextPage(): Promise<this> {\n    const nextOptions = this.nextPageRequestOptions();\n    if (!nextOptions) {\n      throw new AnthropicError(\n        'No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.',\n      );\n    }\n\n    return await this.#client.requestAPIList(this.constructor as any, nextOptions);\n  }\n\n  async *iterPages(): AsyncGenerator<this> {\n    let page: this = this;\n    yield page;\n    while (page.hasNextPage()) {\n      page = await page.getNextPage();\n      yield page;\n    }\n  }\n\n  async *[Symbol.asyncIterator](): AsyncGenerator<Item> {\n    for await (const page of this.iterPages()) {\n      for (const item of page.getPaginatedItems()) {\n        yield item;\n      }\n    }\n  }\n}\n\n/**\n * This subclass of Promise will resolve to an instantiated Page once the request completes.\n *\n * It also implements AsyncIterable to allow auto-paginating iteration on an unawaited list call, eg:\n *\n *    for await (const item of client.items.list()) {\n *      console.log(item)\n *    }\n */\nexport class PagePromise<\n    PageClass extends AbstractPage<Item>,\n    Item = ReturnType<PageClass['getPaginatedItems']>[number],\n  >\n  extends APIPromise<PageClass>\n  implements AsyncIterable<Item>\n{\n  constructor(\n    client: BaseAnthropic,\n    request: Promise<APIResponseProps>,\n    Page: new (...args: ConstructorParameters<typeof AbstractPage>) => PageClass,\n  ) {\n    super(\n      client,\n      request,\n      async (client, props) =>\n        new Page(\n          client,\n          props.response,\n          await defaultParseResponse(client, props),\n          props.options,\n        ) as WithRequestID<PageClass>,\n    );\n  }\n\n  /**\n   * Allow auto-paginating iteration on an unawaited list call, eg:\n   *\n   *    for await (const item of client.items.list()) {\n   *      console.log(item)\n   *    }\n   */\n  async *[Symbol.asyncIterator](): AsyncGenerator<Item> {\n    const page = await this;\n    for await (const item of page) {\n      yield item;\n    }\n  }\n}\n\nexport interface PageResponse<Item> {\n  data: Array<Item>;\n\n  has_more: boolean;\n\n  first_id: string | null;\n\n  last_id: string | null;\n}\n\nexport interface PageParams {\n  /**\n   * Number of items per page.\n   */\n  limit?: number;\n\n  before_id?: string;\n\n  after_id?: string;\n}\n\nexport class Page<Item> extends AbstractPage<Item> implements PageResponse<Item> {\n  data: Array<Item>;\n\n  has_more: boolean;\n\n  first_id: string | null;\n\n  last_id: string | null;\n\n  constructor(\n    client: BaseAnthropic,\n    response: Response,\n    body: PageResponse<Item>,\n    options: FinalRequestOptions,\n  ) {\n    super(client, response, body, options);\n\n    this.data = body.data || [];\n    this.has_more = body.has_more || false;\n    this.first_id = body.first_id || null;\n    this.last_id = body.last_id || null;\n  }\n\n  getPaginatedItems(): Item[] {\n    return this.data ?? [];\n  }\n\n  override hasNextPage(): boolean {\n    if (this.has_more === false) {\n      return false;\n    }\n\n    return super.hasNextPage();\n  }\n\n  nextPageRequestOptions(): PageRequestOptions | null {\n    if ((this.options.query as Record<string, unknown>)?.['before_id']) {\n      // in reverse\n      const first_id = this.first_id;\n      if (!first_id) {\n        return null;\n      }\n\n      return {\n        ...this.options,\n        query: {\n          ...maybeObj(this.options.query),\n          before_id: first_id,\n        },\n      };\n    }\n\n    const cursor = this.last_id;\n    if (!cursor) {\n      return null;\n    }\n\n    return {\n      ...this.options,\n      query: {\n        ...maybeObj(this.options.query),\n        after_id: cursor,\n      },\n    };\n  }\n}\n\nexport interface TokenPageResponse<Item> {\n  data: Array<Item>;\n\n  has_more: boolean;\n\n  next_page: string | null;\n}\n\nexport interface TokenPageParams {\n  /**\n   * Number of items per page.\n   */\n  limit?: number;\n\n  page_token?: string;\n}\n\nexport class TokenPage<Item> extends AbstractPage<Item> implements TokenPageResponse<Item> {\n  data: Array<Item>;\n\n  has_more: boolean;\n\n  next_page: string | null;\n\n  constructor(\n    client: BaseAnthropic,\n    response: Response,\n    body: TokenPageResponse<Item>,\n    options: FinalRequestOptions,\n  ) {\n    super(client, response, body, options);\n\n    this.data = body.data || [];\n    this.has_more = body.has_more || false;\n    this.next_page = body.next_page || null;\n  }\n\n  getPaginatedItems(): Item[] {\n    return this.data ?? [];\n  }\n\n  override hasNextPage(): boolean {\n    if (this.has_more === false) {\n      return false;\n    }\n\n    return super.hasNextPage();\n  }\n\n  nextPageRequestOptions(): PageRequestOptions | null {\n    const cursor = this.next_page;\n    if (!cursor) {\n      return null;\n    }\n\n    return {\n      ...this.options,\n      query: {\n        ...maybeObj(this.options.query),\n        page_token: cursor,\n      },\n    };\n  }\n}\n\nexport interface PageCursorResponse<Item> {\n  data: Array<Item>;\n\n  has_more: boolean;\n\n  next_page: string | null;\n}\n\nexport interface PageCursorParams {\n  /**\n   * Number of items per page.\n   */\n  limit?: number;\n\n  page?: string | null;\n}\n\nexport class PageCursor<Item> extends AbstractPage<Item> implements PageCursorResponse<Item> {\n  data: Array<Item>;\n\n  has_more: boolean;\n\n  next_page: string | null;\n\n  constructor(\n    client: BaseAnthropic,\n    response: Response,\n    body: PageCursorResponse<Item>,\n    options: FinalRequestOptions,\n  ) {\n    super(client, response, body, options);\n\n    this.data = body.data || [];\n    this.has_more = body.has_more || false;\n    this.next_page = body.next_page || null;\n  }\n\n  getPaginatedItems(): Item[] {\n    return this.data ?? [];\n  }\n\n  override hasNextPage(): boolean {\n    if (this.has_more === false) {\n      return false;\n    }\n\n    return super.hasNextPage();\n  }\n\n  nextPageRequestOptions(): PageRequestOptions | null {\n    const cursor = this.next_page;\n    if (!cursor) {\n      return null;\n    }\n\n    return {\n      ...this.options,\n      query: {\n        ...maybeObj(this.options.query),\n        page: cursor,\n      },\n    };\n  }\n}\n", "import { type RequestOptions } from './request-options';\nimport type { FilePropertyBag, Fetch } from './builtin-types';\nimport type { BaseAnthropic } from '../client';\nimport { ReadableStreamFrom } from './shims';\n\nexport type BlobPart = string | ArrayBuffer | ArrayBufferView | Blob | DataView;\ntype FsReadStream = AsyncIterable<Uint8Array> & { path: string | { toString(): string } };\n\n// https://github.com/oven-sh/bun/issues/5980\ninterface BunFile extends Blob {\n  readonly name?: string | undefined;\n}\n\nexport const checkFileSupport = () => {\n  if (typeof File === 'undefined') {\n    const { process } = globalThis as any;\n    const isOldNode =\n      typeof process?.versions?.node === 'string' && parseInt(process.versions.node.split('.')) < 20;\n    throw new Error(\n      '`File` is not defined as a global, which is required for file uploads.' +\n        (isOldNode ?\n          \" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.\"\n        : ''),\n    );\n  }\n};\n\n/**\n * Typically, this is a native \"File\" class.\n *\n * We provide the {@link toFile} utility to convert a variety of objects\n * into the File class.\n *\n * For convenience, you can also pass a fetch Response, or in Node,\n * the result of fs.createReadStream().\n */\nexport type Uploadable = File | Response | FsReadStream | BunFile;\n\n/**\n * Construct a `File` instance. This is used to ensure a helpful error is thrown\n * for environments that don't define a global `File` yet.\n */\nexport function makeFile(\n  fileBits: BlobPart[],\n  fileName: string | undefined,\n  options?: FilePropertyBag,\n): File {\n  checkFileSupport();\n  return new File(fileBits as any, fileName ?? 'unknown_file', options);\n}\n\nexport function getName(value: any): string | undefined {\n  return (\n    (\n      (typeof value === 'object' &&\n        value !== null &&\n        (('name' in value && value.name && String(value.name)) ||\n          ('url' in value && value.url && String(value.url)) ||\n          ('filename' in value && value.filename && String(value.filename)) ||\n          ('path' in value && value.path && String(value.path)))) ||\n      ''\n    )\n      .split(/[\\\\/]/)\n      .pop() || undefined\n  );\n}\n\nexport const isAsyncIterable = (value: any): value is AsyncIterable<any> =>\n  value != null && typeof value === 'object' && typeof value[Symbol.asyncIterator] === 'function';\n\n/**\n * Returns a multipart/form-data request if any part of the given request body contains a File / Blob value.\n * Otherwise returns the request as is.\n */\nexport const maybeMultipartFormRequestOptions = async (\n  opts: RequestOptions,\n  fetch: BaseAnthropic | Fetch,\n): Promise<RequestOptions> => {\n  if (!hasUploadableValue(opts.body)) return opts;\n\n  return { ...opts, body: await createForm(opts.body, fetch) };\n};\n\ntype MultipartFormRequestOptions = Omit<RequestOptions, 'body'> & { body: unknown };\n\nexport const multipartFormRequestOptions = async (\n  opts: MultipartFormRequestOptions,\n  fetch: BaseAnthropic | Fetch,\n): Promise<RequestOptions> => {\n  return { ...opts, body: await createForm(opts.body, fetch) };\n};\n\nconst supportsFormDataMap = /* @__PURE__ */ new WeakMap<Fetch, Promise<boolean>>();\n\n/**\n * node-fetch doesn't support the global FormData object in recent node versions. Instead of sending\n * properly-encoded form data, it just stringifies the object, resulting in a request body of \"[object FormData]\".\n * This function detects if the fetch function provided supports the global FormData object to avoid\n * confusing error messages later on.\n */\nfunction supportsFormData(fetchObject: BaseAnthropic | Fetch): Promise<boolean> {\n  const fetch: Fetch = typeof fetchObject === 'function' ? fetchObject : (fetchObject as any).fetch;\n  const cached = supportsFormDataMap.get(fetch);\n  if (cached) return cached;\n  const promise = (async () => {\n    try {\n      const FetchResponse = (\n        'Response' in fetch ?\n          fetch.Response\n        : (await fetch('data:,')).constructor) as typeof Response;\n      const data = new FormData();\n      if (data.toString() === (await new FetchResponse(data).text())) {\n        return false;\n      }\n      return true;\n    } catch {\n      // avoid false negatives\n      return true;\n    }\n  })();\n  supportsFormDataMap.set(fetch, promise);\n  return promise;\n}\n\nexport const createForm = async <T = Record<string, unknown>>(\n  body: T | undefined,\n  fetch: BaseAnthropic | Fetch,\n): Promise<FormData> => {\n  if (!(await supportsFormData(fetch))) {\n    throw new TypeError(\n      'The provided fetch function does not support file uploads with the current global FormData class.',\n    );\n  }\n  const form = new FormData();\n  await Promise.all(Object.entries(body || {}).map(([key, value]) => addFormValue(form, key, value)));\n  return form;\n};\n\n// We check for Blob not File because Bun.File doesn't inherit from File,\n// but they both inherit from Blob and have a `name` property at runtime.\nconst isNamedBlob = (value: unknown): value is Blob => value instanceof Blob && 'name' in value;\n\nconst isUploadable = (value: unknown) =>\n  typeof value === 'object' &&\n  value !== null &&\n  (value instanceof Response || isAsyncIterable(value) || isNamedBlob(value));\n\nconst hasUploadableValue = (value: unknown): boolean => {\n  if (isUploadable(value)) return true;\n  if (Array.isArray(value)) return value.some(hasUploadableValue);\n  if (value && typeof value === 'object') {\n    for (const k in value) {\n      if (hasUploadableValue((value as any)[k])) return true;\n    }\n  }\n  return false;\n};\n\nconst addFormValue = async (form: FormData, key: string, value: unknown): Promise<void> => {\n  if (value === undefined) return;\n  if (value == null) {\n    throw new TypeError(\n      `Received null for \"${key}\"; to pass null in FormData, you must use the string 'null'`,\n    );\n  }\n\n  // TODO: make nested formats configurable\n  if (typeof value === 'string' || typeof value === 'number' || typeof value === 'boolean') {\n    form.append(key, String(value));\n  } else if (value instanceof Response) {\n    let options = {} as FilePropertyBag;\n    const contentType = value.headers.get('Content-Type');\n    if (contentType) {\n      options = { type: contentType };\n    }\n\n    form.append(key, makeFile([await value.blob()], getName(value), options));\n  } else if (isAsyncIterable(value)) {\n    form.append(key, makeFile([await new Response(ReadableStreamFrom(value)).blob()], getName(value)));\n  } else if (isNamedBlob(value)) {\n    form.append(key, makeFile([value], getName(value), { type: value.type }));\n  } else if (Array.isArray(value)) {\n    await Promise.all(value.map((entry) => addFormValue(form, key + '[]', entry)));\n  } else if (typeof value === 'object') {\n    await Promise.all(\n      Object.entries(value).map(([name, prop]) => addFormValue(form, `${key}[${name}]`, prop)),\n    );\n  } else {\n    throw new TypeError(\n      `Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${value} instead`,\n    );\n  }\n};\n", "import { BlobPart, getName, makeFile, isAsyncIterable } from './uploads';\nimport type { FilePropertyBag } from './builtin-types';\nimport { checkFileSupport } from './uploads';\n\ntype BlobLikePart = string | ArrayBuffer | ArrayBufferView | BlobLike | DataView;\n\n/**\n * Intended to match DOM Blob, node-fetch Blob, node:buffer Blob, etc.\n * Don't add arrayBuffer here, node-fetch doesn't have it\n */\ninterface BlobLike {\n  /** [MDN Reference](https://developer.mozilla.org/docs/Web/API/Blob/size) */\n  readonly size: number;\n  /** [MDN Reference](https://developer.mozilla.org/docs/Web/API/Blob/type) */\n  readonly type: string;\n  /** [MDN Reference](https://developer.mozilla.org/docs/Web/API/Blob/text) */\n  text(): Promise<string>;\n  /** [MDN Reference](https://developer.mozilla.org/docs/Web/API/Blob/slice) */\n  slice(start?: number, end?: number): BlobLike;\n}\n\n/**\n * This check adds the arrayBuffer() method type because it is available and used at runtime\n */\nconst isBlobLike = (value: any): value is BlobLike & { arrayBuffer(): Promise<ArrayBuffer> } =>\n  value != null &&\n  typeof value === 'object' &&\n  typeof value.size === 'number' &&\n  typeof value.type === 'string' &&\n  typeof value.text === 'function' &&\n  typeof value.slice === 'function' &&\n  typeof value.arrayBuffer === 'function';\n\n/**\n * Intended to match DOM File, node:buffer File, undici File, etc.\n */\ninterface FileLike extends BlobLike {\n  /** [MDN Reference](https://developer.mozilla.org/docs/Web/API/File/lastModified) */\n  readonly lastModified: number;\n  /** [MDN Reference](https://developer.mozilla.org/docs/Web/API/File/name) */\n  readonly name?: string | undefined;\n}\n\n/**\n * This check adds the arrayBuffer() method type because it is available and used at runtime\n */\nconst isFileLike = (value: any): value is FileLike & { arrayBuffer(): Promise<ArrayBuffer> } =>\n  value != null &&\n  typeof value === 'object' &&\n  typeof value.name === 'string' &&\n  typeof value.lastModified === 'number' &&\n  isBlobLike(value);\n\n/**\n * Intended to match DOM Response, node-fetch Response, undici Response, etc.\n */\nexport interface ResponseLike {\n  url: string;\n  blob(): Promise<BlobLike>;\n}\n\nconst isResponseLike = (value: any): value is ResponseLike =>\n  value != null &&\n  typeof value === 'object' &&\n  typeof value.url === 'string' &&\n  typeof value.blob === 'function';\n\nexport type ToFileInput =\n  | FileLike\n  | ResponseLike\n  | Exclude<BlobLikePart, string>\n  | AsyncIterable<BlobLikePart>;\n\n/**\n * Helper for creating a {@link File} to pass to an SDK upload method from a variety of different data formats\n * @param value the raw content of the file. Can be an {@link Uploadable}, BlobLikePart, or AsyncIterable of BlobLikeParts\n * @param {string=} name the name of the file. If omitted, toFile will try to determine a file name from bits if possible\n * @param {Object=} options additional properties\n * @param {string=} options.type the MIME type of the content\n * @param {number=} options.lastModified the last modified timestamp\n * @returns a {@link File} with the given properties\n */\nexport async function toFile(\n  value: ToFileInput | PromiseLike<ToFileInput>,\n  name?: string | null | undefined,\n  options?: FilePropertyBag | undefined,\n): Promise<File> {\n  checkFileSupport();\n\n  // If it's a promise, resolve it.\n  value = await value;\n\n  name ||= getName(value);\n\n  // If we've been given a `File` we don't need to do anything if the name / options\n  // have not been customised.\n  if (isFileLike(value)) {\n    if (value instanceof File && name == null && options == null) {\n      return value;\n    }\n    return makeFile([await value.arrayBuffer()], name ?? value.name, {\n      type: value.type,\n      lastModified: value.lastModified,\n      ...options,\n    });\n  }\n\n  if (isResponseLike(value)) {\n    const blob = await value.blob();\n    name ||= new URL(value.url).pathname.split(/[\\\\/]/).pop();\n\n    return makeFile(await getBytes(blob), name, options);\n  }\n\n  const parts = await getBytes(value);\n\n  if (!options?.type) {\n    const type = parts.find((part) => typeof part === 'object' && 'type' in part && part.type);\n    if (typeof type === 'string') {\n      options = { ...options, type };\n    }\n  }\n\n  return makeFile(parts, name, options);\n}\n\nasync function getBytes(value: BlobLikePart | AsyncIterable<BlobLikePart>): Promise<Array<BlobPart>> {\n  let parts: Array<BlobPart> = [];\n  if (\n    typeof value === 'string' ||\n    ArrayBuffer.isView(value) || // includes Uint8Array, Buffer, etc.\n    value instanceof ArrayBuffer\n  ) {\n    parts.push(value);\n  } else if (isBlobLike(value)) {\n    parts.push(value instanceof Blob ? value : await value.arrayBuffer());\n  } else if (\n    isAsyncIterable(value) // includes Readable, ReadableStream, etc.\n  ) {\n    for await (const chunk of value) {\n      parts.push(...(await getBytes(chunk as BlobLikePart))); // TODO, consider validating?\n    }\n  } else {\n    const constructor = value?.constructor?.name;\n    throw new Error(\n      `Unexpected data type: ${typeof value}${\n        constructor ? `; constructor: ${constructor}` : ''\n      }${propsForError(value)}`,\n    );\n  }\n\n  return parts;\n}\n\nfunction propsForError(value: unknown): string {\n  if (typeof value !== 'object' || value === null) return '';\n  const props = Object.getOwnPropertyNames(value);\n  return `; props: [${props.map((p) => `\"${p}\"`).join(', ')}]`;\n}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { BaseAnthropic } from '../client';\n\nexport abstract class APIResource {\n  protected _client: BaseAnthropic;\n\n  constructor(client: BaseAnthropic) {\n    this._client = client;\n  }\n}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { isReadonlyArray } from './utils/values';\n\ntype HeaderValue = string | undefined | null;\nexport type HeadersLike =\n  | Headers\n  | readonly HeaderValue[][]\n  | Record<string, HeaderValue | readonly HeaderValue[]>\n  | undefined\n  | null\n  | NullableHeaders;\n\nconst brand_privateNullableHeaders = Symbol.for('brand.privateNullableHeaders') as symbol & {\n  description: 'brand.privateNullableHeaders';\n};\n\n/**\n * @internal\n * Users can pass explicit nulls to unset default headers. When we parse them\n * into a standard headers type we need to preserve that information.\n */\nexport type NullableHeaders = {\n  /** Brand check, prevent users from creating a NullableHeaders. */\n  [_: typeof brand_privateNullableHeaders]: true;\n  /** Parsed headers. */\n  values: Headers;\n  /** Set of lowercase header names explicitly set to null. */\n  nulls: Set<string>;\n};\n\nfunction* iterateHeaders(headers: HeadersLike): IterableIterator<readonly [string, string | null]> {\n  if (!headers) return;\n\n  if (brand_privateNullableHeaders in headers) {\n    const { values, nulls } = headers as NullableHeaders;\n    yield* values.entries();\n    for (const name of nulls) {\n      yield [name, null];\n    }\n    return;\n  }\n\n  let shouldClear = false;\n  let iter: Iterable<readonly (HeaderValue | readonly HeaderValue[])[]>;\n  if (headers instanceof Headers) {\n    iter = headers.entries();\n  } else if (isReadonlyArray(headers)) {\n    iter = headers;\n  } else {\n    shouldClear = true;\n    iter = Object.entries(headers ?? {});\n  }\n  for (let row of iter) {\n    const name = row[0];\n    if (typeof name !== 'string') throw new TypeError('expected header name to be a string');\n    const values = isReadonlyArray(row[1]) ? row[1] : [row[1]];\n    let didClear = false;\n    for (const value of values) {\n      if (value === undefined) continue;\n\n      // Objects keys always overwrite older headers, they never append.\n      // Yield a null to clear the header before adding the new values.\n      if (shouldClear && !didClear) {\n        didClear = true;\n        yield [name, null];\n      }\n      yield [name, value];\n    }\n  }\n}\n\nexport const buildHeaders = (newHeaders: HeadersLike[]): NullableHeaders => {\n  const targetHeaders = new Headers();\n  const nullHeaders = new Set<string>();\n  for (const headers of newHeaders) {\n    const seenHeaders = new Set<string>();\n    for (const [name, value] of iterateHeaders(headers)) {\n      const lowerName = name.toLowerCase();\n      if (!seenHeaders.has(lowerName)) {\n        targetHeaders.delete(name);\n        seenHeaders.add(lowerName);\n      }\n      if (value === null) {\n        targetHeaders.delete(name);\n        nullHeaders.add(lowerName);\n      } else {\n        targetHeaders.append(name, value);\n        nullHeaders.delete(lowerName);\n      }\n    }\n  }\n  return { [brand_privateNullableHeaders]: true, values: targetHeaders, nulls: nullHeaders };\n};\n\nexport const isEmptyHeaders = (headers: HeadersLike) => {\n  for (const _ of iterateHeaders(headers)) return false;\n  return true;\n};\n", "import { AnthropicError } from '../../core/error';\n\n/**\n * Percent-encode everything that isn't safe to have in a path without encoding safe chars.\n *\n * Taken from https://datatracker.ietf.org/doc/html/rfc3986#section-3.3:\n * > unreserved  = ALPHA / DIGIT / \"-\" / \".\" / \"_\" / \"~\"\n * > sub-delims  = \"!\" / \"$\" / \"&\" / \"'\" / \"(\" / \")\" / \"*\" / \"+\" / \",\" / \";\" / \"=\"\n * > pchar       = unreserved / pct-encoded / sub-delims / \":\" / \"@\"\n */\nexport function encodeURIPath(str: string) {\n  return str.replace(/[^A-Za-z0-9\\-._~!$&'()*+,;=:@]+/g, encodeURIComponent);\n}\n\nconst EMPTY = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.create(null));\n\nexport const createPathTagFunction = (pathEncoder = encodeURIPath) =>\n  function path(statics: readonly string[], ...params: readonly unknown[]): string {\n    // If there are no params, no processing is needed.\n    if (statics.length === 1) return statics[0]!;\n\n    let postPath = false;\n    const invalidSegments = [];\n    const path = statics.reduce((previousValue, currentValue, index) => {\n      if (/[?#]/.test(currentValue)) {\n        postPath = true;\n      }\n      const value = params[index];\n      let encoded = (postPath ? encodeURIComponent : pathEncoder)('' + value);\n      if (\n        index !== params.length &&\n        (value == null ||\n          (typeof value === 'object' &&\n            // handle values from other realms\n            value.toString ===\n              Object.getPrototypeOf(Object.getPrototypeOf((value as any).hasOwnProperty ?? EMPTY) ?? EMPTY)\n                ?.toString))\n      ) {\n        encoded = value + '';\n        invalidSegments.push({\n          start: previousValue.length + currentValue.length,\n          length: encoded.length,\n          error: `Value of type ${Object.prototype.toString\n            .call(value)\n            .slice(8, -1)} is not a valid path parameter`,\n        });\n      }\n      return previousValue + currentValue + (index === params.length ? '' : encoded);\n    }, '');\n\n    const pathOnly = path.split(/[?#]/, 1)[0]!;\n    const invalidSegmentPattern = /(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)/gi;\n    let match;\n\n    // Find all invalid segments\n    while ((match = invalidSegmentPattern.exec(pathOnly)) !== null) {\n      invalidSegments.push({\n        start: match.index,\n        length: match[0].length,\n        error: `Value \"${match[0]}\" can\\'t be safely passed as a path parameter`,\n      });\n    }\n\n    invalidSegments.sort((a, b) => a.start - b.start);\n\n    if (invalidSegments.length > 0) {\n      let lastEnd = 0;\n      const underline = invalidSegments.reduce((acc, segment) => {\n        const spaces = ' '.repeat(segment.start - lastEnd);\n        const arrows = '^'.repeat(segment.length);\n        lastEnd = segment.start + segment.length;\n        return acc + spaces + arrows;\n      }, '');\n\n      throw new AnthropicError(\n        `Path parameters result in path with invalid segments:\\n${invalidSegments\n          .map((e) => e.error)\n          .join('\\n')}\\n${path}\\n${underline}`,\n      );\n    }\n\n    return path;\n  };\n\n/**\n * URI-encodes path params and ensures no unsafe /./ or /../ path segments are introduced.\n */\nexport const path = /* @__PURE__ */ createPathTagFunction(encodeURIPath);\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { APIResource } from '../../core/resource';\nimport * as BetaAPI from './beta';\nimport { APIPromise } from '../../core/api-promise';\nimport { Page, type PageParams, PagePromise } from '../../core/pagination';\nimport { type Uploadable } from '../../core/uploads';\nimport { buildHeaders } from '../../internal/headers';\nimport { RequestOptions } from '../../internal/request-options';\nimport { multipartFormRequestOptions } from '../../internal/uploads';\nimport { path } from '../../internal/utils/path';\n\nexport class Files extends APIResource {\n  /**\n   * List Files\n   *\n   * @example\n   * ```ts\n   * // Automatically fetches more pages as needed.\n   * for await (const fileMetadata of client.beta.files.list()) {\n   *   // ...\n   * }\n   * ```\n   */\n  list(\n    params: FileListParams | null | undefined = {},\n    options?: RequestOptions,\n  ): PagePromise<FileMetadataPage, FileMetadata> {\n    const { betas, ...query } = params ?? {};\n    return this._client.getAPIList('/v1/files', Page<FileMetadata>, {\n      query,\n      ...options,\n      headers: buildHeaders([\n        { 'anthropic-beta': [...(betas ?? []), 'files-api-2025-04-14'].toString() },\n        options?.headers,\n      ]),\n    });\n  }\n\n  /**\n   * Delete File\n   *\n   * @example\n   * ```ts\n   * const deletedFile = await client.beta.files.delete(\n   *   'file_id',\n   * );\n   * ```\n   */\n  delete(\n    fileID: string,\n    params: FileDeleteParams | null | undefined = {},\n    options?: RequestOptions,\n  ): APIPromise<DeletedFile> {\n    const { betas } = params ?? {};\n    return this._client.delete(path`/v1/files/${fileID}`, {\n      ...options,\n      headers: buildHeaders([\n        { 'anthropic-beta': [...(betas ?? []), 'files-api-2025-04-14'].toString() },\n        options?.headers,\n      ]),\n    });\n  }\n\n  /**\n   * Download File\n   *\n   * @example\n   * ```ts\n   * const response = await client.beta.files.download(\n   *   'file_id',\n   * );\n   *\n   * const content = await response.blob();\n   * console.log(content);\n   * ```\n   */\n  download(\n    fileID: string,\n    params: FileDownloadParams | null | undefined = {},\n    options?: RequestOptions,\n  ): APIPromise<Response> {\n    const { betas } = params ?? {};\n    return this._client.get(path`/v1/files/${fileID}/content`, {\n      ...options,\n      headers: buildHeaders([\n        {\n          'anthropic-beta': [...(betas ?? []), 'files-api-2025-04-14'].toString(),\n          Accept: 'application/binary',\n        },\n        options?.headers,\n      ]),\n      __binaryResponse: true,\n    });\n  }\n\n  /**\n   * Get File Metadata\n   *\n   * @example\n   * ```ts\n   * const fileMetadata =\n   *   await client.beta.files.retrieveMetadata('file_id');\n   * ```\n   */\n  retrieveMetadata(\n    fileID: string,\n    params: FileRetrieveMetadataParams | null | undefined = {},\n    options?: RequestOptions,\n  ): APIPromise<FileMetadata> {\n    const { betas } = params ?? {};\n    return this._client.get(path`/v1/files/${fileID}`, {\n      ...options,\n      headers: buildHeaders([\n        { 'anthropic-beta': [...(betas ?? []), 'files-api-2025-04-14'].toString() },\n        options?.headers,\n      ]),\n    });\n  }\n\n  /**\n   * Upload File\n   *\n   * @example\n   * ```ts\n   * const fileMetadata = await client.beta.files.upload({\n   *   file: fs.createReadStream('path/to/file'),\n   * });\n   * ```\n   */\n  upload(params: FileUploadParams, options?: RequestOptions): APIPromise<FileMetadata> {\n    const { betas, ...body } = params;\n    return this._client.post(\n      '/v1/files',\n      multipartFormRequestOptions(\n        {\n          body,\n          ...options,\n          headers: buildHeaders([\n            { 'anthropic-beta': [...(betas ?? []), 'files-api-2025-04-14'].toString() },\n            options?.headers,\n          ]),\n        },\n        this._client,\n      ),\n    );\n  }\n}\n\nexport type FileMetadataPage = Page<FileMetadata>;\n\nexport interface DeletedFile {\n  /**\n   * ID of the deleted file.\n   */\n  id: string;\n\n  /**\n   * Deleted object type.\n   *\n   * For file deletion, this is always `\"file_deleted\"`.\n   */\n  type?: 'file_deleted';\n}\n\nexport interface FileMetadata {\n  /**\n   * Unique object identifier.\n   *\n   * The format and length of IDs may change over time.\n   */\n  id: string;\n\n  /**\n   * RFC 3339 datetime string representing when the file was created.\n   */\n  created_at: string;\n\n  /**\n   * Original filename of the uploaded file.\n   */\n  filename: string;\n\n  /**\n   * MIME type of the file.\n   */\n  mime_type: string;\n\n  /**\n   * Size of the file in bytes.\n   */\n  size_bytes: number;\n\n  /**\n   * Object type.\n   *\n   * For files, this is always `\"file\"`.\n   */\n  type: 'file';\n\n  /**\n   * Whether the file can be downloaded.\n   */\n  downloadable?: boolean;\n}\n\nexport interface FileListParams extends PageParams {\n  /**\n   * Header param: Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport interface FileDeleteParams {\n  /**\n   * Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport interface FileDownloadParams {\n  /**\n   * Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport interface FileRetrieveMetadataParams {\n  /**\n   * Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport interface FileUploadParams {\n  /**\n   * Body param: The file to upload\n   */\n  file: Uploadable;\n\n  /**\n   * Header param: Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport declare namespace Files {\n  export {\n    type DeletedFile as DeletedFile,\n    type FileMetadata as FileMetadata,\n    type FileMetadataPage as FileMetadataPage,\n    type FileListParams as FileListParams,\n    type FileDeleteParams as FileDeleteParams,\n    type FileDownloadParams as FileDownloadParams,\n    type FileRetrieveMetadataParams as FileRetrieveMetadataParams,\n    type FileUploadParams as FileUploadParams,\n  };\n}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { APIResource } from '../../core/resource';\nimport * as BetaAPI from './beta';\nimport { APIPromise } from '../../core/api-promise';\nimport { Page, type PageParams, PagePromise } from '../../core/pagination';\nimport { buildHeaders } from '../../internal/headers';\nimport { RequestOptions } from '../../internal/request-options';\nimport { path } from '../../internal/utils/path';\n\nexport class Models extends APIResource {\n  /**\n   * Get a specific model.\n   *\n   * The Models API response can be used to determine information about a specific\n   * model or resolve a model alias to a model ID.\n   *\n   * @example\n   * ```ts\n   * const betaModelInfo = await client.beta.models.retrieve(\n   *   'model_id',\n   * );\n   * ```\n   */\n  retrieve(\n    modelID: string,\n    params: ModelRetrieveParams | null | undefined = {},\n    options?: RequestOptions,\n  ): APIPromise<BetaModelInfo> {\n    const { betas } = params ?? {};\n    return this._client.get(path`/v1/models/${modelID}?beta=true`, {\n      ...options,\n      headers: buildHeaders([\n        { ...(betas?.toString() != null ? { 'anthropic-beta': betas?.toString() } : undefined) },\n        options?.headers,\n      ]),\n    });\n  }\n\n  /**\n   * List available models.\n   *\n   * The Models API response can be used to determine which models are available for\n   * use in the API. More recently released models are listed first.\n   *\n   * @example\n   * ```ts\n   * // Automatically fetches more pages as needed.\n   * for await (const betaModelInfo of client.beta.models.list()) {\n   *   // ...\n   * }\n   * ```\n   */\n  list(\n    params: ModelListParams | null | undefined = {},\n    options?: RequestOptions,\n  ): PagePromise<BetaModelInfosPage, BetaModelInfo> {\n    const { betas, ...query } = params ?? {};\n    return this._client.getAPIList('/v1/models?beta=true', Page<BetaModelInfo>, {\n      query,\n      ...options,\n      headers: buildHeaders([\n        { ...(betas?.toString() != null ? { 'anthropic-beta': betas?.toString() } : undefined) },\n        options?.headers,\n      ]),\n    });\n  }\n}\n\nexport type BetaModelInfosPage = Page<BetaModelInfo>;\n\nexport interface BetaModelInfo {\n  /**\n   * Unique model identifier.\n   */\n  id: string;\n\n  /**\n   * RFC 3339 datetime string representing the time at which the model was released.\n   * May be set to an epoch value if the release date is unknown.\n   */\n  created_at: string;\n\n  /**\n   * A human-readable name for the model.\n   */\n  display_name: string;\n\n  /**\n   * Object type.\n   *\n   * For Models, this is always `\"model\"`.\n   */\n  type: 'model';\n}\n\nexport interface ModelRetrieveParams {\n  /**\n   * Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport interface ModelListParams extends PageParams {\n  /**\n   * Header param: Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport declare namespace Models {\n  export {\n    type BetaModelInfo as BetaModelInfo,\n    type BetaModelInfosPage as BetaModelInfosPage,\n    type ModelRetrieveParams as ModelRetrieveParams,\n    type ModelListParams as ModelListParams,\n  };\n}\n", "// File containing shared constants\n\n/**\n * Model-specific timeout constraints for non-streaming requests\n */\nexport const MODEL_NONSTREAMING_TOKENS: Record<string, number> = {\n  'claude-opus-4-20250514': 8192,\n  'claude-opus-4-0': 8192,\n  'claude-4-opus-20250514': 8192,\n  'anthropic.claude-opus-4-20250514-v1:0': 8192,\n  'claude-opus-4@20250514': 8192,\n  'claude-opus-4-1-20250805': 8192,\n  'anthropic.claude-opus-4-1-20250805-v1:0': 8192,\n  'claude-opus-4-1@20250805': 8192,\n};\n", "import type { Logger } from '../client';\nimport { AnthropicError } from '../core/error';\nimport {\n  BetaContentBlock,\n  BetaJSONOutputFormat,\n  BetaMessage,\n  BetaTextBlock,\n  MessageCreateParams,\n} from '../resources/beta/messages/messages';\n\n// vendored from typefest just to make things look a bit nicer on hover\ntype Simplify<T> = { [KeyType in keyof T]: T[KeyType] } & {};\n\nexport type BetaParseableMessageCreateParams = Simplify<\n  Omit<MessageCreateParams, 'output_format'> & {\n    output_format?: BetaJSONOutputFormat | AutoParseableBetaOutputFormat<any> | null;\n  }\n>;\n\nexport type ExtractParsedContentFromBetaParams<Params extends BetaParseableMessageCreateParams> =\n  Params['output_format'] extends AutoParseableBetaOutputFormat<infer P> ? P : null;\n\nexport type AutoParseableBetaOutputFormat<ParsedT> = BetaJSONOutputFormat & {\n  parse(content: string): ParsedT;\n};\n\nexport type ParsedBetaMessage<ParsedT> = BetaMessage & {\n  content: Array<ParsedBetaContentBlock<ParsedT>>;\n  parsed_output: ParsedT | null;\n};\n\nexport type ParsedBetaContentBlock<ParsedT> =\n  | (BetaTextBlock & { parsed_output: ParsedT | null })\n  | Exclude<BetaContentBlock, BetaTextBlock>;\n\nexport function maybeParseBetaMessage<Params extends BetaParseableMessageCreateParams | null>(\n  message: BetaMessage,\n  params: Params,\n  opts: { logger: Logger },\n): ParsedBetaMessage<ExtractParsedContentFromBetaParams<NonNullable<Params>>> {\n  if (!params || !('parse' in (params.output_format ?? {}))) {\n    return {\n      ...message,\n      content: message.content.map((block) => {\n        if (block.type === 'text') {\n          const parsedBlock = Object.defineProperty({ ...block }, 'parsed_output', {\n            value: null,\n            enumerable: false,\n          }) as ParsedBetaContentBlock<ExtractParsedContentFromBetaParams<NonNullable<Params>>>;\n\n          return Object.defineProperty(parsedBlock, 'parsed', {\n            get() {\n              opts.logger.warn(\n                'The `parsed` property on `text` blocks is deprecated, please use `parsed_output` instead.',\n              );\n              return null;\n            },\n            enumerable: false,\n          });\n        }\n        return block;\n      }),\n      parsed_output: null,\n    } as ParsedBetaMessage<ExtractParsedContentFromBetaParams<NonNullable<Params>>>;\n  }\n\n  return parseBetaMessage(message, params, opts);\n}\n\nexport function parseBetaMessage<Params extends BetaParseableMessageCreateParams>(\n  message: BetaMessage,\n  params: Params,\n  opts: { logger: Logger },\n): ParsedBetaMessage<ExtractParsedContentFromBetaParams<Params>> {\n  let firstParsedOutput: ReturnType<typeof parseBetaOutputFormat<Params>> | null = null;\n\n  const content: Array<ParsedBetaContentBlock<ExtractParsedContentFromBetaParams<Params>>> =\n    message.content.map((block) => {\n      if (block.type === 'text') {\n        const parsedOutput = parseBetaOutputFormat(params, block.text);\n\n        if (firstParsedOutput === null) {\n          firstParsedOutput = parsedOutput;\n        }\n\n        const parsedBlock = Object.defineProperty({ ...block }, 'parsed_output', {\n          value: parsedOutput,\n          enumerable: false,\n        }) as ParsedBetaContentBlock<ExtractParsedContentFromBetaParams<Params>>;\n        return Object.defineProperty(parsedBlock, 'parsed', {\n          get() {\n            opts.logger.warn(\n              'The `parsed` property on `text` blocks is deprecated, please use `parsed_output` instead.',\n            );\n            return parsedOutput;\n          },\n          enumerable: false,\n        });\n      }\n      return block;\n    });\n\n  return {\n    ...message,\n    content,\n    parsed_output: firstParsedOutput,\n  } as ParsedBetaMessage<ExtractParsedContentFromBetaParams<Params>>;\n}\n\nfunction parseBetaOutputFormat<Params extends BetaParseableMessageCreateParams>(\n  params: Params,\n  content: string,\n): ExtractParsedContentFromBetaParams<Params> | null {\n  if (params.output_format?.type !== 'json_schema') {\n    return null;\n  }\n\n  try {\n    if ('parse' in params.output_format) {\n      return params.output_format.parse(content);\n    }\n\n    return JSON.parse(content);\n  } catch (error) {\n    throw new AnthropicError(`Failed to parse structured output: ${error}`);\n  }\n}\n", "type Token = {\n  type: string;\n  value: string;\n};\n\nconst tokenize = (input: string): Token[] => {\n    let current = 0;\n    let tokens: Token[] = [];\n\n    while (current < input.length) {\n      let char = input[current];\n\n      if (char === '\\\\') {\n        current++;\n        continue;\n      }\n\n      if (char === '{') {\n        tokens.push({\n          type: 'brace',\n          value: '{',\n        });\n\n        current++;\n        continue;\n      }\n\n      if (char === '}') {\n        tokens.push({\n          type: 'brace',\n          value: '}',\n        });\n\n        current++;\n        continue;\n      }\n\n      if (char === '[') {\n        tokens.push({\n          type: 'paren',\n          value: '[',\n        });\n\n        current++;\n        continue;\n      }\n\n      if (char === ']') {\n        tokens.push({\n          type: 'paren',\n          value: ']',\n        });\n\n        current++;\n        continue;\n      }\n\n      if (char === ':') {\n        tokens.push({\n          type: 'separator',\n          value: ':',\n        });\n\n        current++;\n        continue;\n      }\n\n      if (char === ',') {\n        tokens.push({\n          type: 'delimiter',\n          value: ',',\n        });\n\n        current++;\n        continue;\n      }\n\n      if (char === '\"') {\n        let value = '';\n        let danglingQuote = false;\n\n        char = input[++current];\n\n        while (char !== '\"') {\n          if (current === input.length) {\n            danglingQuote = true;\n            break;\n          }\n\n          if (char === '\\\\') {\n            current++;\n            if (current === input.length) {\n              danglingQuote = true;\n              break;\n            }\n            value += char + input[current];\n            char = input[++current];\n          } else {\n            value += char;\n            char = input[++current];\n          }\n        }\n\n        char = input[++current];\n\n        if (!danglingQuote) {\n          tokens.push({\n            type: 'string',\n            value,\n          });\n        }\n        continue;\n      }\n\n      let WHITESPACE = /\\s/;\n      if (char && WHITESPACE.test(char)) {\n        current++;\n        continue;\n      }\n\n      let NUMBERS = /[0-9]/;\n      if ((char && NUMBERS.test(char)) || char === '-' || char === '.') {\n        let value = '';\n\n        if (char === '-') {\n          value += char;\n          char = input[++current];\n        }\n\n        while ((char && NUMBERS.test(char)) || char === '.') {\n          value += char;\n          char = input[++current];\n        }\n\n        tokens.push({\n          type: 'number',\n          value,\n        });\n        continue;\n      }\n\n      let LETTERS = /[a-z]/i;\n      if (char && LETTERS.test(char)) {\n        let value = '';\n\n        while (char && LETTERS.test(char)) {\n          if (current === input.length) {\n            break;\n          }\n          value += char;\n          char = input[++current];\n        }\n\n        if (value == 'true' || value == 'false' || value === 'null') {\n          tokens.push({\n            type: 'name',\n            value,\n          });\n        } else {\n          // unknown token, e.g. `nul` which isn't quite `null`\n          current++;\n          continue;\n        }\n        continue;\n      }\n\n      current++;\n    }\n\n    return tokens;\n  },\n  strip = (tokens: Token[]): Token[] => {\n    if (tokens.length === 0) {\n      return tokens;\n    }\n\n    let lastToken = tokens[tokens.length - 1]!;\n\n    switch (lastToken.type) {\n      case 'separator':\n        tokens = tokens.slice(0, tokens.length - 1);\n        return strip(tokens);\n        break;\n      case 'number':\n        let lastCharacterOfLastToken = lastToken.value[lastToken.value.length - 1];\n        if (lastCharacterOfLastToken === '.' || lastCharacterOfLastToken === '-') {\n          tokens = tokens.slice(0, tokens.length - 1);\n          return strip(tokens);\n        }\n      case 'string':\n        let tokenBeforeTheLastToken = tokens[tokens.length - 2];\n        if (tokenBeforeTheLastToken?.type === 'delimiter') {\n          tokens = tokens.slice(0, tokens.length - 1);\n          return strip(tokens);\n        } else if (tokenBeforeTheLastToken?.type === 'brace' && tokenBeforeTheLastToken.value === '{') {\n          tokens = tokens.slice(0, tokens.length - 1);\n          return strip(tokens);\n        }\n        break;\n      case 'delimiter':\n        tokens = tokens.slice(0, tokens.length - 1);\n        return strip(tokens);\n        break;\n    }\n\n    return tokens;\n  },\n  unstrip = (tokens: Token[]): Token[] => {\n    let tail: string[] = [];\n\n    tokens.map((token) => {\n      if (token.type === 'brace') {\n        if (token.value === '{') {\n          tail.push('}');\n        } else {\n          tail.splice(tail.lastIndexOf('}'), 1);\n        }\n      }\n      if (token.type === 'paren') {\n        if (token.value === '[') {\n          tail.push(']');\n        } else {\n          tail.splice(tail.lastIndexOf(']'), 1);\n        }\n      }\n    });\n\n    if (tail.length > 0) {\n      tail.reverse().map((item) => {\n        if (item === '}') {\n          tokens.push({\n            type: 'brace',\n            value: '}',\n          });\n        } else if (item === ']') {\n          tokens.push({\n            type: 'paren',\n            value: ']',\n          });\n        }\n      });\n    }\n\n    return tokens;\n  },\n  generate = (tokens: Token[]): string => {\n    let output = '';\n\n    tokens.map((token) => {\n      switch (token.type) {\n        case 'string':\n          output += '\"' + token.value + '\"';\n          break;\n        default:\n          output += token.value;\n          break;\n      }\n    });\n\n    return output;\n  },\n  partialParse = (input: string): unknown => JSON.parse(generate(unstrip(strip(tokenize(input)))));\n\nexport { partialParse };\n", "import { partialParse } from '../_vendor/partial-json-parser/parser';\nimport type { Logger } from '../client';\nimport { AnthropicError, APIUserAbortError } from '../error';\nimport { isAbortError } from '../internal/errors';\nimport { type RequestOptions } from '../internal/request-options';\nimport {\n  type BetaContentBlock,\n  type BetaMCPToolUseBlock,\n  type BetaMessage,\n  type BetaMessageParam,\n  Messages as BetaMessages,\n  type BetaRawMessageStreamEvent as BetaMessageStreamEvent,\n  type BetaServerToolUseBlock,\n  type BetaTextBlock,\n  type BetaTextCitation,\n  type BetaToolUseBlock,\n  type MessageCreateParams,\n  type MessageCreateParamsBase,\n  MessageCreateParamsStreaming,\n} from '../resources/beta/messages/messages';\nimport { Stream } from '../streaming';\nimport { maybeParseBetaMessage, type ParsedBetaMessage } from './beta-parser';\n\nexport interface MessageStreamEvents {\n  connect: () => void;\n  streamEvent: (event: BetaMessageStreamEvent, snapshot: BetaMessage) => void;\n  text: (textDelta: string, textSnapshot: string) => void;\n  citation: (citation: BetaTextCitation, citationsSnapshot: BetaTextCitation[]) => void;\n  inputJson: (partialJson: string, jsonSnapshot: unknown) => void;\n  thinking: (thinkingDelta: string, thinkingSnapshot: string) => void;\n  signature: (signature: string) => void;\n  message: (message: BetaMessage) => void;\n  contentBlock: (content: BetaContentBlock) => void;\n  finalMessage: (message: BetaMessage) => void;\n  error: (error: AnthropicError) => void;\n  abort: (error: APIUserAbortError) => void;\n  end: () => void;\n}\n\ntype MessageStreamEventListeners<Event extends keyof MessageStreamEvents> = {\n  listener: MessageStreamEvents[Event];\n  once?: boolean;\n}[];\n\nconst JSON_BUF_PROPERTY = '__json_buf';\n\nexport type TracksToolInput = BetaToolUseBlock | BetaServerToolUseBlock | BetaMCPToolUseBlock;\n\nfunction tracksToolInput(content: BetaContentBlock): content is TracksToolInput {\n  return content.type === 'tool_use' || content.type === 'server_tool_use' || content.type === 'mcp_tool_use';\n}\n\nexport class BetaMessageStream<ParsedT = null> implements AsyncIterable<BetaMessageStreamEvent> {\n  messages: BetaMessageParam[] = [];\n  receivedMessages: ParsedBetaMessage<ParsedT>[] = [];\n  #currentMessageSnapshot: BetaMessage | undefined;\n  #params: MessageCreateParams | null = null;\n\n  controller: AbortController = new AbortController();\n\n  #connectedPromise: Promise<Response | null>;\n  #resolveConnectedPromise: (response: Response | null) => void = () => {};\n  #rejectConnectedPromise: (error: AnthropicError) => void = () => {};\n\n  #endPromise: Promise<void>;\n  #resolveEndPromise: () => void = () => {};\n  #rejectEndPromise: (error: AnthropicError) => void = () => {};\n\n  #listeners: { [Event in keyof MessageStreamEvents]?: MessageStreamEventListeners<Event> } = {};\n\n  #ended = false;\n  #errored = false;\n  #aborted = false;\n  #catchingPromiseCreated = false;\n  #response: Response | null | undefined;\n  #request_id: string | null | undefined;\n  #logger: Logger;\n\n  constructor(params: MessageCreateParamsBase | null, opts?: { logger?: Logger | undefined }) {\n    this.#connectedPromise = new Promise<Response | null>((resolve, reject) => {\n      this.#resolveConnectedPromise = resolve;\n      this.#rejectConnectedPromise = reject;\n    });\n\n    this.#endPromise = new Promise<void>((resolve, reject) => {\n      this.#resolveEndPromise = resolve;\n      this.#rejectEndPromise = reject;\n    });\n\n    // Don't let these promises cause unhandled rejection errors.\n    // we will manually cause an unhandled rejection error later\n    // if the user hasn't registered any error listener or called\n    // any promise-returning method.\n    this.#connectedPromise.catch(() => {});\n    this.#endPromise.catch(() => {});\n\n    this.#params = params;\n    this.#logger = opts?.logger ?? console;\n  }\n\n  get response(): Response | null | undefined {\n    return this.#response;\n  }\n\n  get request_id(): string | null | undefined {\n    return this.#request_id;\n  }\n\n  /**\n   * Returns the `MessageStream` data, the raw `Response` instance and the ID of the request,\n   * returned vie the `request-id` header which is useful for debugging requests and resporting\n   * issues to Anthropic.\n   *\n   * This is the same as the `APIPromise.withResponse()` method.\n   *\n   * This method will raise an error if you created the stream using `MessageStream.fromReadableStream`\n   * as no `Response` is available.\n   */\n  async withResponse(): Promise<{\n    data: BetaMessageStream<ParsedT>;\n    response: Response;\n    request_id: string | null | undefined;\n  }> {\n    this.#catchingPromiseCreated = true;\n\n    const response = await this.#connectedPromise;\n    if (!response) {\n      throw new Error('Could not resolve a `Response` object');\n    }\n\n    return {\n      data: this,\n      response,\n      request_id: response.headers.get('request-id'),\n    };\n  }\n\n  /**\n   * Intended for use on the frontend, consuming a stream produced with\n   * `.toReadableStream()` on the backend.\n   *\n   * Note that messages sent to the model do not appear in `.on('message')`\n   * in this context.\n   */\n  static fromReadableStream(stream: ReadableStream): BetaMessageStream {\n    const runner = new BetaMessageStream(null);\n    runner._run(() => runner._fromReadableStream(stream));\n    return runner;\n  }\n\n  static createMessage<ParsedT>(\n    messages: BetaMessages,\n    params: MessageCreateParamsBase,\n    options?: RequestOptions,\n    { logger }: { logger?: Logger | undefined } = {},\n  ): BetaMessageStream<ParsedT> {\n    const runner = new BetaMessageStream<ParsedT>(params as MessageCreateParamsStreaming, { logger });\n    for (const message of params.messages) {\n      runner._addMessageParam(message);\n    }\n    runner.#params = { ...params, stream: true };\n    runner._run(() =>\n      runner._createMessage(\n        messages,\n        { ...params, stream: true },\n        { ...options, headers: { ...options?.headers, 'X-Stainless-Helper-Method': 'stream' } },\n      ),\n    );\n    return runner;\n  }\n\n  protected _run(executor: () => Promise<any>) {\n    executor().then(() => {\n      this._emitFinal();\n      this._emit('end');\n    }, this.#handleError);\n  }\n\n  protected _addMessageParam(message: BetaMessageParam) {\n    this.messages.push(message);\n  }\n\n  protected _addMessage(message: ParsedBetaMessage<ParsedT>, emit = true) {\n    this.receivedMessages.push(message);\n    if (emit) {\n      this._emit('message', message);\n    }\n  }\n\n  protected async _createMessage(\n    messages: BetaMessages,\n    params: MessageCreateParams,\n    options?: RequestOptions,\n  ): Promise<void> {\n    const signal = options?.signal;\n    let abortHandler: (() => void) | undefined;\n    if (signal) {\n      if (signal.aborted) this.controller.abort();\n      abortHandler = this.controller.abort.bind(this.controller);\n      signal.addEventListener('abort', abortHandler);\n    }\n    try {\n      this.#beginRequest();\n      const { response, data: stream } = await messages\n        .create({ ...params, stream: true }, { ...options, signal: this.controller.signal })\n        .withResponse();\n      this._connected(response);\n      for await (const event of stream) {\n        this.#addStreamEvent(event);\n      }\n      if (stream.controller.signal?.aborted) {\n        throw new APIUserAbortError();\n      }\n      this.#endRequest();\n    } finally {\n      if (signal && abortHandler) {\n        signal.removeEventListener('abort', abortHandler);\n      }\n    }\n  }\n\n  protected _connected(response: Response | null) {\n    if (this.ended) return;\n    this.#response = response;\n    this.#request_id = response?.headers.get('request-id');\n    this.#resolveConnectedPromise(response);\n    this._emit('connect');\n  }\n\n  get ended(): boolean {\n    return this.#ended;\n  }\n\n  get errored(): boolean {\n    return this.#errored;\n  }\n\n  get aborted(): boolean {\n    return this.#aborted;\n  }\n\n  abort() {\n    this.controller.abort();\n  }\n\n  /**\n   * Adds the listener function to the end of the listeners array for the event.\n   * No checks are made to see if the listener has already been added. Multiple calls passing\n   * the same combination of event and listener will result in the listener being added, and\n   * called, multiple times.\n   * @returns this MessageStream, so that calls can be chained\n   */\n  on<Event extends keyof MessageStreamEvents>(event: Event, listener: MessageStreamEvents[Event]): this {\n    const listeners: MessageStreamEventListeners<Event> =\n      this.#listeners[event] || (this.#listeners[event] = []);\n    listeners.push({ listener });\n    return this;\n  }\n\n  /**\n   * Removes the specified listener from the listener array for the event.\n   * off() will remove, at most, one instance of a listener from the listener array. If any single\n   * listener has been added multiple times to the listener array for the specified event, then\n   * off() must be called multiple times to remove each instance.\n   * @returns this MessageStream, so that calls can be chained\n   */\n  off<Event extends keyof MessageStreamEvents>(event: Event, listener: MessageStreamEvents[Event]): this {\n    const listeners = this.#listeners[event];\n    if (!listeners) return this;\n    const index = listeners.findIndex((l) => l.listener === listener);\n    if (index >= 0) listeners.splice(index, 1);\n    return this;\n  }\n\n  /**\n   * Adds a one-time listener function for the event. The next time the event is triggered,\n   * this listener is removed and then invoked.\n   * @returns this MessageStream, so that calls can be chained\n   */\n  once<Event extends keyof MessageStreamEvents>(event: Event, listener: MessageStreamEvents[Event]): this {\n    const listeners: MessageStreamEventListeners<Event> =\n      this.#listeners[event] || (this.#listeners[event] = []);\n    listeners.push({ listener, once: true });\n    return this;\n  }\n\n  /**\n   * This is similar to `.once()`, but returns a Promise that resolves the next time\n   * the event is triggered, instead of calling a listener callback.\n   * @returns a Promise that resolves the next time given event is triggered,\n   * or rejects if an error is emitted.  (If you request the 'error' event,\n   * returns a promise that resolves with the error).\n   *\n   * Example:\n   *\n   *   const message = await stream.emitted('message') // rejects if the stream errors\n   */\n  emitted<Event extends keyof MessageStreamEvents>(\n    event: Event,\n  ): Promise<\n    Parameters<MessageStreamEvents[Event]> extends [infer Param] ? Param\n    : Parameters<MessageStreamEvents[Event]> extends [] ? void\n    : Parameters<MessageStreamEvents[Event]>\n  > {\n    return new Promise((resolve, reject) => {\n      this.#catchingPromiseCreated = true;\n      if (event !== 'error') this.once('error', reject);\n      this.once(event, resolve as any);\n    });\n  }\n\n  async done(): Promise<void> {\n    this.#catchingPromiseCreated = true;\n    await this.#endPromise;\n  }\n\n  get currentMessage(): BetaMessage | undefined {\n    return this.#currentMessageSnapshot;\n  }\n\n  #getFinalMessage(): ParsedBetaMessage<ParsedT> {\n    if (this.receivedMessages.length === 0) {\n      throw new AnthropicError('stream ended without producing a Message with role=assistant');\n    }\n    return this.receivedMessages.at(-1)!;\n  }\n\n  /**\n   * @returns a promise that resolves with the the final assistant Message response,\n   * or rejects if an error occurred or the stream ended prematurely without producing a Message.\n   * If structured outputs were used, this will be a ParsedMessage with a `parsed` field.\n   */\n  async finalMessage(): Promise<ParsedBetaMessage<ParsedT>> {\n    await this.done();\n    return this.#getFinalMessage();\n  }\n\n  #getFinalText(): string {\n    if (this.receivedMessages.length === 0) {\n      throw new AnthropicError('stream ended without producing a Message with role=assistant');\n    }\n    const textBlocks = this.receivedMessages\n      .at(-1)!\n      .content.filter((block): block is BetaTextBlock => block.type === 'text')\n      .map((block) => block.text);\n    if (textBlocks.length === 0) {\n      throw new AnthropicError('stream ended without producing a content block with type=text');\n    }\n    return textBlocks.join(' ');\n  }\n\n  /**\n   * @returns a promise that resolves with the the final assistant Message's text response, concatenated\n   * together if there are more than one text blocks.\n   * Rejects if an error occurred or the stream ended prematurely without producing a Message.\n   */\n  async finalText(): Promise<string> {\n    await this.done();\n    return this.#getFinalText();\n  }\n\n  #handleError = (error: unknown) => {\n    this.#errored = true;\n    if (isAbortError(error)) {\n      error = new APIUserAbortError();\n    }\n    if (error instanceof APIUserAbortError) {\n      this.#aborted = true;\n      return this._emit('abort', error);\n    }\n    if (error instanceof AnthropicError) {\n      return this._emit('error', error);\n    }\n    if (error instanceof Error) {\n      const anthropicError: AnthropicError = new AnthropicError(error.message);\n      // @ts-ignore\n      anthropicError.cause = error;\n      return this._emit('error', anthropicError);\n    }\n    return this._emit('error', new AnthropicError(String(error)));\n  };\n\n  protected _emit<Event extends keyof MessageStreamEvents>(\n    event: Event,\n    ...args: Parameters<MessageStreamEvents[Event]>\n  ) {\n    // make sure we don't emit any MessageStreamEvents after end\n    if (this.#ended) return;\n\n    if (event === 'end') {\n      this.#ended = true;\n      this.#resolveEndPromise();\n    }\n\n    const listeners: MessageStreamEventListeners<Event> | undefined = this.#listeners[event];\n    if (listeners) {\n      this.#listeners[event] = listeners.filter((l) => !l.once) as any;\n      listeners.forEach(({ listener }: any) => listener(...args));\n    }\n\n    if (event === 'abort') {\n      const error = args[0] as APIUserAbortError;\n      if (!this.#catchingPromiseCreated && !listeners?.length) {\n        Promise.reject(error);\n      }\n      this.#rejectConnectedPromise(error);\n      this.#rejectEndPromise(error);\n      this._emit('end');\n      return;\n    }\n\n    if (event === 'error') {\n      // NOTE: _emit('error', error) should only be called from #handleError().\n\n      const error = args[0] as AnthropicError;\n      if (!this.#catchingPromiseCreated && !listeners?.length) {\n        // Trigger an unhandled rejection if the user hasn't registered any error handlers.\n        // If you are seeing stack traces here, make sure to handle errors via either:\n        // - runner.on('error', () => ...)\n        // - await runner.done()\n        // - await runner.final...()\n        // - etc.\n        Promise.reject(error);\n      }\n      this.#rejectConnectedPromise(error);\n      this.#rejectEndPromise(error);\n      this._emit('end');\n    }\n  }\n\n  protected _emitFinal() {\n    const finalMessage = this.receivedMessages.at(-1);\n    if (finalMessage) {\n      this._emit('finalMessage', this.#getFinalMessage());\n    }\n  }\n\n  #beginRequest() {\n    if (this.ended) return;\n    this.#currentMessageSnapshot = undefined;\n  }\n  #addStreamEvent(event: BetaMessageStreamEvent) {\n    if (this.ended) return;\n    const messageSnapshot = this.#accumulateMessage(event);\n    this._emit('streamEvent', event, messageSnapshot);\n\n    switch (event.type) {\n      case 'content_block_delta': {\n        const content = messageSnapshot.content.at(-1)!;\n        switch (event.delta.type) {\n          case 'text_delta': {\n            if (content.type === 'text') {\n              this._emit('text', event.delta.text, content.text || '');\n            }\n            break;\n          }\n          case 'citations_delta': {\n            if (content.type === 'text') {\n              this._emit('citation', event.delta.citation, content.citations ?? []);\n            }\n            break;\n          }\n          case 'input_json_delta': {\n            if (tracksToolInput(content) && content.input) {\n              this._emit('inputJson', event.delta.partial_json, content.input);\n            }\n            break;\n          }\n          case 'thinking_delta': {\n            if (content.type === 'thinking') {\n              this._emit('thinking', event.delta.thinking, content.thinking);\n            }\n            break;\n          }\n          case 'signature_delta': {\n            if (content.type === 'thinking') {\n              this._emit('signature', content.signature);\n            }\n            break;\n          }\n          default:\n            checkNever(event.delta);\n        }\n        break;\n      }\n      case 'message_stop': {\n        this._addMessageParam(messageSnapshot);\n        this._addMessage(\n          maybeParseBetaMessage(messageSnapshot, this.#params, { logger: this.#logger }),\n          true,\n        );\n        break;\n      }\n      case 'content_block_stop': {\n        this._emit('contentBlock', messageSnapshot.content.at(-1)!);\n        break;\n      }\n      case 'message_start': {\n        this.#currentMessageSnapshot = messageSnapshot;\n        break;\n      }\n      case 'content_block_start':\n      case 'message_delta':\n        break;\n    }\n  }\n  #endRequest(): ParsedBetaMessage<ParsedT> {\n    if (this.ended) {\n      throw new AnthropicError(`stream has ended, this shouldn't happen`);\n    }\n    const snapshot = this.#currentMessageSnapshot;\n    if (!snapshot) {\n      throw new AnthropicError(`request ended without sending any chunks`);\n    }\n    this.#currentMessageSnapshot = undefined;\n    return maybeParseBetaMessage(snapshot, this.#params, { logger: this.#logger });\n  }\n\n  protected async _fromReadableStream(\n    readableStream: ReadableStream,\n    options?: RequestOptions,\n  ): Promise<void> {\n    const signal = options?.signal;\n    let abortHandler: (() => void) | undefined;\n    if (signal) {\n      if (signal.aborted) this.controller.abort();\n      abortHandler = this.controller.abort.bind(this.controller);\n      signal.addEventListener('abort', abortHandler);\n    }\n    try {\n      this.#beginRequest();\n      this._connected(null);\n      const stream = Stream.fromReadableStream<BetaMessageStreamEvent>(readableStream, this.controller);\n      for await (const event of stream) {\n        this.#addStreamEvent(event);\n      }\n      if (stream.controller.signal?.aborted) {\n        throw new APIUserAbortError();\n      }\n      this.#endRequest();\n    } finally {\n      if (signal && abortHandler) {\n        signal.removeEventListener('abort', abortHandler);\n      }\n    }\n  }\n\n  /**\n   * Mutates this.#currentMessage with the current event. Handling the accumulation of multiple messages\n   * will be needed to be handled by the caller, this method will throw if you try to accumulate for multiple\n   * messages.\n   */\n  #accumulateMessage(event: BetaMessageStreamEvent): BetaMessage {\n    let snapshot = this.#currentMessageSnapshot;\n\n    if (event.type === 'message_start') {\n      if (snapshot) {\n        throw new AnthropicError(`Unexpected event order, got ${event.type} before receiving \"message_stop\"`);\n      }\n      return event.message;\n    }\n\n    if (!snapshot) {\n      throw new AnthropicError(`Unexpected event order, got ${event.type} before \"message_start\"`);\n    }\n\n    switch (event.type) {\n      case 'message_stop':\n        return snapshot;\n      case 'message_delta':\n        snapshot.container = event.delta.container;\n        snapshot.stop_reason = event.delta.stop_reason;\n        snapshot.stop_sequence = event.delta.stop_sequence;\n        snapshot.usage.output_tokens = event.usage.output_tokens;\n        snapshot.context_management = event.context_management;\n\n        if (event.usage.input_tokens != null) {\n          snapshot.usage.input_tokens = event.usage.input_tokens;\n        }\n\n        if (event.usage.cache_creation_input_tokens != null) {\n          snapshot.usage.cache_creation_input_tokens = event.usage.cache_creation_input_tokens;\n        }\n\n        if (event.usage.cache_read_input_tokens != null) {\n          snapshot.usage.cache_read_input_tokens = event.usage.cache_read_input_tokens;\n        }\n\n        if (event.usage.server_tool_use != null) {\n          snapshot.usage.server_tool_use = event.usage.server_tool_use;\n        }\n\n        return snapshot;\n      case 'content_block_start':\n        snapshot.content.push(event.content_block);\n        return snapshot;\n      case 'content_block_delta': {\n        const snapshotContent = snapshot.content.at(event.index);\n\n        switch (event.delta.type) {\n          case 'text_delta': {\n            if (snapshotContent?.type === 'text') {\n              snapshot.content[event.index] = {\n                ...snapshotContent,\n                text: (snapshotContent.text || '') + event.delta.text,\n              };\n            }\n            break;\n          }\n          case 'citations_delta': {\n            if (snapshotContent?.type === 'text') {\n              snapshot.content[event.index] = {\n                ...snapshotContent,\n                citations: [...(snapshotContent.citations ?? []), event.delta.citation],\n              };\n            }\n            break;\n          }\n          case 'input_json_delta': {\n            if (snapshotContent && tracksToolInput(snapshotContent)) {\n              // we need to keep track of the raw JSON string as well so that we can\n              // re-parse it for each delta, for now we just store it as an untyped\n              // non-enumerable property on the snapshot\n              let jsonBuf = (snapshotContent as any)[JSON_BUF_PROPERTY] || '';\n              jsonBuf += event.delta.partial_json;\n\n              const newContent = { ...snapshotContent };\n              Object.defineProperty(newContent, JSON_BUF_PROPERTY, {\n                value: jsonBuf,\n                enumerable: false,\n                writable: true,\n              });\n\n              if (jsonBuf) {\n                try {\n                  newContent.input = partialParse(jsonBuf);\n                } catch (err) {\n                  const error = new AnthropicError(\n                    `Unable to parse tool parameter JSON from model. Please retry your request or adjust your prompt. Error: ${err}. JSON: ${jsonBuf}`,\n                  );\n                  this.#handleError(error);\n                }\n              }\n              snapshot.content[event.index] = newContent;\n            }\n            break;\n          }\n          case 'thinking_delta': {\n            if (snapshotContent?.type === 'thinking') {\n              snapshot.content[event.index] = {\n                ...snapshotContent,\n                thinking: snapshotContent.thinking + event.delta.thinking,\n              };\n            }\n            break;\n          }\n          case 'signature_delta': {\n            if (snapshotContent?.type === 'thinking') {\n              snapshot.content[event.index] = {\n                ...snapshotContent,\n                signature: event.delta.signature,\n              };\n            }\n            break;\n          }\n          default:\n            checkNever(event.delta);\n        }\n        return snapshot;\n      }\n      case 'content_block_stop':\n        return snapshot;\n    }\n  }\n\n  [Symbol.asyncIterator](): AsyncIterator<BetaMessageStreamEvent> {\n    const pushQueue: BetaMessageStreamEvent[] = [];\n    const readQueue: {\n      resolve: (chunk: BetaMessageStreamEvent | undefined) => void;\n      reject: (error: unknown) => void;\n    }[] = [];\n    let done = false;\n\n    this.on('streamEvent', (event) => {\n      const reader = readQueue.shift();\n      if (reader) {\n        reader.resolve(event);\n      } else {\n        pushQueue.push(event);\n      }\n    });\n\n    this.on('end', () => {\n      done = true;\n      for (const reader of readQueue) {\n        reader.resolve(undefined);\n      }\n      readQueue.length = 0;\n    });\n\n    this.on('abort', (err) => {\n      done = true;\n      for (const reader of readQueue) {\n        reader.reject(err);\n      }\n      readQueue.length = 0;\n    });\n\n    this.on('error', (err) => {\n      done = true;\n      for (const reader of readQueue) {\n        reader.reject(err);\n      }\n      readQueue.length = 0;\n    });\n\n    return {\n      next: async (): Promise<IteratorResult<BetaMessageStreamEvent>> => {\n        if (!pushQueue.length) {\n          if (done) {\n            return { value: undefined, done: true };\n          }\n          return new Promise<BetaMessageStreamEvent | undefined>((resolve, reject) =>\n            readQueue.push({ resolve, reject }),\n          ).then((chunk) => (chunk ? { value: chunk, done: false } : { value: undefined, done: true }));\n        }\n        const chunk = pushQueue.shift()!;\n        return { value: chunk, done: false };\n      },\n      return: async () => {\n        this.abort();\n        return { value: undefined, done: true };\n      },\n    };\n  }\n\n  toReadableStream(): ReadableStream {\n    const stream = new Stream(this[Symbol.asyncIterator].bind(this), this.controller);\n    return stream.toReadableStream();\n  }\n}\n\n// used to ensure exhaustive case matching without throwing a runtime error\nfunction checkNever(x: never) {}\n", "import { Model } from '../../resources';\n\nexport const DEFAULT_TOKEN_THRESHOLD = 100_000;\n\nexport const DEFAULT_SUMMARY_PROMPT = `You have been working on the task described above but have not yet completed it. Write a continuation summary that will allow you (or another instance of yourself) to resume work efficiently in a future context window where the conversation history will be replaced with this summary. Your summary should be structured, concise, and actionable. Include:\n1. Task Overview\nThe user's core request and success criteria\nAny clarifications or constraints they specified\n2. Current State\nWhat has been completed so far\nFiles created, modified, or analyzed (with paths if relevant)\nKey outputs or artifacts produced\n3. Important Discoveries\nTechnical constraints or requirements uncovered\nDecisions made and their rationale\nErrors encountered and how they were resolved\nWhat approaches were tried that didn't work (and why)\n4. Next Steps\nSpecific actions needed to complete the task\nAny blockers or open questions to resolve\nPriority order if multiple steps remain\n5. Context to Preserve\nUser preferences or style requirements\nDomain-specific details that aren't obvious\nAny promises made to the user\nBe concise but complete\u2014err on the side of including information that would prevent duplicate work or repeated mistakes. Write in a way that enables immediate resumption of the task.\nWrap your summary in <summary></summary> tags.`;\n\nexport interface CompactionControl {\n  /**\n   * The context token threshold at which to trigger compaction.\n   *\n   * When the cumulative token count (input + output) across all messages exceeds this threshold,\n   * the message history will be automatically summarized and compressed.\n   *\n   * @default 100000\n   */\n  contextTokenThreshold?: number;\n\n  /**\n   * The model to use for generating the compaction summary.\n   * If not specified, defaults to the same model used for the tool runner.\n   */\n  model?: Model;\n\n  /**\n   * The prompt used to instruct the model on how to generate the summary.\n   */\n  summaryPrompt?: string;\n\n  enabled: boolean;\n}\n", "import { BetaRunnableTool } from './BetaRunnableTool';\nimport { Anthropic } from '../..';\nimport { AnthropicError } from '../../core/error';\nimport { BetaMessage, BetaMessageParam, BetaToolUnion, MessageCreateParams } from '../../resources/beta';\nimport { BetaMessageStream } from '../BetaMessageStream';\nimport { RequestOptions } from '../../internal/request-options';\nimport { buildHeaders } from '../../internal/headers';\nimport { CompactionControl, DEFAULT_SUMMARY_PROMPT, DEFAULT_TOKEN_THRESHOLD } from './CompactionControl';\n\n/**\n * Just Promise.withResolvers(), which is not available in all environments.\n */\nfunction promiseWithResolvers<T>(): {\n  promise: Promise<T>;\n  resolve: (value: T) => void;\n  reject: (reason?: any) => void;\n} {\n  let resolve: (value: T) => void;\n  let reject: (reason?: any) => void;\n  const promise = new Promise<T>((res, rej) => {\n    resolve = res;\n    reject = rej;\n  });\n  return { promise, resolve: resolve!, reject: reject! };\n}\n\n/**\n * A ToolRunner handles the automatic conversation loop between the assistant and tools.\n *\n * A ToolRunner is an async iterable that yields either BetaMessage or BetaMessageStream objects\n * depending on the streaming configuration.\n */\nexport class BetaToolRunner<Stream extends boolean> {\n  /** Whether the async iterator has been consumed */\n  #consumed = false;\n  /** Whether parameters have been mutated since the last API call */\n  #mutated = false;\n  /** Current state containing the request parameters */\n  #state: { params: BetaToolRunnerParams };\n  #options: BetaToolRunnerRequestOptions;\n  /** Promise for the last message received from the assistant */\n  #message?: Promise<BetaMessage> | undefined;\n  /** Cached tool response to avoid redundant executions */\n  #toolResponse?: Promise<BetaMessageParam | null> | undefined;\n  /** Promise resolvers for waiting on completion */\n  #completion: {\n    promise: Promise<BetaMessage>;\n    resolve: (value: BetaMessage) => void;\n    reject: (reason?: any) => void;\n  };\n  /** Number of iterations (API requests) made so far */\n  #iterationCount = 0;\n\n  constructor(\n    private client: Anthropic,\n    params: BetaToolRunnerParams,\n    options?: BetaToolRunnerRequestOptions,\n  ) {\n    this.#state = {\n      params: {\n        // You can't clone the entire params since there are functions as handlers.\n        // You also don't really need to clone params.messages, but it probably will prevent a foot gun\n        // somewhere.\n        ...params,\n        messages: structuredClone(params.messages),\n      },\n    };\n\n    this.#options = {\n      ...options,\n      headers: buildHeaders([{ 'x-stainless-helper': 'BetaToolRunner' }, options?.headers]),\n    };\n    this.#completion = promiseWithResolvers();\n  }\n\n  async #checkAndCompact(): Promise<boolean> {\n    const compactionControl = this.#state.params.compactionControl;\n    if (!compactionControl || !compactionControl.enabled) {\n      return false;\n    }\n\n    let tokensUsed = 0;\n    if (this.#message !== undefined) {\n      try {\n        const message = await this.#message;\n        const totalInputTokens =\n          message.usage.input_tokens +\n          (message.usage.cache_creation_input_tokens ?? 0) +\n          (message.usage.cache_read_input_tokens ?? 0);\n        tokensUsed = totalInputTokens + message.usage.output_tokens;\n      } catch {\n        // If we can't get the message, skip compaction\n        return false;\n      }\n    }\n\n    const threshold = compactionControl.contextTokenThreshold ?? DEFAULT_TOKEN_THRESHOLD;\n\n    if (tokensUsed < threshold) {\n      return false;\n    }\n\n    const model = compactionControl.model ?? this.#state.params.model;\n    const summaryPrompt = compactionControl.summaryPrompt ?? DEFAULT_SUMMARY_PROMPT;\n\n    const messages = this.#state.params.messages;\n\n    if (messages[messages.length - 1]!.role === 'assistant') {\n      // Remove tool_use blocks from the last message to avoid 400 error\n      // (tool_use requires tool_result, which we don't have yet)\n      const lastMessage = messages[messages.length - 1]!;\n      if (Array.isArray(lastMessage.content)) {\n        const nonToolBlocks = lastMessage.content.filter((block) => block.type !== 'tool_use');\n\n        if (nonToolBlocks.length === 0) {\n          // If all blocks were tool_use, just remove the message entirely\n          messages.pop();\n        } else {\n          lastMessage.content = nonToolBlocks;\n        }\n      }\n    }\n\n    const response = await this.client.beta.messages.create(\n      {\n        model,\n        messages: [\n          ...messages,\n          {\n            role: 'user',\n            content: [\n              {\n                type: 'text',\n                text: summaryPrompt,\n              },\n            ],\n          },\n        ],\n        max_tokens: this.#state.params.max_tokens,\n      },\n      {\n        headers: { 'x-stainless-helper': 'compaction' },\n      },\n    );\n\n    if (response.content[0]?.type !== 'text') {\n      throw new AnthropicError('Expected text response for compaction');\n    }\n    this.#state.params.messages = [\n      {\n        role: 'user',\n        content: response.content,\n      },\n    ];\n    return true;\n  }\n\n  async *[Symbol.asyncIterator](): AsyncIterator<\n    Stream extends true ? BetaMessageStream\n    : Stream extends false ? BetaMessage\n    : BetaMessage | BetaMessageStream\n  > {\n    if (this.#consumed) {\n      throw new AnthropicError('Cannot iterate over a consumed stream');\n    }\n\n    this.#consumed = true;\n    this.#mutated = true;\n    this.#toolResponse = undefined;\n\n    try {\n      while (true) {\n        let stream;\n        try {\n          if (\n            this.#state.params.max_iterations &&\n            this.#iterationCount >= this.#state.params.max_iterations\n          ) {\n            break;\n          }\n\n          this.#mutated = false;\n          this.#toolResponse = undefined;\n          this.#iterationCount++;\n          this.#message = undefined;\n\n          const { max_iterations, compactionControl, ...params } = this.#state.params;\n\n          if (params.stream) {\n            stream = this.client.beta.messages.stream({ ...params }, this.#options);\n            this.#message = stream.finalMessage();\n            // Make sure that this promise doesn't throw before we get the option to do something about it.\n            // Error will be caught when we call await this.#message ultimately\n            this.#message.catch(() => {});\n            yield stream as any;\n          } else {\n            this.#message = this.client.beta.messages.create({ ...params, stream: false }, this.#options);\n            yield this.#message as any;\n          }\n\n          const isCompacted = await this.#checkAndCompact();\n          if (!isCompacted) {\n            if (!this.#mutated) {\n              const { role, content } = await this.#message;\n              this.#state.params.messages.push({ role, content });\n            }\n\n            const toolMessage = await this.#generateToolResponse(this.#state.params.messages.at(-1)!);\n            if (toolMessage) {\n              this.#state.params.messages.push(toolMessage);\n            } else if (!this.#mutated) {\n              break;\n            }\n          }\n        } finally {\n          if (stream) {\n            stream.abort();\n          }\n        }\n      }\n\n      if (!this.#message) {\n        throw new AnthropicError('ToolRunner concluded without a message from the server');\n      }\n\n      this.#completion.resolve(await this.#message);\n    } catch (error) {\n      this.#consumed = false;\n      // Silence unhandled promise errors\n      this.#completion.promise.catch(() => {});\n      this.#completion.reject(error);\n      this.#completion = promiseWithResolvers();\n      throw error;\n    }\n  }\n\n  /**\n   * Update the parameters for the next API call. This invalidates any cached tool responses.\n   *\n   * @param paramsOrMutator - Either new parameters or a function to mutate existing parameters\n   *\n   * @example\n   * // Direct parameter update\n   * runner.setMessagesParams({\n   *   model: 'claude-3-5-haiku-latest',\n   *   max_tokens: 500,\n   * });\n   *\n   * @example\n   * // Using a mutator function\n   * runner.setMessagesParams((params) => ({\n   *   ...params,\n   *   max_tokens: 100,\n   * }));\n   */\n  setMessagesParams(params: BetaToolRunnerParams): void;\n  setMessagesParams(mutator: (prevParams: BetaToolRunnerParams) => BetaToolRunnerParams): void;\n  setMessagesParams(\n    paramsOrMutator: BetaToolRunnerParams | ((prevParams: BetaToolRunnerParams) => BetaToolRunnerParams),\n  ) {\n    if (typeof paramsOrMutator === 'function') {\n      this.#state.params = paramsOrMutator(this.#state.params);\n    } else {\n      this.#state.params = paramsOrMutator;\n    }\n    this.#mutated = true;\n    // Invalidate cached tool response since parameters changed\n    this.#toolResponse = undefined;\n  }\n\n  /**\n   * Get the tool response for the last message from the assistant.\n   * Avoids redundant tool executions by caching results.\n   *\n   * @returns A promise that resolves to a BetaMessageParam containing tool results, or null if no tools need to be executed\n   *\n   * @example\n   * const toolResponse = await runner.generateToolResponse();\n   * if (toolResponse) {\n   *   console.log('Tool results:', toolResponse.content);\n   * }\n   */\n  async generateToolResponse() {\n    const message = (await this.#message) ?? this.params.messages.at(-1);\n    if (!message) {\n      return null;\n    }\n    return this.#generateToolResponse(message);\n  }\n\n  async #generateToolResponse(lastMessage: BetaMessageParam) {\n    if (this.#toolResponse !== undefined) {\n      return this.#toolResponse;\n    }\n    this.#toolResponse = generateToolResponse(this.#state.params, lastMessage);\n    return this.#toolResponse;\n  }\n\n  /**\n   * Wait for the async iterator to complete. This works even if the async iterator hasn't yet started, and\n   * will wait for an instance to start and go to completion.\n   *\n   * @returns A promise that resolves to the final BetaMessage when the iterator completes\n   *\n   * @example\n   * // Start consuming the iterator\n   * for await (const message of runner) {\n   *   console.log('Message:', message.content);\n   * }\n   *\n   * // Meanwhile, wait for completion from another part of the code\n   * const finalMessage = await runner.done();\n   * console.log('Final response:', finalMessage.content);\n   */\n  done(): Promise<BetaMessage> {\n    return this.#completion.promise;\n  }\n\n  /**\n   * Returns a promise indicating that the stream is done. Unlike .done(), this will eagerly read the stream:\n   * * If the iterator has not been consumed, consume the entire iterator and return the final message from the\n   * assistant.\n   * * If the iterator has been consumed, waits for it to complete and returns the final message.\n   *\n   * @returns A promise that resolves to the final BetaMessage from the conversation\n   * @throws {AnthropicError} If no messages were processed during the conversation\n   *\n   * @example\n   * const finalMessage = await runner.runUntilDone();\n   * console.log('Final response:', finalMessage.content);\n   */\n  async runUntilDone(): Promise<BetaMessage> {\n    // If not yet consumed, start consuming and wait for completion\n    if (!this.#consumed) {\n      for await (const _ of this) {\n        // Iterator naturally populates this.#message\n      }\n    }\n\n    // If consumed but not completed, wait for completion\n    return this.done();\n  }\n\n  /**\n   * Get the current parameters being used by the ToolRunner.\n   *\n   * @returns A readonly view of the current ToolRunnerParams\n   *\n   * @example\n   * const currentParams = runner.params;\n   * console.log('Current model:', currentParams.model);\n   * console.log('Message count:', currentParams.messages.length);\n   */\n  get params(): Readonly<BetaToolRunnerParams> {\n    return this.#state.params as Readonly<BetaToolRunnerParams>;\n  }\n\n  /**\n   * Add one or more messages to the conversation history.\n   *\n   * @param messages - One or more BetaMessageParam objects to add to the conversation\n   *\n   * @example\n   * runner.pushMessages(\n   *   { role: 'user', content: 'Also, what about the weather in NYC?' }\n   * );\n   *\n   * @example\n   * // Adding multiple messages\n   * runner.pushMessages(\n   *   { role: 'user', content: 'What about NYC?' },\n   *   { role: 'user', content: 'And Boston?' }\n   * );\n   */\n  pushMessages(...messages: BetaMessageParam[]) {\n    this.setMessagesParams((params) => ({\n      ...params,\n      messages: [...params.messages, ...messages],\n    }));\n  }\n\n  /**\n   * Makes the ToolRunner directly awaitable, equivalent to calling .runUntilDone()\n   * This allows using `await runner` instead of `await runner.runUntilDone()`\n   */\n  then<TResult1 = BetaMessage, TResult2 = never>(\n    onfulfilled?: ((value: BetaMessage) => TResult1 | PromiseLike<TResult1>) | undefined | null,\n    onrejected?: ((reason: any) => TResult2 | PromiseLike<TResult2>) | undefined | null,\n  ): Promise<TResult1 | TResult2> {\n    return this.runUntilDone().then(onfulfilled, onrejected);\n  }\n}\n\nasync function generateToolResponse(\n  params: BetaToolRunnerParams,\n  lastMessage = params.messages.at(-1),\n): Promise<BetaMessageParam | null> {\n  // Only process if the last message is from the assistant and has tool use blocks\n  if (\n    !lastMessage ||\n    lastMessage.role !== 'assistant' ||\n    !lastMessage.content ||\n    typeof lastMessage.content === 'string'\n  ) {\n    return null;\n  }\n\n  const toolUseBlocks = lastMessage.content.filter((content) => content.type === 'tool_use');\n  if (toolUseBlocks.length === 0) {\n    return null;\n  }\n\n  const toolResults = await Promise.all(\n    toolUseBlocks.map(async (toolUse) => {\n      const tool = params.tools.find((t) => ('name' in t ? t.name : t.mcp_server_name) === toolUse.name);\n      if (!tool || !('run' in tool)) {\n        return {\n          type: 'tool_result' as const,\n          tool_use_id: toolUse.id,\n          content: `Error: Tool '${toolUse.name}' not found`,\n          is_error: true,\n        };\n      }\n\n      try {\n        let input = toolUse.input;\n        if ('parse' in tool && tool.parse) {\n          input = tool.parse(input);\n        }\n\n        const result = await tool.run(input);\n        return {\n          type: 'tool_result' as const,\n          tool_use_id: toolUse.id,\n          content: result,\n        };\n      } catch (error) {\n        return {\n          type: 'tool_result' as const,\n          tool_use_id: toolUse.id,\n          content: `Error: ${error instanceof Error ? error.message : String(error)}`,\n          is_error: true,\n        };\n      }\n    }),\n  );\n\n  return {\n    role: 'user' as const,\n    content: toolResults,\n  };\n}\n\n// vendored from typefest just to make things look a bit nicer on hover\ntype Simplify<T> = { [KeyType in keyof T]: T[KeyType] } & {};\n\n/**\n * Parameters for creating a ToolRunner, extending MessageCreateParams with runnable tools.\n */\nexport type BetaToolRunnerParams = Simplify<\n  Omit<MessageCreateParams, 'tools'> & {\n    tools: (BetaToolUnion | BetaRunnableTool<any>)[];\n    /**\n     * Maximum number of iterations (API requests) to make in the tool execution loop.\n     * Each iteration consists of: assistant response \u2192 tool execution \u2192 tool results.\n     * When exceeded, the loop will terminate even if tools are still being requested.\n     */\n    max_iterations?: number;\n    compactionControl?: CompactionControl;\n  }\n>;\n\nexport type BetaToolRunnerRequestOptions = Pick<RequestOptions, 'headers'>;\n", "import { AnthropicError } from '../../core/error';\nimport { ReadableStreamToAsyncIterable } from '../shims';\nimport { LineDecoder, type Bytes } from './line';\n\nexport class JSONLDecoder<T> {\n  controller: AbortController;\n\n  constructor(\n    private iterator: AsyncIterableIterator<Bytes>,\n    controller: AbortController,\n  ) {\n    this.controller = controller;\n  }\n\n  private async *decoder(): AsyncIterator<T, any, undefined> {\n    const lineDecoder = new LineDecoder();\n    for await (const chunk of this.iterator) {\n      for (const line of lineDecoder.decode(chunk)) {\n        yield JSON.parse(line);\n      }\n    }\n\n    for (const line of lineDecoder.flush()) {\n      yield JSON.parse(line);\n    }\n  }\n\n  [Symbol.asyncIterator](): AsyncIterator<T> {\n    return this.decoder();\n  }\n\n  static fromResponse<T>(response: Response, controller: AbortController): JSONLDecoder<T> {\n    if (!response.body) {\n      controller.abort();\n      if (\n        typeof (globalThis as any).navigator !== 'undefined' &&\n        (globalThis as any).navigator.product === 'ReactNative'\n      ) {\n        throw new AnthropicError(\n          `The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api`,\n        );\n      }\n      throw new AnthropicError(`Attempted to iterate over a response with no body`);\n    }\n\n    return new JSONLDecoder(ReadableStreamToAsyncIterable<Bytes>(response.body), controller);\n  }\n}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { APIResource } from '../../../core/resource';\nimport * as BetaAPI from '../beta';\nimport { APIPromise } from '../../../core/api-promise';\nimport * as BetaMessagesAPI from './messages';\nimport { Page, type PageParams, PagePromise } from '../../../core/pagination';\nimport { buildHeaders } from '../../../internal/headers';\nimport { RequestOptions } from '../../../internal/request-options';\nimport { JSONLDecoder } from '../../../internal/decoders/jsonl';\nimport { AnthropicError } from '../../../error';\nimport { path } from '../../../internal/utils/path';\nimport * as MessagesApi from '../../messages/messages';\n\nexport class Batches extends APIResource {\n  /**\n   * Send a batch of Message creation requests.\n   *\n   * The Message Batches API can be used to process multiple Messages API requests at\n   * once. Once a Message Batch is created, it begins processing immediately. Batches\n   * can take up to 24 hours to complete.\n   *\n   * Learn more about the Message Batches API in our\n   * [user guide](https://docs.claude.com/en/docs/build-with-claude/batch-processing)\n   *\n   * @example\n   * ```ts\n   * const betaMessageBatch =\n   *   await client.beta.messages.batches.create({\n   *     requests: [\n   *       {\n   *         custom_id: 'my-custom-id-1',\n   *         params: {\n   *           max_tokens: 1024,\n   *           messages: [\n   *             { content: 'Hello, world', role: 'user' },\n   *           ],\n   *           model: 'claude-sonnet-4-5-20250929',\n   *         },\n   *       },\n   *     ],\n   *   });\n   * ```\n   */\n  create(params: BatchCreateParams, options?: RequestOptions): APIPromise<BetaMessageBatch> {\n    const { betas, ...body } = params;\n    return this._client.post('/v1/messages/batches?beta=true', {\n      body,\n      ...options,\n      headers: buildHeaders([\n        { 'anthropic-beta': [...(betas ?? []), 'message-batches-2024-09-24'].toString() },\n        options?.headers,\n      ]),\n    });\n  }\n\n  /**\n   * This endpoint is idempotent and can be used to poll for Message Batch\n   * completion. To access the results of a Message Batch, make a request to the\n   * `results_url` field in the response.\n   *\n   * Learn more about the Message Batches API in our\n   * [user guide](https://docs.claude.com/en/docs/build-with-claude/batch-processing)\n   *\n   * @example\n   * ```ts\n   * const betaMessageBatch =\n   *   await client.beta.messages.batches.retrieve(\n   *     'message_batch_id',\n   *   );\n   * ```\n   */\n  retrieve(\n    messageBatchID: string,\n    params: BatchRetrieveParams | null | undefined = {},\n    options?: RequestOptions,\n  ): APIPromise<BetaMessageBatch> {\n    const { betas } = params ?? {};\n    return this._client.get(path`/v1/messages/batches/${messageBatchID}?beta=true`, {\n      ...options,\n      headers: buildHeaders([\n        { 'anthropic-beta': [...(betas ?? []), 'message-batches-2024-09-24'].toString() },\n        options?.headers,\n      ]),\n    });\n  }\n\n  /**\n   * List all Message Batches within a Workspace. Most recently created batches are\n   * returned first.\n   *\n   * Learn more about the Message Batches API in our\n   * [user guide](https://docs.claude.com/en/docs/build-with-claude/batch-processing)\n   *\n   * @example\n   * ```ts\n   * // Automatically fetches more pages as needed.\n   * for await (const betaMessageBatch of client.beta.messages.batches.list()) {\n   *   // ...\n   * }\n   * ```\n   */\n  list(\n    params: BatchListParams | null | undefined = {},\n    options?: RequestOptions,\n  ): PagePromise<BetaMessageBatchesPage, BetaMessageBatch> {\n    const { betas, ...query } = params ?? {};\n    return this._client.getAPIList('/v1/messages/batches?beta=true', Page<BetaMessageBatch>, {\n      query,\n      ...options,\n      headers: buildHeaders([\n        { 'anthropic-beta': [...(betas ?? []), 'message-batches-2024-09-24'].toString() },\n        options?.headers,\n      ]),\n    });\n  }\n\n  /**\n   * Delete a Message Batch.\n   *\n   * Message Batches can only be deleted once they've finished processing. If you'd\n   * like to delete an in-progress batch, you must first cancel it.\n   *\n   * Learn more about the Message Batches API in our\n   * [user guide](https://docs.claude.com/en/docs/build-with-claude/batch-processing)\n   *\n   * @example\n   * ```ts\n   * const betaDeletedMessageBatch =\n   *   await client.beta.messages.batches.delete(\n   *     'message_batch_id',\n   *   );\n   * ```\n   */\n  delete(\n    messageBatchID: string,\n    params: BatchDeleteParams | null | undefined = {},\n    options?: RequestOptions,\n  ): APIPromise<BetaDeletedMessageBatch> {\n    const { betas } = params ?? {};\n    return this._client.delete(path`/v1/messages/batches/${messageBatchID}?beta=true`, {\n      ...options,\n      headers: buildHeaders([\n        { 'anthropic-beta': [...(betas ?? []), 'message-batches-2024-09-24'].toString() },\n        options?.headers,\n      ]),\n    });\n  }\n\n  /**\n   * Batches may be canceled any time before processing ends. Once cancellation is\n   * initiated, the batch enters a `canceling` state, at which time the system may\n   * complete any in-progress, non-interruptible requests before finalizing\n   * cancellation.\n   *\n   * The number of canceled requests is specified in `request_counts`. To determine\n   * which requests were canceled, check the individual results within the batch.\n   * Note that cancellation may not result in any canceled requests if they were\n   * non-interruptible.\n   *\n   * Learn more about the Message Batches API in our\n   * [user guide](https://docs.claude.com/en/docs/build-with-claude/batch-processing)\n   *\n   * @example\n   * ```ts\n   * const betaMessageBatch =\n   *   await client.beta.messages.batches.cancel(\n   *     'message_batch_id',\n   *   );\n   * ```\n   */\n  cancel(\n    messageBatchID: string,\n    params: BatchCancelParams | null | undefined = {},\n    options?: RequestOptions,\n  ): APIPromise<BetaMessageBatch> {\n    const { betas } = params ?? {};\n    return this._client.post(path`/v1/messages/batches/${messageBatchID}/cancel?beta=true`, {\n      ...options,\n      headers: buildHeaders([\n        { 'anthropic-beta': [...(betas ?? []), 'message-batches-2024-09-24'].toString() },\n        options?.headers,\n      ]),\n    });\n  }\n\n  /**\n   * Streams the results of a Message Batch as a `.jsonl` file.\n   *\n   * Each line in the file is a JSON object containing the result of a single request\n   * in the Message Batch. Results are not guaranteed to be in the same order as\n   * requests. Use the `custom_id` field to match results to requests.\n   *\n   * Learn more about the Message Batches API in our\n   * [user guide](https://docs.claude.com/en/docs/build-with-claude/batch-processing)\n   *\n   * @example\n   * ```ts\n   * const betaMessageBatchIndividualResponse =\n   *   await client.beta.messages.batches.results(\n   *     'message_batch_id',\n   *   );\n   * ```\n   */\n  async results(\n    messageBatchID: string,\n    params: BatchResultsParams | undefined = {},\n    options?: RequestOptions,\n  ): Promise<JSONLDecoder<BetaMessageBatchIndividualResponse>> {\n    const batch = await this.retrieve(messageBatchID);\n    if (!batch.results_url) {\n      throw new AnthropicError(\n        `No batch \\`results_url\\`; Has it finished processing? ${batch.processing_status} - ${batch.id}`,\n      );\n    }\n\n    const { betas } = params ?? {};\n    return this._client\n      .get(batch.results_url, {\n        ...options,\n        headers: buildHeaders([\n          {\n            'anthropic-beta': [...(betas ?? []), 'message-batches-2024-09-24'].toString(),\n            Accept: 'application/binary',\n          },\n          options?.headers,\n        ]),\n        stream: true,\n        __binaryResponse: true,\n      })\n      ._thenUnwrap((_, props) => JSONLDecoder.fromResponse(props.response, props.controller)) as APIPromise<\n      JSONLDecoder<BetaMessageBatchIndividualResponse>\n    >;\n  }\n}\n\nexport type BetaMessageBatchesPage = Page<BetaMessageBatch>;\n\nexport interface BetaDeletedMessageBatch {\n  /**\n   * ID of the Message Batch.\n   */\n  id: string;\n\n  /**\n   * Deleted object type.\n   *\n   * For Message Batches, this is always `\"message_batch_deleted\"`.\n   */\n  type: 'message_batch_deleted';\n}\n\nexport interface BetaMessageBatch {\n  /**\n   * Unique object identifier.\n   *\n   * The format and length of IDs may change over time.\n   */\n  id: string;\n\n  /**\n   * RFC 3339 datetime string representing the time at which the Message Batch was\n   * archived and its results became unavailable.\n   */\n  archived_at: string | null;\n\n  /**\n   * RFC 3339 datetime string representing the time at which cancellation was\n   * initiated for the Message Batch. Specified only if cancellation was initiated.\n   */\n  cancel_initiated_at: string | null;\n\n  /**\n   * RFC 3339 datetime string representing the time at which the Message Batch was\n   * created.\n   */\n  created_at: string;\n\n  /**\n   * RFC 3339 datetime string representing the time at which processing for the\n   * Message Batch ended. Specified only once processing ends.\n   *\n   * Processing ends when every request in a Message Batch has either succeeded,\n   * errored, canceled, or expired.\n   */\n  ended_at: string | null;\n\n  /**\n   * RFC 3339 datetime string representing the time at which the Message Batch will\n   * expire and end processing, which is 24 hours after creation.\n   */\n  expires_at: string;\n\n  /**\n   * Processing status of the Message Batch.\n   */\n  processing_status: 'in_progress' | 'canceling' | 'ended';\n\n  /**\n   * Tallies requests within the Message Batch, categorized by their status.\n   *\n   * Requests start as `processing` and move to one of the other statuses only once\n   * processing of the entire batch ends. The sum of all values always matches the\n   * total number of requests in the batch.\n   */\n  request_counts: BetaMessageBatchRequestCounts;\n\n  /**\n   * URL to a `.jsonl` file containing the results of the Message Batch requests.\n   * Specified only once processing ends.\n   *\n   * Results in the file are not guaranteed to be in the same order as requests. Use\n   * the `custom_id` field to match results to requests.\n   */\n  results_url: string | null;\n\n  /**\n   * Object type.\n   *\n   * For Message Batches, this is always `\"message_batch\"`.\n   */\n  type: 'message_batch';\n}\n\nexport interface BetaMessageBatchCanceledResult {\n  type: 'canceled';\n}\n\nexport interface BetaMessageBatchErroredResult {\n  error: BetaAPI.BetaErrorResponse;\n\n  type: 'errored';\n}\n\nexport interface BetaMessageBatchExpiredResult {\n  type: 'expired';\n}\n\n/**\n * This is a single line in the response `.jsonl` file and does not represent the\n * response as a whole.\n */\nexport interface BetaMessageBatchIndividualResponse {\n  /**\n   * Developer-provided ID created for each request in a Message Batch. Useful for\n   * matching results to requests, as results may be given out of request order.\n   *\n   * Must be unique for each request within the Message Batch.\n   */\n  custom_id: string;\n\n  /**\n   * Processing result for this request.\n   *\n   * Contains a Message output if processing was successful, an error response if\n   * processing failed, or the reason why processing was not attempted, such as\n   * cancellation or expiration.\n   */\n  result: BetaMessageBatchResult;\n}\n\nexport interface BetaMessageBatchRequestCounts {\n  /**\n   * Number of requests in the Message Batch that have been canceled.\n   *\n   * This is zero until processing of the entire Message Batch has ended.\n   */\n  canceled: number;\n\n  /**\n   * Number of requests in the Message Batch that encountered an error.\n   *\n   * This is zero until processing of the entire Message Batch has ended.\n   */\n  errored: number;\n\n  /**\n   * Number of requests in the Message Batch that have expired.\n   *\n   * This is zero until processing of the entire Message Batch has ended.\n   */\n  expired: number;\n\n  /**\n   * Number of requests in the Message Batch that are processing.\n   */\n  processing: number;\n\n  /**\n   * Number of requests in the Message Batch that have completed successfully.\n   *\n   * This is zero until processing of the entire Message Batch has ended.\n   */\n  succeeded: number;\n}\n\n/**\n * Processing result for this request.\n *\n * Contains a Message output if processing was successful, an error response if\n * processing failed, or the reason why processing was not attempted, such as\n * cancellation or expiration.\n */\nexport type BetaMessageBatchResult =\n  | BetaMessageBatchSucceededResult\n  | BetaMessageBatchErroredResult\n  | BetaMessageBatchCanceledResult\n  | BetaMessageBatchExpiredResult;\n\nexport interface BetaMessageBatchSucceededResult {\n  message: BetaMessagesAPI.BetaMessage;\n\n  type: 'succeeded';\n}\n\nexport interface BatchCreateParams {\n  /**\n   * Body param: List of requests for prompt completion. Each is an individual\n   * request to create a Message.\n   */\n  requests: Array<BatchCreateParams.Request>;\n\n  /**\n   * Header param: Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport namespace BatchCreateParams {\n  export interface Request {\n    /**\n     * Developer-provided ID created for each request in a Message Batch. Useful for\n     * matching results to requests, as results may be given out of request order.\n     *\n     * Must be unique for each request within the Message Batch.\n     */\n    custom_id: string;\n\n    /**\n     * Messages API creation parameters for the individual request.\n     *\n     * See the [Messages API reference](https://docs.claude.com/en/api/messages) for\n     * full documentation on available parameters.\n     */\n    params: Request.Params;\n  }\n\n  export namespace Request {\n    /**\n     * Messages API creation parameters for the individual request.\n     *\n     * See the [Messages API reference](https://docs.claude.com/en/api/messages) for\n     * full documentation on available parameters.\n     */\n    export interface Params {\n      /**\n       * The maximum number of tokens to generate before stopping.\n       *\n       * Note that our models may stop _before_ reaching this maximum. This parameter\n       * only specifies the absolute maximum number of tokens to generate.\n       *\n       * Different models have different maximum values for this parameter. See\n       * [models](https://docs.claude.com/en/docs/models-overview) for details.\n       */\n      max_tokens: number;\n\n      /**\n       * Input messages.\n       *\n       * Our models are trained to operate on alternating `user` and `assistant`\n       * conversational turns. When creating a new `Message`, you specify the prior\n       * conversational turns with the `messages` parameter, and the model then generates\n       * the next `Message` in the conversation. Consecutive `user` or `assistant` turns\n       * in your request will be combined into a single turn.\n       *\n       * Each input message must be an object with a `role` and `content`. You can\n       * specify a single `user`-role message, or you can include multiple `user` and\n       * `assistant` messages.\n       *\n       * If the final message uses the `assistant` role, the response content will\n       * continue immediately from the content in that message. This can be used to\n       * constrain part of the model's response.\n       *\n       * Example with a single `user` message:\n       *\n       * ```json\n       * [{ \"role\": \"user\", \"content\": \"Hello, Claude\" }]\n       * ```\n       *\n       * Example with multiple conversational turns:\n       *\n       * ```json\n       * [\n       *   { \"role\": \"user\", \"content\": \"Hello there.\" },\n       *   { \"role\": \"assistant\", \"content\": \"Hi, I'm Claude. How can I help you?\" },\n       *   { \"role\": \"user\", \"content\": \"Can you explain LLMs in plain English?\" }\n       * ]\n       * ```\n       *\n       * Example with a partially-filled response from Claude:\n       *\n       * ```json\n       * [\n       *   {\n       *     \"role\": \"user\",\n       *     \"content\": \"What's the Greek name for Sun? (A) Sol (B) Helios (C) Sun\"\n       *   },\n       *   { \"role\": \"assistant\", \"content\": \"The best answer is (\" }\n       * ]\n       * ```\n       *\n       * Each input message `content` may be either a single `string` or an array of\n       * content blocks, where each block has a specific `type`. Using a `string` for\n       * `content` is shorthand for an array of one content block of type `\"text\"`. The\n       * following input messages are equivalent:\n       *\n       * ```json\n       * { \"role\": \"user\", \"content\": \"Hello, Claude\" }\n       * ```\n       *\n       * ```json\n       * { \"role\": \"user\", \"content\": [{ \"type\": \"text\", \"text\": \"Hello, Claude\" }] }\n       * ```\n       *\n       * See [input examples](https://docs.claude.com/en/api/messages-examples).\n       *\n       * Note that if you want to include a\n       * [system prompt](https://docs.claude.com/en/docs/system-prompts), you can use the\n       * top-level `system` parameter \u2014 there is no `\"system\"` role for input messages in\n       * the Messages API.\n       *\n       * There is a limit of 100,000 messages in a single request.\n       */\n      messages: Array<BetaMessagesAPI.BetaMessageParam>;\n\n      /**\n       * The model that will complete your prompt.\\n\\nSee\n       * [models](https://docs.anthropic.com/en/docs/models-overview) for additional\n       * details and options.\n       */\n      model: MessagesApi.Model;\n\n      /**\n       * Container identifier for reuse across requests.\n       */\n      container?: BetaMessagesAPI.BetaContainerParams | string | null;\n\n      /**\n       * Context management configuration.\n       *\n       * This allows you to control how Claude manages context across multiple requests,\n       * such as whether to clear function results or not.\n       */\n      context_management?: BetaMessagesAPI.BetaContextManagementConfig | null;\n\n      /**\n       * MCP servers to be utilized in this request\n       */\n      mcp_servers?: Array<BetaMessagesAPI.BetaRequestMCPServerURLDefinition>;\n\n      /**\n       * An object describing metadata about the request.\n       */\n      metadata?: BetaMessagesAPI.BetaMetadata;\n\n      /**\n       * Configuration options for the model's output. Controls aspects like how much\n       * effort the model puts into its response.\n       */\n      output_config?: BetaMessagesAPI.BetaOutputConfig;\n\n      /**\n       * A schema to specify Claude's output format in responses.\n       */\n      output_format?: BetaMessagesAPI.BetaJSONOutputFormat | null;\n\n      /**\n       * Determines whether to use priority capacity (if available) or standard capacity\n       * for this request.\n       *\n       * Anthropic offers different levels of service for your API requests. See\n       * [service-tiers](https://docs.claude.com/en/api/service-tiers) for details.\n       */\n      service_tier?: 'auto' | 'standard_only';\n\n      /**\n       * Custom text sequences that will cause the model to stop generating.\n       *\n       * Our models will normally stop when they have naturally completed their turn,\n       * which will result in a response `stop_reason` of `\"end_turn\"`.\n       *\n       * If you want the model to stop generating when it encounters custom strings of\n       * text, you can use the `stop_sequences` parameter. If the model encounters one of\n       * the custom sequences, the response `stop_reason` value will be `\"stop_sequence\"`\n       * and the response `stop_sequence` value will contain the matched stop sequence.\n       */\n      stop_sequences?: Array<string>;\n\n      /**\n       * Whether to incrementally stream the response using server-sent events.\n       *\n       * See [streaming](https://docs.claude.com/en/api/messages-streaming) for details.\n       */\n      stream?: boolean;\n\n      /**\n       * System prompt.\n       *\n       * A system prompt is a way of providing context and instructions to Claude, such\n       * as specifying a particular goal or role. See our\n       * [guide to system prompts](https://docs.claude.com/en/docs/system-prompts).\n       */\n      system?: string | Array<BetaMessagesAPI.BetaTextBlockParam>;\n\n      /**\n       * Amount of randomness injected into the response.\n       *\n       * Defaults to `1.0`. Ranges from `0.0` to `1.0`. Use `temperature` closer to `0.0`\n       * for analytical / multiple choice, and closer to `1.0` for creative and\n       * generative tasks.\n       *\n       * Note that even with `temperature` of `0.0`, the results will not be fully\n       * deterministic.\n       */\n      temperature?: number;\n\n      /**\n       * Configuration for enabling Claude's extended thinking.\n       *\n       * When enabled, responses include `thinking` content blocks showing Claude's\n       * thinking process before the final answer. Requires a minimum budget of 1,024\n       * tokens and counts towards your `max_tokens` limit.\n       *\n       * See\n       * [extended thinking](https://docs.claude.com/en/docs/build-with-claude/extended-thinking)\n       * for details.\n       */\n      thinking?: BetaMessagesAPI.BetaThinkingConfigParam;\n\n      /**\n       * How the model should use the provided tools. The model can use a specific tool,\n       * any available tool, decide by itself, or not use tools at all.\n       */\n      tool_choice?: BetaMessagesAPI.BetaToolChoice;\n\n      /**\n       * Definitions of tools that the model may use.\n       *\n       * If you include `tools` in your API request, the model may return `tool_use`\n       * content blocks that represent the model's use of those tools. You can then run\n       * those tools using the tool input generated by the model and then optionally\n       * return results back to the model using `tool_result` content blocks.\n       *\n       * There are two types of tools: **client tools** and **server tools**. The\n       * behavior described below applies to client tools. For\n       * [server tools](https://docs.claude.com/en/docs/agents-and-tools/tool-use/overview#server-tools),\n       * see their individual documentation as each has its own behavior (e.g., the\n       * [web search tool](https://docs.claude.com/en/docs/agents-and-tools/tool-use/web-search-tool)).\n       *\n       * Each tool definition includes:\n       *\n       * - `name`: Name of the tool.\n       * - `description`: Optional, but strongly-recommended description of the tool.\n       * - `input_schema`: [JSON schema](https://json-schema.org/draft/2020-12) for the\n       *   tool `input` shape that the model will produce in `tool_use` output content\n       *   blocks.\n       *\n       * For example, if you defined `tools` as:\n       *\n       * ```json\n       * [\n       *   {\n       *     \"name\": \"get_stock_price\",\n       *     \"description\": \"Get the current stock price for a given ticker symbol.\",\n       *     \"input_schema\": {\n       *       \"type\": \"object\",\n       *       \"properties\": {\n       *         \"ticker\": {\n       *           \"type\": \"string\",\n       *           \"description\": \"The stock ticker symbol, e.g. AAPL for Apple Inc.\"\n       *         }\n       *       },\n       *       \"required\": [\"ticker\"]\n       *     }\n       *   }\n       * ]\n       * ```\n       *\n       * And then asked the model \"What's the S&P 500 at today?\", the model might produce\n       * `tool_use` content blocks in the response like this:\n       *\n       * ```json\n       * [\n       *   {\n       *     \"type\": \"tool_use\",\n       *     \"id\": \"toolu_01D7FLrfh4GYq7yT1ULFeyMV\",\n       *     \"name\": \"get_stock_price\",\n       *     \"input\": { \"ticker\": \"^GSPC\" }\n       *   }\n       * ]\n       * ```\n       *\n       * You might then run your `get_stock_price` tool with `{\"ticker\": \"^GSPC\"}` as an\n       * input, and return the following back to the model in a subsequent `user`\n       * message:\n       *\n       * ```json\n       * [\n       *   {\n       *     \"type\": \"tool_result\",\n       *     \"tool_use_id\": \"toolu_01D7FLrfh4GYq7yT1ULFeyMV\",\n       *     \"content\": \"259.75 USD\"\n       *   }\n       * ]\n       * ```\n       *\n       * Tools can be used for workflows that include running client-side tools and\n       * functions, or more generally whenever you want the model to produce a particular\n       * JSON structure of output.\n       *\n       * See our [guide](https://docs.claude.com/en/docs/tool-use) for more details.\n       */\n      tools?: Array<BetaMessagesAPI.BetaToolUnion>;\n\n      /**\n       * Only sample from the top K options for each subsequent token.\n       *\n       * Used to remove \"long tail\" low probability responses.\n       * [Learn more technical details here](https://towardsdatascience.com/how-to-sample-from-language-models-682bceb97277).\n       *\n       * Recommended for advanced use cases only. You usually only need to use\n       * `temperature`.\n       */\n      top_k?: number;\n\n      /**\n       * Use nucleus sampling.\n       *\n       * In nucleus sampling, we compute the cumulative distribution over all the options\n       * for each subsequent token in decreasing probability order and cut it off once it\n       * reaches a particular probability specified by `top_p`. You should either alter\n       * `temperature` or `top_p`, but not both.\n       *\n       * Recommended for advanced use cases only. You usually only need to use\n       * `temperature`.\n       */\n      top_p?: number;\n    }\n  }\n}\n\nexport interface BatchRetrieveParams {\n  /**\n   * Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport interface BatchListParams extends PageParams {\n  /**\n   * Header param: Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport interface BatchDeleteParams {\n  /**\n   * Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport interface BatchCancelParams {\n  /**\n   * Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport interface BatchResultsParams {\n  /**\n   * Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport declare namespace Batches {\n  export {\n    type BetaDeletedMessageBatch as BetaDeletedMessageBatch,\n    type BetaMessageBatch as BetaMessageBatch,\n    type BetaMessageBatchCanceledResult as BetaMessageBatchCanceledResult,\n    type BetaMessageBatchErroredResult as BetaMessageBatchErroredResult,\n    type BetaMessageBatchExpiredResult as BetaMessageBatchExpiredResult,\n    type BetaMessageBatchIndividualResponse as BetaMessageBatchIndividualResponse,\n    type BetaMessageBatchRequestCounts as BetaMessageBatchRequestCounts,\n    type BetaMessageBatchResult as BetaMessageBatchResult,\n    type BetaMessageBatchSucceededResult as BetaMessageBatchSucceededResult,\n    type BetaMessageBatchesPage as BetaMessageBatchesPage,\n    type BatchCreateParams as BatchCreateParams,\n    type BatchRetrieveParams as BatchRetrieveParams,\n    type BatchListParams as BatchListParams,\n    type BatchDeleteParams as BatchDeleteParams,\n    type BatchCancelParams as BatchCancelParams,\n    type BatchResultsParams as BatchResultsParams,\n  };\n}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { Anthropic } from '../../../client';\nimport { APIPromise } from '../../../core/api-promise';\nimport { APIResource } from '../../../core/resource';\nimport { Stream } from '../../../core/streaming';\nimport { MODEL_NONSTREAMING_TOKENS } from '../../../internal/constants';\nimport { buildHeaders } from '../../../internal/headers';\nimport { RequestOptions } from '../../../internal/request-options';\nimport {\n  parseBetaMessage,\n  type ExtractParsedContentFromBetaParams,\n  type ParsedBetaMessage,\n} from '../../../lib/beta-parser';\nimport { BetaMessageStream } from '../../../lib/BetaMessageStream';\nimport {\n  BetaToolRunner,\n  BetaToolRunnerParams,\n  BetaToolRunnerRequestOptions,\n} from '../../../lib/tools/BetaToolRunner';\nimport type { Model } from '../../messages/messages';\nimport * as MessagesAPI from '../../messages/messages';\nimport * as BetaAPI from '../beta';\nimport * as BatchesAPI from './batches';\nimport {\n  BatchCancelParams,\n  BatchCreateParams,\n  BatchDeleteParams,\n  BatchListParams,\n  BatchResultsParams,\n  BatchRetrieveParams,\n  Batches,\n  BetaDeletedMessageBatch,\n  BetaMessageBatch,\n  BetaMessageBatchCanceledResult,\n  BetaMessageBatchErroredResult,\n  BetaMessageBatchExpiredResult,\n  BetaMessageBatchIndividualResponse,\n  BetaMessageBatchRequestCounts,\n  BetaMessageBatchResult,\n  BetaMessageBatchSucceededResult,\n  BetaMessageBatchesPage,\n} from './batches';\nimport * as MessagesMessagesAPI from './messages';\n\nconst DEPRECATED_MODELS: {\n  [K in Model]?: string;\n} = {\n  'claude-1.3': 'November 6th, 2024',\n  'claude-1.3-100k': 'November 6th, 2024',\n  'claude-instant-1.1': 'November 6th, 2024',\n  'claude-instant-1.1-100k': 'November 6th, 2024',\n  'claude-instant-1.2': 'November 6th, 2024',\n  'claude-3-sonnet-20240229': 'July 21st, 2025',\n  'claude-3-opus-20240229': 'January 5th, 2026',\n  'claude-2.1': 'July 21st, 2025',\n  'claude-2.0': 'July 21st, 2025',\n  'claude-3-7-sonnet-latest': 'February 19th, 2026',\n  'claude-3-7-sonnet-20250219': 'February 19th, 2026',\n};\n\nexport class Messages extends APIResource {\n  batches: BatchesAPI.Batches = new BatchesAPI.Batches(this._client);\n\n  /**\n   * Send a structured list of input messages with text and/or image content, and the\n   * model will generate the next message in the conversation.\n   *\n   * The Messages API can be used for either single queries or stateless multi-turn\n   * conversations.\n   *\n   * Learn more about the Messages API in our\n   * [user guide](https://docs.claude.com/en/docs/initial-setup)\n   *\n   * @example\n   * ```ts\n   * const betaMessage = await client.beta.messages.create({\n   *   max_tokens: 1024,\n   *   messages: [{ content: 'Hello, world', role: 'user' }],\n   *   model: 'claude-sonnet-4-5-20250929',\n   * });\n   * ```\n   */\n  create(params: MessageCreateParamsNonStreaming, options?: RequestOptions): APIPromise<BetaMessage>;\n  create(\n    params: MessageCreateParamsStreaming,\n    options?: RequestOptions,\n  ): APIPromise<Stream<BetaRawMessageStreamEvent>>;\n  create(\n    params: MessageCreateParamsBase,\n    options?: RequestOptions,\n  ): APIPromise<Stream<BetaRawMessageStreamEvent> | BetaMessage>;\n  create(\n    params: MessageCreateParams,\n    options?: RequestOptions,\n  ): APIPromise<BetaMessage> | APIPromise<Stream<BetaRawMessageStreamEvent>> {\n    const { betas, ...body } = params;\n\n    if (body.model in DEPRECATED_MODELS) {\n      console.warn(\n        `The model '${body.model}' is deprecated and will reach end-of-life on ${\n          DEPRECATED_MODELS[body.model]\n        }\\nPlease migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`,\n      );\n    }\n\n    let timeout = (this._client as any)._options.timeout as number | null;\n    if (!body.stream && timeout == null) {\n      const maxNonstreamingTokens = MODEL_NONSTREAMING_TOKENS[body.model] ?? undefined;\n      timeout = this._client.calculateNonstreamingTimeout(body.max_tokens, maxNonstreamingTokens);\n    }\n    return this._client.post('/v1/messages?beta=true', {\n      body,\n      timeout: timeout ?? 600000,\n      ...options,\n      headers: buildHeaders([\n        { ...(betas?.toString() != null ? { 'anthropic-beta': betas?.toString() } : undefined) },\n        options?.headers,\n      ]),\n      stream: params.stream ?? false,\n    }) as APIPromise<BetaMessage> | APIPromise<Stream<BetaRawMessageStreamEvent>>;\n  }\n\n  /**\n   * Send a structured list of input messages with text and/or image content, along with an expected `output_format` and\n   * the response will be automatically parsed and available in the `parsed_output` property of the message.\n   *\n   * @example\n   * ```ts\n   * const message = await client.beta.messages.parse({\n   *   model: 'claude-3-5-sonnet-20241022',\n   *   max_tokens: 1024,\n   *   messages: [{ role: 'user', content: 'What is 2+2?' }],\n   *   output_format: zodOutputFormat(z.object({ answer: z.number() }), 'math'),\n   * });\n   *\n   * console.log(message.parsed_output?.answer); // 4\n   * ```\n   */\n  parse<Params extends MessageCreateParamsNonStreaming>(\n    params: Params,\n    options?: RequestOptions,\n  ): APIPromise<ParsedBetaMessage<ExtractParsedContentFromBetaParams<Params>>> {\n    options = {\n      ...options,\n      headers: buildHeaders([\n        { 'anthropic-beta': [...(params.betas ?? []), 'structured-outputs-2025-11-13'].toString() },\n        options?.headers,\n      ]),\n    };\n\n    return this.create(params, options).then((message) =>\n      parseBetaMessage(message, params, { logger: this._client.logger ?? console }),\n    ) as APIPromise<ParsedBetaMessage<ExtractParsedContentFromBetaParams<Params>>>;\n  }\n\n  /**\n   * Create a Message stream\n   */\n  stream<Params extends BetaMessageStreamParams>(\n    body: Params,\n    options?: RequestOptions,\n  ): BetaMessageStream<ExtractParsedContentFromBetaParams<Params>> {\n    return BetaMessageStream.createMessage(this, body, options);\n  }\n\n  /**\n   * Count the number of tokens in a Message.\n   *\n   * The Token Count API can be used to count the number of tokens in a Message,\n   * including tools, images, and documents, without creating it.\n   *\n   * Learn more about token counting in our\n   * [user guide](https://docs.claude.com/en/docs/build-with-claude/token-counting)\n   *\n   * @example\n   * ```ts\n   * const betaMessageTokensCount =\n   *   await client.beta.messages.countTokens({\n   *     messages: [{ content: 'string', role: 'user' }],\n   *     model: 'claude-opus-4-5-20251101',\n   *   });\n   * ```\n   */\n  countTokens(\n    params: MessageCountTokensParams,\n    options?: RequestOptions,\n  ): APIPromise<BetaMessageTokensCount> {\n    const { betas, ...body } = params;\n    return this._client.post('/v1/messages/count_tokens?beta=true', {\n      body,\n      ...options,\n      headers: buildHeaders([\n        { 'anthropic-beta': [...(betas ?? []), 'token-counting-2024-11-01'].toString() },\n        options?.headers,\n      ]),\n    });\n  }\n\n  toolRunner(\n    body: BetaToolRunnerParams & { stream?: false },\n    options?: BetaToolRunnerRequestOptions,\n  ): BetaToolRunner<false>;\n  toolRunner(\n    body: BetaToolRunnerParams & { stream: true },\n    options?: BetaToolRunnerRequestOptions,\n  ): BetaToolRunner<true>;\n  toolRunner(body: BetaToolRunnerParams, options?: BetaToolRunnerRequestOptions): BetaToolRunner<boolean>;\n  toolRunner(body: BetaToolRunnerParams, options?: BetaToolRunnerRequestOptions): BetaToolRunner<boolean> {\n    return new BetaToolRunner(this._client as Anthropic, body, options);\n  }\n}\n\nexport interface BetaAllThinkingTurns {\n  type: 'all';\n}\n\nexport type BetaMessageStreamParams = MessageCreateParamsBase;\n\nexport interface BetaBase64ImageSource {\n  data: string;\n\n  media_type: 'image/jpeg' | 'image/png' | 'image/gif' | 'image/webp';\n\n  type: 'base64';\n}\n\nexport interface BetaBase64PDFSource {\n  data: string;\n\n  media_type: 'application/pdf';\n\n  type: 'base64';\n}\n\nexport interface BetaBashCodeExecutionOutputBlock {\n  file_id: string;\n\n  type: 'bash_code_execution_output';\n}\n\nexport interface BetaBashCodeExecutionOutputBlockParam {\n  file_id: string;\n\n  type: 'bash_code_execution_output';\n}\n\nexport interface BetaBashCodeExecutionResultBlock {\n  content: Array<BetaBashCodeExecutionOutputBlock>;\n\n  return_code: number;\n\n  stderr: string;\n\n  stdout: string;\n\n  type: 'bash_code_execution_result';\n}\n\nexport interface BetaBashCodeExecutionResultBlockParam {\n  content: Array<BetaBashCodeExecutionOutputBlockParam>;\n\n  return_code: number;\n\n  stderr: string;\n\n  stdout: string;\n\n  type: 'bash_code_execution_result';\n}\n\nexport interface BetaBashCodeExecutionToolResultBlock {\n  content: BetaBashCodeExecutionToolResultError | BetaBashCodeExecutionResultBlock;\n\n  tool_use_id: string;\n\n  type: 'bash_code_execution_tool_result';\n}\n\nexport interface BetaBashCodeExecutionToolResultBlockParam {\n  content: BetaBashCodeExecutionToolResultErrorParam | BetaBashCodeExecutionResultBlockParam;\n\n  tool_use_id: string;\n\n  type: 'bash_code_execution_tool_result';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n}\n\nexport interface BetaBashCodeExecutionToolResultError {\n  error_code:\n    | 'invalid_tool_input'\n    | 'unavailable'\n    | 'too_many_requests'\n    | 'execution_time_exceeded'\n    | 'output_file_too_large';\n\n  type: 'bash_code_execution_tool_result_error';\n}\n\nexport interface BetaBashCodeExecutionToolResultErrorParam {\n  error_code:\n    | 'invalid_tool_input'\n    | 'unavailable'\n    | 'too_many_requests'\n    | 'execution_time_exceeded'\n    | 'output_file_too_large';\n\n  type: 'bash_code_execution_tool_result_error';\n}\n\nexport interface BetaCacheControlEphemeral {\n  type: 'ephemeral';\n\n  /**\n   * The time-to-live for the cache control breakpoint.\n   *\n   * This may be one the following values:\n   *\n   * - `5m`: 5 minutes\n   * - `1h`: 1 hour\n   *\n   * Defaults to `5m`.\n   */\n  ttl?: '5m' | '1h';\n}\n\nexport interface BetaCacheCreation {\n  /**\n   * The number of input tokens used to create the 1 hour cache entry.\n   */\n  ephemeral_1h_input_tokens: number;\n\n  /**\n   * The number of input tokens used to create the 5 minute cache entry.\n   */\n  ephemeral_5m_input_tokens: number;\n}\n\nexport interface BetaCitationCharLocation {\n  cited_text: string;\n\n  document_index: number;\n\n  document_title: string | null;\n\n  end_char_index: number;\n\n  file_id: string | null;\n\n  start_char_index: number;\n\n  type: 'char_location';\n}\n\nexport interface BetaCitationCharLocationParam {\n  cited_text: string;\n\n  document_index: number;\n\n  document_title: string | null;\n\n  end_char_index: number;\n\n  start_char_index: number;\n\n  type: 'char_location';\n}\n\nexport interface BetaCitationConfig {\n  enabled: boolean;\n}\n\nexport interface BetaCitationContentBlockLocation {\n  cited_text: string;\n\n  document_index: number;\n\n  document_title: string | null;\n\n  end_block_index: number;\n\n  file_id: string | null;\n\n  start_block_index: number;\n\n  type: 'content_block_location';\n}\n\nexport interface BetaCitationContentBlockLocationParam {\n  cited_text: string;\n\n  document_index: number;\n\n  document_title: string | null;\n\n  end_block_index: number;\n\n  start_block_index: number;\n\n  type: 'content_block_location';\n}\n\nexport interface BetaCitationPageLocation {\n  cited_text: string;\n\n  document_index: number;\n\n  document_title: string | null;\n\n  end_page_number: number;\n\n  file_id: string | null;\n\n  start_page_number: number;\n\n  type: 'page_location';\n}\n\nexport interface BetaCitationPageLocationParam {\n  cited_text: string;\n\n  document_index: number;\n\n  document_title: string | null;\n\n  end_page_number: number;\n\n  start_page_number: number;\n\n  type: 'page_location';\n}\n\nexport interface BetaCitationSearchResultLocation {\n  cited_text: string;\n\n  end_block_index: number;\n\n  search_result_index: number;\n\n  source: string;\n\n  start_block_index: number;\n\n  title: string | null;\n\n  type: 'search_result_location';\n}\n\nexport interface BetaCitationSearchResultLocationParam {\n  cited_text: string;\n\n  end_block_index: number;\n\n  search_result_index: number;\n\n  source: string;\n\n  start_block_index: number;\n\n  title: string | null;\n\n  type: 'search_result_location';\n}\n\nexport interface BetaCitationWebSearchResultLocationParam {\n  cited_text: string;\n\n  encrypted_index: string;\n\n  title: string | null;\n\n  type: 'web_search_result_location';\n\n  url: string;\n}\n\nexport interface BetaCitationsConfigParam {\n  enabled?: boolean;\n}\n\nexport interface BetaCitationsDelta {\n  citation:\n    | BetaCitationCharLocation\n    | BetaCitationPageLocation\n    | BetaCitationContentBlockLocation\n    | BetaCitationsWebSearchResultLocation\n    | BetaCitationSearchResultLocation;\n\n  type: 'citations_delta';\n}\n\nexport interface BetaCitationsWebSearchResultLocation {\n  cited_text: string;\n\n  encrypted_index: string;\n\n  title: string | null;\n\n  type: 'web_search_result_location';\n\n  url: string;\n}\n\nexport interface BetaClearThinking20251015Edit {\n  type: 'clear_thinking_20251015';\n\n  /**\n   * Number of most recent assistant turns to keep thinking blocks for. Older turns\n   * will have their thinking blocks removed.\n   */\n  keep?: BetaThinkingTurns | BetaAllThinkingTurns | 'all';\n}\n\nexport interface BetaClearThinking20251015EditResponse {\n  /**\n   * Number of input tokens cleared by this edit.\n   */\n  cleared_input_tokens: number;\n\n  /**\n   * Number of thinking turns that were cleared.\n   */\n  cleared_thinking_turns: number;\n\n  /**\n   * The type of context management edit applied.\n   */\n  type: 'clear_thinking_20251015';\n}\n\nexport interface BetaClearToolUses20250919Edit {\n  type: 'clear_tool_uses_20250919';\n\n  /**\n   * Minimum number of tokens that must be cleared when triggered. Context will only\n   * be modified if at least this many tokens can be removed.\n   */\n  clear_at_least?: BetaInputTokensClearAtLeast | null;\n\n  /**\n   * Whether to clear all tool inputs (bool) or specific tool inputs to clear (list)\n   */\n  clear_tool_inputs?: boolean | Array<string> | null;\n\n  /**\n   * Tool names whose uses are preserved from clearing\n   */\n  exclude_tools?: Array<string> | null;\n\n  /**\n   * Number of tool uses to retain in the conversation\n   */\n  keep?: BetaToolUsesKeep;\n\n  /**\n   * Condition that triggers the context management strategy\n   */\n  trigger?: BetaInputTokensTrigger | BetaToolUsesTrigger;\n}\n\nexport interface BetaClearToolUses20250919EditResponse {\n  /**\n   * Number of input tokens cleared by this edit.\n   */\n  cleared_input_tokens: number;\n\n  /**\n   * Number of tool uses that were cleared.\n   */\n  cleared_tool_uses: number;\n\n  /**\n   * The type of context management edit applied.\n   */\n  type: 'clear_tool_uses_20250919';\n}\n\nexport interface BetaCodeExecutionOutputBlock {\n  file_id: string;\n\n  type: 'code_execution_output';\n}\n\nexport interface BetaCodeExecutionOutputBlockParam {\n  file_id: string;\n\n  type: 'code_execution_output';\n}\n\nexport interface BetaCodeExecutionResultBlock {\n  content: Array<BetaCodeExecutionOutputBlock>;\n\n  return_code: number;\n\n  stderr: string;\n\n  stdout: string;\n\n  type: 'code_execution_result';\n}\n\nexport interface BetaCodeExecutionResultBlockParam {\n  content: Array<BetaCodeExecutionOutputBlockParam>;\n\n  return_code: number;\n\n  stderr: string;\n\n  stdout: string;\n\n  type: 'code_execution_result';\n}\n\nexport interface BetaCodeExecutionTool20250522 {\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'code_execution';\n\n  type: 'code_execution_20250522';\n\n  allowed_callers?: Array<'direct' | 'code_execution_20250825'>;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * If true, tool will not be included in initial system prompt. Only loaded when\n   * returned via tool_reference from tool search.\n   */\n  defer_loading?: boolean;\n\n  strict?: boolean;\n}\n\nexport interface BetaCodeExecutionTool20250825 {\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'code_execution';\n\n  type: 'code_execution_20250825';\n\n  allowed_callers?: Array<'direct' | 'code_execution_20250825'>;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * If true, tool will not be included in initial system prompt. Only loaded when\n   * returned via tool_reference from tool search.\n   */\n  defer_loading?: boolean;\n\n  strict?: boolean;\n}\n\nexport interface BetaCodeExecutionToolResultBlock {\n  content: BetaCodeExecutionToolResultBlockContent;\n\n  tool_use_id: string;\n\n  type: 'code_execution_tool_result';\n}\n\nexport type BetaCodeExecutionToolResultBlockContent =\n  | BetaCodeExecutionToolResultError\n  | BetaCodeExecutionResultBlock;\n\nexport interface BetaCodeExecutionToolResultBlockParam {\n  content: BetaCodeExecutionToolResultBlockParamContent;\n\n  tool_use_id: string;\n\n  type: 'code_execution_tool_result';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n}\n\nexport type BetaCodeExecutionToolResultBlockParamContent =\n  | BetaCodeExecutionToolResultErrorParam\n  | BetaCodeExecutionResultBlockParam;\n\nexport interface BetaCodeExecutionToolResultError {\n  error_code: BetaCodeExecutionToolResultErrorCode;\n\n  type: 'code_execution_tool_result_error';\n}\n\nexport type BetaCodeExecutionToolResultErrorCode =\n  | 'invalid_tool_input'\n  | 'unavailable'\n  | 'too_many_requests'\n  | 'execution_time_exceeded';\n\nexport interface BetaCodeExecutionToolResultErrorParam {\n  error_code: BetaCodeExecutionToolResultErrorCode;\n\n  type: 'code_execution_tool_result_error';\n}\n\n/**\n * Information about the container used in the request (for the code execution\n * tool)\n */\nexport interface BetaContainer {\n  /**\n   * Identifier for the container used in this request\n   */\n  id: string;\n\n  /**\n   * The time at which the container will expire.\n   */\n  expires_at: string;\n\n  /**\n   * Skills loaded in the container\n   */\n  skills: Array<BetaSkill> | null;\n}\n\n/**\n * Container parameters with skills to be loaded.\n */\nexport interface BetaContainerParams {\n  /**\n   * Container id\n   */\n  id?: string | null;\n\n  /**\n   * List of skills to load in the container\n   */\n  skills?: Array<BetaSkillParams> | null;\n}\n\n/**\n * Response model for a file uploaded to the container.\n */\nexport interface BetaContainerUploadBlock {\n  file_id: string;\n\n  type: 'container_upload';\n}\n\n/**\n * A content block that represents a file to be uploaded to the container Files\n * uploaded via this block will be available in the container's input directory.\n */\nexport interface BetaContainerUploadBlockParam {\n  file_id: string;\n\n  type: 'container_upload';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n}\n\n/**\n * Response model for a file uploaded to the container.\n */\nexport type BetaContentBlock =\n  | BetaTextBlock\n  | BetaThinkingBlock\n  | BetaRedactedThinkingBlock\n  | BetaToolUseBlock\n  | BetaServerToolUseBlock\n  | BetaWebSearchToolResultBlock\n  | BetaWebFetchToolResultBlock\n  | BetaCodeExecutionToolResultBlock\n  | BetaBashCodeExecutionToolResultBlock\n  | BetaTextEditorCodeExecutionToolResultBlock\n  | BetaToolSearchToolResultBlock\n  | BetaMCPToolUseBlock\n  | BetaMCPToolResultBlock\n  | BetaContainerUploadBlock;\n\n/**\n * Regular text content.\n */\nexport type BetaContentBlockParam =\n  | BetaTextBlockParam\n  | BetaImageBlockParam\n  | BetaRequestDocumentBlock\n  | BetaSearchResultBlockParam\n  | BetaThinkingBlockParam\n  | BetaRedactedThinkingBlockParam\n  | BetaToolUseBlockParam\n  | BetaToolResultBlockParam\n  | BetaServerToolUseBlockParam\n  | BetaWebSearchToolResultBlockParam\n  | BetaWebFetchToolResultBlockParam\n  | BetaCodeExecutionToolResultBlockParam\n  | BetaBashCodeExecutionToolResultBlockParam\n  | BetaTextEditorCodeExecutionToolResultBlockParam\n  | BetaToolSearchToolResultBlockParam\n  | BetaMCPToolUseBlockParam\n  | BetaRequestMCPToolResultBlockParam\n  | BetaContainerUploadBlockParam;\n\nexport interface BetaContentBlockSource {\n  content: string | Array<BetaContentBlockSourceContent>;\n\n  type: 'content';\n}\n\nexport type BetaContentBlockSourceContent = BetaTextBlockParam | BetaImageBlockParam;\n\nexport interface BetaContextManagementConfig {\n  /**\n   * List of context management edits to apply\n   */\n  edits?: Array<BetaClearToolUses20250919Edit | BetaClearThinking20251015Edit>;\n}\n\nexport interface BetaContextManagementResponse {\n  /**\n   * List of context management edits that were applied.\n   */\n  applied_edits: Array<BetaClearToolUses20250919EditResponse | BetaClearThinking20251015EditResponse>;\n}\n\nexport interface BetaCountTokensContextManagementResponse {\n  /**\n   * The original token count before context management was applied\n   */\n  original_input_tokens: number;\n}\n\n/**\n * Tool invocation directly from the model.\n */\nexport interface BetaDirectCaller {\n  type: 'direct';\n}\n\nexport interface BetaDocumentBlock {\n  /**\n   * Citation configuration for the document\n   */\n  citations: BetaCitationConfig | null;\n\n  source: BetaBase64PDFSource | BetaPlainTextSource;\n\n  /**\n   * The title of the document\n   */\n  title: string | null;\n\n  type: 'document';\n}\n\nexport interface BetaFileDocumentSource {\n  file_id: string;\n\n  type: 'file';\n}\n\nexport interface BetaFileImageSource {\n  file_id: string;\n\n  type: 'file';\n}\n\nexport interface BetaImageBlockParam {\n  source: BetaBase64ImageSource | BetaURLImageSource | BetaFileImageSource;\n\n  type: 'image';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n}\n\nexport interface BetaInputJSONDelta {\n  partial_json: string;\n\n  type: 'input_json_delta';\n}\n\nexport interface BetaInputTokensClearAtLeast {\n  type: 'input_tokens';\n\n  value: number;\n}\n\nexport interface BetaInputTokensTrigger {\n  type: 'input_tokens';\n\n  value: number;\n}\n\nexport interface BetaJSONOutputFormat {\n  /**\n   * The JSON schema of the format\n   */\n  schema: { [key: string]: unknown };\n\n  type: 'json_schema';\n}\n\n/**\n * Configuration for a specific tool in an MCP toolset.\n */\nexport interface BetaMCPToolConfig {\n  defer_loading?: boolean;\n\n  enabled?: boolean;\n}\n\n/**\n * Default configuration for tools in an MCP toolset.\n */\nexport interface BetaMCPToolDefaultConfig {\n  defer_loading?: boolean;\n\n  enabled?: boolean;\n}\n\nexport interface BetaMCPToolResultBlock {\n  content: string | Array<BetaTextBlock>;\n\n  is_error: boolean;\n\n  tool_use_id: string;\n\n  type: 'mcp_tool_result';\n}\n\nexport interface BetaMCPToolUseBlock {\n  id: string;\n\n  input: unknown;\n\n  /**\n   * The name of the MCP tool\n   */\n  name: string;\n\n  /**\n   * The name of the MCP server\n   */\n  server_name: string;\n\n  type: 'mcp_tool_use';\n}\n\nexport interface BetaMCPToolUseBlockParam {\n  id: string;\n\n  input: unknown;\n\n  name: string;\n\n  /**\n   * The name of the MCP server\n   */\n  server_name: string;\n\n  type: 'mcp_tool_use';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n}\n\n/**\n * Configuration for a group of tools from an MCP server.\n *\n * Allows configuring enabled status and defer_loading for all tools from an MCP\n * server, with optional per-tool overrides.\n */\nexport interface BetaMCPToolset {\n  /**\n   * Name of the MCP server to configure tools for\n   */\n  mcp_server_name: string;\n\n  type: 'mcp_toolset';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * Configuration overrides for specific tools, keyed by tool name\n   */\n  configs?: { [key: string]: BetaMCPToolConfig } | null;\n\n  /**\n   * Default configuration applied to all tools from this server\n   */\n  default_config?: BetaMCPToolDefaultConfig;\n}\n\nexport interface BetaMemoryTool20250818 {\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'memory';\n\n  type: 'memory_20250818';\n\n  allowed_callers?: Array<'direct' | 'code_execution_20250825'>;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * If true, tool will not be included in initial system prompt. Only loaded when\n   * returned via tool_reference from tool search.\n   */\n  defer_loading?: boolean;\n\n  input_examples?: Array<{ [key: string]: unknown }>;\n\n  strict?: boolean;\n}\n\nexport type BetaMemoryTool20250818Command =\n  | BetaMemoryTool20250818ViewCommand\n  | BetaMemoryTool20250818CreateCommand\n  | BetaMemoryTool20250818StrReplaceCommand\n  | BetaMemoryTool20250818InsertCommand\n  | BetaMemoryTool20250818DeleteCommand\n  | BetaMemoryTool20250818RenameCommand;\n\nexport interface BetaMemoryTool20250818CreateCommand {\n  /**\n   * Command type identifier\n   */\n  command: 'create';\n\n  /**\n   * Content to write to the file\n   */\n  file_text: string;\n\n  /**\n   * Path where the file should be created\n   */\n  path: string;\n}\n\nexport interface BetaMemoryTool20250818DeleteCommand {\n  /**\n   * Command type identifier\n   */\n  command: 'delete';\n\n  /**\n   * Path to the file or directory to delete\n   */\n  path: string;\n}\n\nexport interface BetaMemoryTool20250818InsertCommand {\n  /**\n   * Command type identifier\n   */\n  command: 'insert';\n\n  /**\n   * Line number where text should be inserted\n   */\n  insert_line: number;\n\n  /**\n   * Text to insert at the specified line\n   */\n  insert_text: string;\n\n  /**\n   * Path to the file where text should be inserted\n   */\n  path: string;\n}\n\nexport interface BetaMemoryTool20250818RenameCommand {\n  /**\n   * Command type identifier\n   */\n  command: 'rename';\n\n  /**\n   * New path for the file or directory\n   */\n  new_path: string;\n\n  /**\n   * Current path of the file or directory\n   */\n  old_path: string;\n}\n\nexport interface BetaMemoryTool20250818StrReplaceCommand {\n  /**\n   * Command type identifier\n   */\n  command: 'str_replace';\n\n  /**\n   * Text to replace with\n   */\n  new_str: string;\n\n  /**\n   * Text to search for and replace\n   */\n  old_str: string;\n\n  /**\n   * Path to the file where text should be replaced\n   */\n  path: string;\n}\n\nexport interface BetaMemoryTool20250818ViewCommand {\n  /**\n   * Command type identifier\n   */\n  command: 'view';\n\n  /**\n   * Path to directory or file to view\n   */\n  path: string;\n\n  /**\n   * Optional line range for viewing specific lines\n   */\n  view_range?: Array<number>;\n}\n\nexport interface BetaMessage {\n  /**\n   * Unique object identifier.\n   *\n   * The format and length of IDs may change over time.\n   */\n  id: string;\n\n  /**\n   * Information about the container used in the request (for the code execution\n   * tool)\n   */\n  container: BetaContainer | null;\n\n  /**\n   * Content generated by the model.\n   *\n   * This is an array of content blocks, each of which has a `type` that determines\n   * its shape.\n   *\n   * Example:\n   *\n   * ```json\n   * [{ \"type\": \"text\", \"text\": \"Hi, I'm Claude.\" }]\n   * ```\n   *\n   * If the request input `messages` ended with an `assistant` turn, then the\n   * response `content` will continue directly from that last turn. You can use this\n   * to constrain the model's output.\n   *\n   * For example, if the input `messages` were:\n   *\n   * ```json\n   * [\n   *   {\n   *     \"role\": \"user\",\n   *     \"content\": \"What's the Greek name for Sun? (A) Sol (B) Helios (C) Sun\"\n   *   },\n   *   { \"role\": \"assistant\", \"content\": \"The best answer is (\" }\n   * ]\n   * ```\n   *\n   * Then the response `content` might be:\n   *\n   * ```json\n   * [{ \"type\": \"text\", \"text\": \"B)\" }]\n   * ```\n   */\n  content: Array<BetaContentBlock>;\n\n  /**\n   * Context management response.\n   *\n   * Information about context management strategies applied during the request.\n   */\n  context_management: BetaContextManagementResponse | null;\n\n  /**\n   * The model that will complete your prompt.\\n\\nSee\n   * [models](https://docs.anthropic.com/en/docs/models-overview) for additional\n   * details and options.\n   */\n  model: MessagesAPI.Model;\n\n  /**\n   * Conversational role of the generated message.\n   *\n   * This will always be `\"assistant\"`.\n   */\n  role: 'assistant';\n\n  /**\n   * The reason that we stopped.\n   *\n   * This may be one the following values:\n   *\n   * - `\"end_turn\"`: the model reached a natural stopping point\n   * - `\"max_tokens\"`: we exceeded the requested `max_tokens` or the model's maximum\n   * - `\"stop_sequence\"`: one of your provided custom `stop_sequences` was generated\n   * - `\"tool_use\"`: the model invoked one or more tools\n   * - `\"pause_turn\"`: we paused a long-running turn. You may provide the response\n   *   back as-is in a subsequent request to let the model continue.\n   * - `\"refusal\"`: when streaming classifiers intervene to handle potential policy\n   *   violations\n   *\n   * In non-streaming mode this value is always non-null. In streaming mode, it is\n   * null in the `message_start` event and non-null otherwise.\n   */\n  stop_reason: BetaStopReason | null;\n\n  /**\n   * Which custom stop sequence was generated, if any.\n   *\n   * This value will be a non-null string if one of your custom stop sequences was\n   * generated.\n   */\n  stop_sequence: string | null;\n\n  /**\n   * Object type.\n   *\n   * For Messages, this is always `\"message\"`.\n   */\n  type: 'message';\n\n  /**\n   * Billing and rate-limit usage.\n   *\n   * Anthropic's API bills and rate-limits by token counts, as tokens represent the\n   * underlying cost to our systems.\n   *\n   * Under the hood, the API transforms requests into a format suitable for the\n   * model. The model's output then goes through a parsing stage before becoming an\n   * API response. As a result, the token counts in `usage` will not match one-to-one\n   * with the exact visible content of an API request or response.\n   *\n   * For example, `output_tokens` will be non-zero, even for an empty string response\n   * from Claude.\n   *\n   * Total input tokens in a request is the summation of `input_tokens`,\n   * `cache_creation_input_tokens`, and `cache_read_input_tokens`.\n   */\n  usage: BetaUsage;\n}\n\nexport interface BetaMessageDeltaUsage {\n  /**\n   * The cumulative number of input tokens used to create the cache entry.\n   */\n  cache_creation_input_tokens: number | null;\n\n  /**\n   * The cumulative number of input tokens read from the cache.\n   */\n  cache_read_input_tokens: number | null;\n\n  /**\n   * The cumulative number of input tokens which were used.\n   */\n  input_tokens: number | null;\n\n  /**\n   * The cumulative number of output tokens which were used.\n   */\n  output_tokens: number;\n\n  /**\n   * The number of server tool requests.\n   */\n  server_tool_use: BetaServerToolUsage | null;\n}\n\nexport interface BetaMessageParam {\n  content: string | Array<BetaContentBlockParam>;\n\n  role: 'user' | 'assistant';\n}\n\nexport interface BetaMessageTokensCount {\n  /**\n   * Information about context management applied to the message.\n   */\n  context_management: BetaCountTokensContextManagementResponse | null;\n\n  /**\n   * The total number of tokens across the provided list of messages, system prompt,\n   * and tools.\n   */\n  input_tokens: number;\n}\n\nexport interface BetaMetadata {\n  /**\n   * An external identifier for the user who is associated with the request.\n   *\n   * This should be a uuid, hash value, or other opaque identifier. Anthropic may use\n   * this id to help detect abuse. Do not include any identifying information such as\n   * name, email address, or phone number.\n   */\n  user_id?: string | null;\n}\n\nexport interface BetaOutputConfig {\n  /**\n   * All possible effort levels.\n   */\n  effort?: 'low' | 'medium' | 'high' | null;\n}\n\nexport interface BetaPlainTextSource {\n  data: string;\n\n  media_type: 'text/plain';\n\n  type: 'text';\n}\n\nexport type BetaRawContentBlockDelta =\n  | BetaTextDelta\n  | BetaInputJSONDelta\n  | BetaCitationsDelta\n  | BetaThinkingDelta\n  | BetaSignatureDelta;\n\nexport interface BetaRawContentBlockDeltaEvent {\n  delta: BetaRawContentBlockDelta;\n\n  index: number;\n\n  type: 'content_block_delta';\n}\n\nexport interface BetaRawContentBlockStartEvent {\n  /**\n   * Response model for a file uploaded to the container.\n   */\n  content_block:\n    | BetaTextBlock\n    | BetaThinkingBlock\n    | BetaRedactedThinkingBlock\n    | BetaToolUseBlock\n    | BetaServerToolUseBlock\n    | BetaWebSearchToolResultBlock\n    | BetaWebFetchToolResultBlock\n    | BetaCodeExecutionToolResultBlock\n    | BetaBashCodeExecutionToolResultBlock\n    | BetaTextEditorCodeExecutionToolResultBlock\n    | BetaToolSearchToolResultBlock\n    | BetaMCPToolUseBlock\n    | BetaMCPToolResultBlock\n    | BetaContainerUploadBlock;\n\n  index: number;\n\n  type: 'content_block_start';\n}\n\nexport interface BetaRawContentBlockStopEvent {\n  index: number;\n\n  type: 'content_block_stop';\n}\n\nexport interface BetaRawMessageDeltaEvent {\n  /**\n   * Information about context management strategies applied during the request\n   */\n  context_management: BetaContextManagementResponse | null;\n\n  delta: BetaRawMessageDeltaEvent.Delta;\n\n  type: 'message_delta';\n\n  /**\n   * Billing and rate-limit usage.\n   *\n   * Anthropic's API bills and rate-limits by token counts, as tokens represent the\n   * underlying cost to our systems.\n   *\n   * Under the hood, the API transforms requests into a format suitable for the\n   * model. The model's output then goes through a parsing stage before becoming an\n   * API response. As a result, the token counts in `usage` will not match one-to-one\n   * with the exact visible content of an API request or response.\n   *\n   * For example, `output_tokens` will be non-zero, even for an empty string response\n   * from Claude.\n   *\n   * Total input tokens in a request is the summation of `input_tokens`,\n   * `cache_creation_input_tokens`, and `cache_read_input_tokens`.\n   */\n  usage: BetaMessageDeltaUsage;\n}\n\nexport namespace BetaRawMessageDeltaEvent {\n  export interface Delta {\n    /**\n     * Information about the container used in the request (for the code execution\n     * tool)\n     */\n    container: MessagesMessagesAPI.BetaContainer | null;\n\n    stop_reason: MessagesMessagesAPI.BetaStopReason | null;\n\n    stop_sequence: string | null;\n  }\n}\n\nexport interface BetaRawMessageStartEvent {\n  message: BetaMessage;\n\n  type: 'message_start';\n}\n\nexport interface BetaRawMessageStopEvent {\n  type: 'message_stop';\n}\n\nexport type BetaRawMessageStreamEvent =\n  | BetaRawMessageStartEvent\n  | BetaRawMessageDeltaEvent\n  | BetaRawMessageStopEvent\n  | BetaRawContentBlockStartEvent\n  | BetaRawContentBlockDeltaEvent\n  | BetaRawContentBlockStopEvent;\n\nexport interface BetaRedactedThinkingBlock {\n  data: string;\n\n  type: 'redacted_thinking';\n}\n\nexport interface BetaRedactedThinkingBlockParam {\n  data: string;\n\n  type: 'redacted_thinking';\n}\n\nexport interface BetaRequestDocumentBlock {\n  source:\n    | BetaBase64PDFSource\n    | BetaPlainTextSource\n    | BetaContentBlockSource\n    | BetaURLPDFSource\n    | BetaFileDocumentSource;\n\n  type: 'document';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  citations?: BetaCitationsConfigParam | null;\n\n  context?: string | null;\n\n  title?: string | null;\n}\n\nexport interface BetaRequestMCPServerToolConfiguration {\n  allowed_tools?: Array<string> | null;\n\n  enabled?: boolean | null;\n}\n\nexport interface BetaRequestMCPServerURLDefinition {\n  name: string;\n\n  type: 'url';\n\n  url: string;\n\n  authorization_token?: string | null;\n\n  tool_configuration?: BetaRequestMCPServerToolConfiguration | null;\n}\n\nexport interface BetaRequestMCPToolResultBlockParam {\n  tool_use_id: string;\n\n  type: 'mcp_tool_result';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  content?: string | Array<BetaTextBlockParam>;\n\n  is_error?: boolean;\n}\n\nexport interface BetaSearchResultBlockParam {\n  content: Array<BetaTextBlockParam>;\n\n  source: string;\n\n  title: string;\n\n  type: 'search_result';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  citations?: BetaCitationsConfigParam;\n}\n\n/**\n * Tool invocation generated by a server-side tool.\n */\nexport interface BetaServerToolCaller {\n  tool_id: string;\n\n  type: 'code_execution_20250825';\n}\n\nexport interface BetaServerToolUsage {\n  /**\n   * The number of web fetch tool requests.\n   */\n  web_fetch_requests: number;\n\n  /**\n   * The number of web search tool requests.\n   */\n  web_search_requests: number;\n}\n\nexport interface BetaServerToolUseBlock {\n  id: string;\n\n  /**\n   * Tool invocation directly from the model.\n   */\n  caller: BetaDirectCaller | BetaServerToolCaller;\n\n  input: { [key: string]: unknown };\n\n  name:\n    | 'web_search'\n    | 'web_fetch'\n    | 'code_execution'\n    | 'bash_code_execution'\n    | 'text_editor_code_execution'\n    | 'tool_search_tool_regex'\n    | 'tool_search_tool_bm25';\n\n  type: 'server_tool_use';\n}\n\nexport interface BetaServerToolUseBlockParam {\n  id: string;\n\n  input: unknown;\n\n  name:\n    | 'web_search'\n    | 'web_fetch'\n    | 'code_execution'\n    | 'bash_code_execution'\n    | 'text_editor_code_execution'\n    | 'tool_search_tool_regex'\n    | 'tool_search_tool_bm25';\n\n  type: 'server_tool_use';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * Tool invocation directly from the model.\n   */\n  caller?: BetaDirectCaller | BetaServerToolCaller;\n}\n\nexport interface BetaSignatureDelta {\n  signature: string;\n\n  type: 'signature_delta';\n}\n\n/**\n * A skill that was loaded in a container (response model).\n */\nexport interface BetaSkill {\n  /**\n   * Skill ID\n   */\n  skill_id: string;\n\n  /**\n   * Type of skill - either 'anthropic' (built-in) or 'custom' (user-defined)\n   */\n  type: 'anthropic' | 'custom';\n\n  /**\n   * Skill version or 'latest' for most recent version\n   */\n  version: string;\n}\n\n/**\n * Specification for a skill to be loaded in a container (request model).\n */\nexport interface BetaSkillParams {\n  /**\n   * Skill ID\n   */\n  skill_id: string;\n\n  /**\n   * Type of skill - either 'anthropic' (built-in) or 'custom' (user-defined)\n   */\n  type: 'anthropic' | 'custom';\n\n  /**\n   * Skill version or 'latest' for most recent version\n   */\n  version?: string;\n}\n\nexport type BetaStopReason =\n  | 'end_turn'\n  | 'max_tokens'\n  | 'stop_sequence'\n  | 'tool_use'\n  | 'pause_turn'\n  | 'refusal'\n  | 'model_context_window_exceeded';\n\nexport interface BetaTextBlock {\n  /**\n   * Citations supporting the text block.\n   *\n   * The type of citation returned will depend on the type of document being cited.\n   * Citing a PDF results in `page_location`, plain text results in `char_location`,\n   * and content document results in `content_block_location`.\n   */\n  citations: Array<BetaTextCitation> | null;\n\n  text: string;\n\n  type: 'text';\n}\n\nexport interface BetaTextBlockParam {\n  text: string;\n\n  type: 'text';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  citations?: Array<BetaTextCitationParam> | null;\n}\n\nexport type BetaTextCitation =\n  | BetaCitationCharLocation\n  | BetaCitationPageLocation\n  | BetaCitationContentBlockLocation\n  | BetaCitationsWebSearchResultLocation\n  | BetaCitationSearchResultLocation;\n\nexport type BetaTextCitationParam =\n  | BetaCitationCharLocationParam\n  | BetaCitationPageLocationParam\n  | BetaCitationContentBlockLocationParam\n  | BetaCitationWebSearchResultLocationParam\n  | BetaCitationSearchResultLocationParam;\n\nexport interface BetaTextDelta {\n  text: string;\n\n  type: 'text_delta';\n}\n\nexport interface BetaTextEditorCodeExecutionCreateResultBlock {\n  is_file_update: boolean;\n\n  type: 'text_editor_code_execution_create_result';\n}\n\nexport interface BetaTextEditorCodeExecutionCreateResultBlockParam {\n  is_file_update: boolean;\n\n  type: 'text_editor_code_execution_create_result';\n}\n\nexport interface BetaTextEditorCodeExecutionStrReplaceResultBlock {\n  lines: Array<string> | null;\n\n  new_lines: number | null;\n\n  new_start: number | null;\n\n  old_lines: number | null;\n\n  old_start: number | null;\n\n  type: 'text_editor_code_execution_str_replace_result';\n}\n\nexport interface BetaTextEditorCodeExecutionStrReplaceResultBlockParam {\n  type: 'text_editor_code_execution_str_replace_result';\n\n  lines?: Array<string> | null;\n\n  new_lines?: number | null;\n\n  new_start?: number | null;\n\n  old_lines?: number | null;\n\n  old_start?: number | null;\n}\n\nexport interface BetaTextEditorCodeExecutionToolResultBlock {\n  content:\n    | BetaTextEditorCodeExecutionToolResultError\n    | BetaTextEditorCodeExecutionViewResultBlock\n    | BetaTextEditorCodeExecutionCreateResultBlock\n    | BetaTextEditorCodeExecutionStrReplaceResultBlock;\n\n  tool_use_id: string;\n\n  type: 'text_editor_code_execution_tool_result';\n}\n\nexport interface BetaTextEditorCodeExecutionToolResultBlockParam {\n  content:\n    | BetaTextEditorCodeExecutionToolResultErrorParam\n    | BetaTextEditorCodeExecutionViewResultBlockParam\n    | BetaTextEditorCodeExecutionCreateResultBlockParam\n    | BetaTextEditorCodeExecutionStrReplaceResultBlockParam;\n\n  tool_use_id: string;\n\n  type: 'text_editor_code_execution_tool_result';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n}\n\nexport interface BetaTextEditorCodeExecutionToolResultError {\n  error_code:\n    | 'invalid_tool_input'\n    | 'unavailable'\n    | 'too_many_requests'\n    | 'execution_time_exceeded'\n    | 'file_not_found';\n\n  error_message: string | null;\n\n  type: 'text_editor_code_execution_tool_result_error';\n}\n\nexport interface BetaTextEditorCodeExecutionToolResultErrorParam {\n  error_code:\n    | 'invalid_tool_input'\n    | 'unavailable'\n    | 'too_many_requests'\n    | 'execution_time_exceeded'\n    | 'file_not_found';\n\n  type: 'text_editor_code_execution_tool_result_error';\n\n  error_message?: string | null;\n}\n\nexport interface BetaTextEditorCodeExecutionViewResultBlock {\n  content: string;\n\n  file_type: 'text' | 'image' | 'pdf';\n\n  num_lines: number | null;\n\n  start_line: number | null;\n\n  total_lines: number | null;\n\n  type: 'text_editor_code_execution_view_result';\n}\n\nexport interface BetaTextEditorCodeExecutionViewResultBlockParam {\n  content: string;\n\n  file_type: 'text' | 'image' | 'pdf';\n\n  type: 'text_editor_code_execution_view_result';\n\n  num_lines?: number | null;\n\n  start_line?: number | null;\n\n  total_lines?: number | null;\n}\n\nexport interface BetaThinkingBlock {\n  signature: string;\n\n  thinking: string;\n\n  type: 'thinking';\n}\n\nexport interface BetaThinkingBlockParam {\n  signature: string;\n\n  thinking: string;\n\n  type: 'thinking';\n}\n\nexport interface BetaThinkingConfigDisabled {\n  type: 'disabled';\n}\n\nexport interface BetaThinkingConfigEnabled {\n  /**\n   * Determines how many tokens Claude can use for its internal reasoning process.\n   * Larger budgets can enable more thorough analysis for complex problems, improving\n   * response quality.\n   *\n   * Must be \u22651024 and less than `max_tokens`.\n   *\n   * See\n   * [extended thinking](https://docs.claude.com/en/docs/build-with-claude/extended-thinking)\n   * for details.\n   */\n  budget_tokens: number;\n\n  type: 'enabled';\n}\n\n/**\n * Configuration for enabling Claude's extended thinking.\n *\n * When enabled, responses include `thinking` content blocks showing Claude's\n * thinking process before the final answer. Requires a minimum budget of 1,024\n * tokens and counts towards your `max_tokens` limit.\n *\n * See\n * [extended thinking](https://docs.claude.com/en/docs/build-with-claude/extended-thinking)\n * for details.\n */\nexport type BetaThinkingConfigParam = BetaThinkingConfigEnabled | BetaThinkingConfigDisabled;\n\nexport interface BetaThinkingDelta {\n  thinking: string;\n\n  type: 'thinking_delta';\n}\n\nexport interface BetaThinkingTurns {\n  type: 'thinking_turns';\n\n  value: number;\n}\n\nexport interface BetaTool {\n  /**\n   * [JSON schema](https://json-schema.org/draft/2020-12) for this tool's input.\n   *\n   * This defines the shape of the `input` that your tool accepts and that the model\n   * will produce.\n   */\n  input_schema: BetaTool.InputSchema;\n\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: string;\n\n  allowed_callers?: Array<'direct' | 'code_execution_20250825'>;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * If true, tool will not be included in initial system prompt. Only loaded when\n   * returned via tool_reference from tool search.\n   */\n  defer_loading?: boolean;\n\n  /**\n   * Description of what this tool does.\n   *\n   * Tool descriptions should be as detailed as possible. The more information that\n   * the model has about what the tool is and how to use it, the better it will\n   * perform. You can use natural language descriptions to reinforce important\n   * aspects of the tool input JSON schema.\n   */\n  description?: string;\n\n  input_examples?: Array<{ [key: string]: unknown }>;\n\n  strict?: boolean;\n\n  type?: 'custom' | null;\n}\n\nexport namespace BetaTool {\n  /**\n   * [JSON schema](https://json-schema.org/draft/2020-12) for this tool's input.\n   *\n   * This defines the shape of the `input` that your tool accepts and that the model\n   * will produce.\n   */\n  export interface InputSchema {\n    type: 'object';\n\n    properties?: unknown | null;\n\n    required?: string[] | readonly string[] | null;\n\n    [k: string]: unknown;\n  }\n}\n\nexport interface BetaToolBash20241022 {\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'bash';\n\n  type: 'bash_20241022';\n\n  allowed_callers?: Array<'direct' | 'code_execution_20250825'>;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * If true, tool will not be included in initial system prompt. Only loaded when\n   * returned via tool_reference from tool search.\n   */\n  defer_loading?: boolean;\n\n  input_examples?: Array<{ [key: string]: unknown }>;\n\n  strict?: boolean;\n}\n\nexport interface BetaToolBash20250124 {\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'bash';\n\n  type: 'bash_20250124';\n\n  allowed_callers?: Array<'direct' | 'code_execution_20250825'>;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * If true, tool will not be included in initial system prompt. Only loaded when\n   * returned via tool_reference from tool search.\n   */\n  defer_loading?: boolean;\n\n  input_examples?: Array<{ [key: string]: unknown }>;\n\n  strict?: boolean;\n}\n\n/**\n * How the model should use the provided tools. The model can use a specific tool,\n * any available tool, decide by itself, or not use tools at all.\n */\nexport type BetaToolChoice = BetaToolChoiceAuto | BetaToolChoiceAny | BetaToolChoiceTool | BetaToolChoiceNone;\n\n/**\n * The model will use any available tools.\n */\nexport interface BetaToolChoiceAny {\n  type: 'any';\n\n  /**\n   * Whether to disable parallel tool use.\n   *\n   * Defaults to `false`. If set to `true`, the model will output exactly one tool\n   * use.\n   */\n  disable_parallel_tool_use?: boolean;\n}\n\n/**\n * The model will automatically decide whether to use tools.\n */\nexport interface BetaToolChoiceAuto {\n  type: 'auto';\n\n  /**\n   * Whether to disable parallel tool use.\n   *\n   * Defaults to `false`. If set to `true`, the model will output at most one tool\n   * use.\n   */\n  disable_parallel_tool_use?: boolean;\n}\n\n/**\n * The model will not be allowed to use tools.\n */\nexport interface BetaToolChoiceNone {\n  type: 'none';\n}\n\n/**\n * The model will use the specified tool with `tool_choice.name`.\n */\nexport interface BetaToolChoiceTool {\n  /**\n   * The name of the tool to use.\n   */\n  name: string;\n\n  type: 'tool';\n\n  /**\n   * Whether to disable parallel tool use.\n   *\n   * Defaults to `false`. If set to `true`, the model will output exactly one tool\n   * use.\n   */\n  disable_parallel_tool_use?: boolean;\n}\n\nexport interface BetaToolComputerUse20241022 {\n  /**\n   * The height of the display in pixels.\n   */\n  display_height_px: number;\n\n  /**\n   * The width of the display in pixels.\n   */\n  display_width_px: number;\n\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'computer';\n\n  type: 'computer_20241022';\n\n  allowed_callers?: Array<'direct' | 'code_execution_20250825'>;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * If true, tool will not be included in initial system prompt. Only loaded when\n   * returned via tool_reference from tool search.\n   */\n  defer_loading?: boolean;\n\n  /**\n   * The X11 display number (e.g. 0, 1) for the display.\n   */\n  display_number?: number | null;\n\n  input_examples?: Array<{ [key: string]: unknown }>;\n\n  strict?: boolean;\n}\n\nexport interface BetaToolComputerUse20250124 {\n  /**\n   * The height of the display in pixels.\n   */\n  display_height_px: number;\n\n  /**\n   * The width of the display in pixels.\n   */\n  display_width_px: number;\n\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'computer';\n\n  type: 'computer_20250124';\n\n  allowed_callers?: Array<'direct' | 'code_execution_20250825'>;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * If true, tool will not be included in initial system prompt. Only loaded when\n   * returned via tool_reference from tool search.\n   */\n  defer_loading?: boolean;\n\n  /**\n   * The X11 display number (e.g. 0, 1) for the display.\n   */\n  display_number?: number | null;\n\n  input_examples?: Array<{ [key: string]: unknown }>;\n\n  strict?: boolean;\n}\n\nexport interface BetaToolComputerUse20251124 {\n  /**\n   * The height of the display in pixels.\n   */\n  display_height_px: number;\n\n  /**\n   * The width of the display in pixels.\n   */\n  display_width_px: number;\n\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'computer';\n\n  type: 'computer_20251124';\n\n  allowed_callers?: Array<'direct' | 'code_execution_20250825'>;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * If true, tool will not be included in initial system prompt. Only loaded when\n   * returned via tool_reference from tool search.\n   */\n  defer_loading?: boolean;\n\n  /**\n   * The X11 display number (e.g. 0, 1) for the display.\n   */\n  display_number?: number | null;\n\n  /**\n   * Whether to enable an action to take a zoomed-in screenshot of the screen.\n   */\n  enable_zoom?: boolean;\n\n  input_examples?: Array<{ [key: string]: unknown }>;\n\n  strict?: boolean;\n}\n\nexport interface BetaToolReferenceBlock {\n  tool_name: string;\n\n  type: 'tool_reference';\n}\n\n/**\n * Tool reference block that can be included in tool_result content.\n */\nexport interface BetaToolReferenceBlockParam {\n  tool_name: string;\n\n  type: 'tool_reference';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n}\n\nexport interface BetaToolResultBlockParam {\n  tool_use_id: string;\n\n  type: 'tool_result';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  content?:\n    | string\n    | Array<\n        | BetaTextBlockParam\n        | BetaImageBlockParam\n        | BetaSearchResultBlockParam\n        | BetaRequestDocumentBlock\n        | BetaToolReferenceBlockParam\n      >;\n\n  is_error?: boolean;\n}\n\nexport interface BetaToolSearchToolBm25_20251119 {\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'tool_search_tool_bm25';\n\n  type: 'tool_search_tool_bm25_20251119' | 'tool_search_tool_bm25';\n\n  allowed_callers?: Array<'direct' | 'code_execution_20250825'>;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * If true, tool will not be included in initial system prompt. Only loaded when\n   * returned via tool_reference from tool search.\n   */\n  defer_loading?: boolean;\n\n  strict?: boolean;\n}\n\nexport interface BetaToolSearchToolRegex20251119 {\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'tool_search_tool_regex';\n\n  type: 'tool_search_tool_regex_20251119' | 'tool_search_tool_regex';\n\n  allowed_callers?: Array<'direct' | 'code_execution_20250825'>;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * If true, tool will not be included in initial system prompt. Only loaded when\n   * returned via tool_reference from tool search.\n   */\n  defer_loading?: boolean;\n\n  strict?: boolean;\n}\n\nexport interface BetaToolSearchToolResultBlock {\n  content: BetaToolSearchToolResultError | BetaToolSearchToolSearchResultBlock;\n\n  tool_use_id: string;\n\n  type: 'tool_search_tool_result';\n}\n\nexport interface BetaToolSearchToolResultBlockParam {\n  content: BetaToolSearchToolResultErrorParam | BetaToolSearchToolSearchResultBlockParam;\n\n  tool_use_id: string;\n\n  type: 'tool_search_tool_result';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n}\n\nexport interface BetaToolSearchToolResultError {\n  error_code: 'invalid_tool_input' | 'unavailable' | 'too_many_requests' | 'execution_time_exceeded';\n\n  error_message: string | null;\n\n  type: 'tool_search_tool_result_error';\n}\n\nexport interface BetaToolSearchToolResultErrorParam {\n  error_code: 'invalid_tool_input' | 'unavailable' | 'too_many_requests' | 'execution_time_exceeded';\n\n  type: 'tool_search_tool_result_error';\n}\n\nexport interface BetaToolSearchToolSearchResultBlock {\n  tool_references: Array<BetaToolReferenceBlock>;\n\n  type: 'tool_search_tool_search_result';\n}\n\nexport interface BetaToolSearchToolSearchResultBlockParam {\n  tool_references: Array<BetaToolReferenceBlockParam>;\n\n  type: 'tool_search_tool_search_result';\n}\n\nexport type BetaToolResultContentBlockParam = Extract<BetaToolResultBlockParam['content'], any[]>[number];\n\nexport interface BetaToolTextEditor20241022 {\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'str_replace_editor';\n\n  type: 'text_editor_20241022';\n\n  allowed_callers?: Array<'direct' | 'code_execution_20250825'>;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * If true, tool will not be included in initial system prompt. Only loaded when\n   * returned via tool_reference from tool search.\n   */\n  defer_loading?: boolean;\n\n  input_examples?: Array<{ [key: string]: unknown }>;\n\n  strict?: boolean;\n}\n\nexport interface BetaToolTextEditor20250124 {\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'str_replace_editor';\n\n  type: 'text_editor_20250124';\n\n  allowed_callers?: Array<'direct' | 'code_execution_20250825'>;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * If true, tool will not be included in initial system prompt. Only loaded when\n   * returned via tool_reference from tool search.\n   */\n  defer_loading?: boolean;\n\n  input_examples?: Array<{ [key: string]: unknown }>;\n\n  strict?: boolean;\n}\n\nexport interface BetaToolTextEditor20250429 {\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'str_replace_based_edit_tool';\n\n  type: 'text_editor_20250429';\n\n  allowed_callers?: Array<'direct' | 'code_execution_20250825'>;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * If true, tool will not be included in initial system prompt. Only loaded when\n   * returned via tool_reference from tool search.\n   */\n  defer_loading?: boolean;\n\n  input_examples?: Array<{ [key: string]: unknown }>;\n\n  strict?: boolean;\n}\n\nexport interface BetaToolTextEditor20250728 {\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'str_replace_based_edit_tool';\n\n  type: 'text_editor_20250728';\n\n  allowed_callers?: Array<'direct' | 'code_execution_20250825'>;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * If true, tool will not be included in initial system prompt. Only loaded when\n   * returned via tool_reference from tool search.\n   */\n  defer_loading?: boolean;\n\n  input_examples?: Array<{ [key: string]: unknown }>;\n\n  /**\n   * Maximum number of characters to display when viewing a file. If not specified,\n   * defaults to displaying the full file.\n   */\n  max_characters?: number | null;\n\n  strict?: boolean;\n}\n\n/**\n * Configuration for a group of tools from an MCP server.\n *\n * Allows configuring enabled status and defer_loading for all tools from an MCP\n * server, with optional per-tool overrides.\n */\nexport type BetaToolUnion =\n  | BetaTool\n  | BetaToolBash20241022\n  | BetaToolBash20250124\n  | BetaCodeExecutionTool20250522\n  | BetaCodeExecutionTool20250825\n  | BetaToolComputerUse20241022\n  | BetaMemoryTool20250818\n  | BetaToolComputerUse20250124\n  | BetaToolTextEditor20241022\n  | BetaToolComputerUse20251124\n  | BetaToolTextEditor20250124\n  | BetaToolTextEditor20250429\n  | BetaToolTextEditor20250728\n  | BetaWebSearchTool20250305\n  | BetaWebFetchTool20250910\n  | BetaToolSearchToolBm25_20251119\n  | BetaToolSearchToolRegex20251119\n  | BetaMCPToolset;\n\nexport interface BetaToolUseBlock {\n  id: string;\n\n  input: unknown;\n\n  name: string;\n\n  type: 'tool_use';\n\n  /**\n   * Tool invocation directly from the model.\n   */\n  caller?: BetaDirectCaller | BetaServerToolCaller;\n}\n\nexport interface BetaToolUseBlockParam {\n  id: string;\n\n  input: unknown;\n\n  name: string;\n\n  type: 'tool_use';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * Tool invocation directly from the model.\n   */\n  caller?: BetaDirectCaller | BetaServerToolCaller;\n}\n\nexport interface BetaToolUsesKeep {\n  type: 'tool_uses';\n\n  value: number;\n}\n\nexport interface BetaToolUsesTrigger {\n  type: 'tool_uses';\n\n  value: number;\n}\n\nexport interface BetaURLImageSource {\n  type: 'url';\n\n  url: string;\n}\n\nexport interface BetaURLPDFSource {\n  type: 'url';\n\n  url: string;\n}\n\nexport interface BetaUsage {\n  /**\n   * Breakdown of cached tokens by TTL\n   */\n  cache_creation: BetaCacheCreation | null;\n\n  /**\n   * The number of input tokens used to create the cache entry.\n   */\n  cache_creation_input_tokens: number | null;\n\n  /**\n   * The number of input tokens read from the cache.\n   */\n  cache_read_input_tokens: number | null;\n\n  /**\n   * The number of input tokens which were used.\n   */\n  input_tokens: number;\n\n  /**\n   * The number of output tokens which were used.\n   */\n  output_tokens: number;\n\n  /**\n   * The number of server tool requests.\n   */\n  server_tool_use: BetaServerToolUsage | null;\n\n  /**\n   * If the request used the priority, standard, or batch tier.\n   */\n  service_tier: 'standard' | 'priority' | 'batch' | null;\n}\n\nexport interface BetaWebFetchBlock {\n  content: BetaDocumentBlock;\n\n  /**\n   * ISO 8601 timestamp when the content was retrieved\n   */\n  retrieved_at: string | null;\n\n  type: 'web_fetch_result';\n\n  /**\n   * Fetched content URL\n   */\n  url: string;\n}\n\nexport interface BetaWebFetchBlockParam {\n  content: BetaRequestDocumentBlock;\n\n  type: 'web_fetch_result';\n\n  /**\n   * Fetched content URL\n   */\n  url: string;\n\n  /**\n   * ISO 8601 timestamp when the content was retrieved\n   */\n  retrieved_at?: string | null;\n}\n\nexport interface BetaWebFetchTool20250910 {\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'web_fetch';\n\n  type: 'web_fetch_20250910';\n\n  allowed_callers?: Array<'direct' | 'code_execution_20250825'>;\n\n  /**\n   * List of domains to allow fetching from\n   */\n  allowed_domains?: Array<string> | null;\n\n  /**\n   * List of domains to block fetching from\n   */\n  blocked_domains?: Array<string> | null;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * Citations configuration for fetched documents. Citations are disabled by\n   * default.\n   */\n  citations?: BetaCitationsConfigParam | null;\n\n  /**\n   * If true, tool will not be included in initial system prompt. Only loaded when\n   * returned via tool_reference from tool search.\n   */\n  defer_loading?: boolean;\n\n  /**\n   * Maximum number of tokens used by including web page text content in the context.\n   * The limit is approximate and does not apply to binary content such as PDFs.\n   */\n  max_content_tokens?: number | null;\n\n  /**\n   * Maximum number of times the tool can be used in the API request.\n   */\n  max_uses?: number | null;\n\n  strict?: boolean;\n}\n\nexport interface BetaWebFetchToolResultBlock {\n  content: BetaWebFetchToolResultErrorBlock | BetaWebFetchBlock;\n\n  tool_use_id: string;\n\n  type: 'web_fetch_tool_result';\n}\n\nexport interface BetaWebFetchToolResultBlockParam {\n  content: BetaWebFetchToolResultErrorBlockParam | BetaWebFetchBlockParam;\n\n  tool_use_id: string;\n\n  type: 'web_fetch_tool_result';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n}\n\nexport interface BetaWebFetchToolResultErrorBlock {\n  error_code: BetaWebFetchToolResultErrorCode;\n\n  type: 'web_fetch_tool_result_error';\n}\n\nexport interface BetaWebFetchToolResultErrorBlockParam {\n  error_code: BetaWebFetchToolResultErrorCode;\n\n  type: 'web_fetch_tool_result_error';\n}\n\nexport type BetaWebFetchToolResultErrorCode =\n  | 'invalid_tool_input'\n  | 'url_too_long'\n  | 'url_not_allowed'\n  | 'url_not_accessible'\n  | 'unsupported_content_type'\n  | 'too_many_requests'\n  | 'max_uses_exceeded'\n  | 'unavailable';\n\nexport interface BetaWebSearchResultBlock {\n  encrypted_content: string;\n\n  page_age: string | null;\n\n  title: string;\n\n  type: 'web_search_result';\n\n  url: string;\n}\n\nexport interface BetaWebSearchResultBlockParam {\n  encrypted_content: string;\n\n  title: string;\n\n  type: 'web_search_result';\n\n  url: string;\n\n  page_age?: string | null;\n}\n\nexport interface BetaWebSearchTool20250305 {\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'web_search';\n\n  type: 'web_search_20250305';\n\n  allowed_callers?: Array<'direct' | 'code_execution_20250825'>;\n\n  /**\n   * If provided, only these domains will be included in results. Cannot be used\n   * alongside `blocked_domains`.\n   */\n  allowed_domains?: Array<string> | null;\n\n  /**\n   * If provided, these domains will never appear in results. Cannot be used\n   * alongside `allowed_domains`.\n   */\n  blocked_domains?: Array<string> | null;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n\n  /**\n   * If true, tool will not be included in initial system prompt. Only loaded when\n   * returned via tool_reference from tool search.\n   */\n  defer_loading?: boolean;\n\n  /**\n   * Maximum number of times the tool can be used in the API request.\n   */\n  max_uses?: number | null;\n\n  strict?: boolean;\n\n  /**\n   * Parameters for the user's location. Used to provide more relevant search\n   * results.\n   */\n  user_location?: BetaWebSearchTool20250305.UserLocation | null;\n}\n\nexport namespace BetaWebSearchTool20250305 {\n  /**\n   * Parameters for the user's location. Used to provide more relevant search\n   * results.\n   */\n  export interface UserLocation {\n    type: 'approximate';\n\n    /**\n     * The city of the user.\n     */\n    city?: string | null;\n\n    /**\n     * The two letter\n     * [ISO country code](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2) of the\n     * user.\n     */\n    country?: string | null;\n\n    /**\n     * The region of the user.\n     */\n    region?: string | null;\n\n    /**\n     * The [IANA timezone](https://nodatime.org/TimeZones) of the user.\n     */\n    timezone?: string | null;\n  }\n}\n\nexport interface BetaWebSearchToolRequestError {\n  error_code: BetaWebSearchToolResultErrorCode;\n\n  type: 'web_search_tool_result_error';\n}\n\nexport interface BetaWebSearchToolResultBlock {\n  content: BetaWebSearchToolResultBlockContent;\n\n  tool_use_id: string;\n\n  type: 'web_search_tool_result';\n}\n\nexport type BetaWebSearchToolResultBlockContent =\n  | BetaWebSearchToolResultError\n  | Array<BetaWebSearchResultBlock>;\n\nexport interface BetaWebSearchToolResultBlockParam {\n  content: BetaWebSearchToolResultBlockParamContent;\n\n  tool_use_id: string;\n\n  type: 'web_search_tool_result';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: BetaCacheControlEphemeral | null;\n}\n\nexport type BetaWebSearchToolResultBlockParamContent =\n  | Array<BetaWebSearchResultBlockParam>\n  | BetaWebSearchToolRequestError;\n\nexport interface BetaWebSearchToolResultError {\n  error_code: BetaWebSearchToolResultErrorCode;\n\n  type: 'web_search_tool_result_error';\n}\n\nexport type BetaWebSearchToolResultErrorCode =\n  | 'invalid_tool_input'\n  | 'unavailable'\n  | 'max_uses_exceeded'\n  | 'too_many_requests'\n  | 'query_too_long';\n\n/**\n * @deprecated BetaRequestDocumentBlock should be used insated\n */\nexport type BetaBase64PDFBlock = BetaRequestDocumentBlock;\n\nexport type MessageCreateParams = MessageCreateParamsNonStreaming | MessageCreateParamsStreaming;\n\nexport interface MessageCreateParamsBase {\n  /**\n   * Body param: The maximum number of tokens to generate before stopping.\n   *\n   * Note that our models may stop _before_ reaching this maximum. This parameter\n   * only specifies the absolute maximum number of tokens to generate.\n   *\n   * Different models have different maximum values for this parameter. See\n   * [models](https://docs.claude.com/en/docs/models-overview) for details.\n   */\n  max_tokens: number;\n\n  /**\n   * Body param: Input messages.\n   *\n   * Our models are trained to operate on alternating `user` and `assistant`\n   * conversational turns. When creating a new `Message`, you specify the prior\n   * conversational turns with the `messages` parameter, and the model then generates\n   * the next `Message` in the conversation. Consecutive `user` or `assistant` turns\n   * in your request will be combined into a single turn.\n   *\n   * Each input message must be an object with a `role` and `content`. You can\n   * specify a single `user`-role message, or you can include multiple `user` and\n   * `assistant` messages.\n   *\n   * If the final message uses the `assistant` role, the response content will\n   * continue immediately from the content in that message. This can be used to\n   * constrain part of the model's response.\n   *\n   * Example with a single `user` message:\n   *\n   * ```json\n   * [{ \"role\": \"user\", \"content\": \"Hello, Claude\" }]\n   * ```\n   *\n   * Example with multiple conversational turns:\n   *\n   * ```json\n   * [\n   *   { \"role\": \"user\", \"content\": \"Hello there.\" },\n   *   { \"role\": \"assistant\", \"content\": \"Hi, I'm Claude. How can I help you?\" },\n   *   { \"role\": \"user\", \"content\": \"Can you explain LLMs in plain English?\" }\n   * ]\n   * ```\n   *\n   * Example with a partially-filled response from Claude:\n   *\n   * ```json\n   * [\n   *   {\n   *     \"role\": \"user\",\n   *     \"content\": \"What's the Greek name for Sun? (A) Sol (B) Helios (C) Sun\"\n   *   },\n   *   { \"role\": \"assistant\", \"content\": \"The best answer is (\" }\n   * ]\n   * ```\n   *\n   * Each input message `content` may be either a single `string` or an array of\n   * content blocks, where each block has a specific `type`. Using a `string` for\n   * `content` is shorthand for an array of one content block of type `\"text\"`. The\n   * following input messages are equivalent:\n   *\n   * ```json\n   * { \"role\": \"user\", \"content\": \"Hello, Claude\" }\n   * ```\n   *\n   * ```json\n   * { \"role\": \"user\", \"content\": [{ \"type\": \"text\", \"text\": \"Hello, Claude\" }] }\n   * ```\n   *\n   * See [input examples](https://docs.claude.com/en/api/messages-examples).\n   *\n   * Note that if you want to include a\n   * [system prompt](https://docs.claude.com/en/docs/system-prompts), you can use the\n   * top-level `system` parameter \u2014 there is no `\"system\"` role for input messages in\n   * the Messages API.\n   *\n   * There is a limit of 100,000 messages in a single request.\n   */\n  messages: Array<BetaMessageParam>;\n\n  /**\n   * Body param: The model that will complete your prompt.\\n\\nSee\n   * [models](https://docs.anthropic.com/en/docs/models-overview) for additional\n   * details and options.\n   */\n  model: MessagesAPI.Model;\n\n  /**\n   * Body param: Container identifier for reuse across requests.\n   */\n  container?: BetaContainerParams | string | null;\n\n  /**\n   * Body param: Context management configuration.\n   *\n   * This allows you to control how Claude manages context across multiple requests,\n   * such as whether to clear function results or not.\n   */\n  context_management?: BetaContextManagementConfig | null;\n\n  /**\n   * Body param: MCP servers to be utilized in this request\n   */\n  mcp_servers?: Array<BetaRequestMCPServerURLDefinition>;\n\n  /**\n   * Body param: An object describing metadata about the request.\n   */\n  metadata?: BetaMetadata;\n\n  /**\n   * Body param: Configuration options for the model's output. Controls aspects like\n   * how much effort the model puts into its response.\n   */\n  output_config?: BetaOutputConfig;\n\n  /**\n   * Body param: A schema to specify Claude's output format in responses.\n   */\n  output_format?: BetaJSONOutputFormat | null;\n\n  /**\n   * Body param: Determines whether to use priority capacity (if available) or\n   * standard capacity for this request.\n   *\n   * Anthropic offers different levels of service for your API requests. See\n   * [service-tiers](https://docs.claude.com/en/api/service-tiers) for details.\n   */\n  service_tier?: 'auto' | 'standard_only';\n\n  /**\n   * Body param: Custom text sequences that will cause the model to stop generating.\n   *\n   * Our models will normally stop when they have naturally completed their turn,\n   * which will result in a response `stop_reason` of `\"end_turn\"`.\n   *\n   * If you want the model to stop generating when it encounters custom strings of\n   * text, you can use the `stop_sequences` parameter. If the model encounters one of\n   * the custom sequences, the response `stop_reason` value will be `\"stop_sequence\"`\n   * and the response `stop_sequence` value will contain the matched stop sequence.\n   */\n  stop_sequences?: Array<string>;\n\n  /**\n   * Body param: Whether to incrementally stream the response using server-sent\n   * events.\n   *\n   * See [streaming](https://docs.claude.com/en/api/messages-streaming) for details.\n   */\n  stream?: boolean;\n\n  /**\n   * Body param: System prompt.\n   *\n   * A system prompt is a way of providing context and instructions to Claude, such\n   * as specifying a particular goal or role. See our\n   * [guide to system prompts](https://docs.claude.com/en/docs/system-prompts).\n   */\n  system?: string | Array<BetaTextBlockParam>;\n\n  /**\n   * Body param: Amount of randomness injected into the response.\n   *\n   * Defaults to `1.0`. Ranges from `0.0` to `1.0`. Use `temperature` closer to `0.0`\n   * for analytical / multiple choice, and closer to `1.0` for creative and\n   * generative tasks.\n   *\n   * Note that even with `temperature` of `0.0`, the results will not be fully\n   * deterministic.\n   */\n  temperature?: number;\n\n  /**\n   * Body param: Configuration for enabling Claude's extended thinking.\n   *\n   * When enabled, responses include `thinking` content blocks showing Claude's\n   * thinking process before the final answer. Requires a minimum budget of 1,024\n   * tokens and counts towards your `max_tokens` limit.\n   *\n   * See\n   * [extended thinking](https://docs.claude.com/en/docs/build-with-claude/extended-thinking)\n   * for details.\n   */\n  thinking?: BetaThinkingConfigParam;\n\n  /**\n   * Body param: How the model should use the provided tools. The model can use a\n   * specific tool, any available tool, decide by itself, or not use tools at all.\n   */\n  tool_choice?: BetaToolChoice;\n\n  /**\n   * Body param: Definitions of tools that the model may use.\n   *\n   * If you include `tools` in your API request, the model may return `tool_use`\n   * content blocks that represent the model's use of those tools. You can then run\n   * those tools using the tool input generated by the model and then optionally\n   * return results back to the model using `tool_result` content blocks.\n   *\n   * There are two types of tools: **client tools** and **server tools**. The\n   * behavior described below applies to client tools. For\n   * [server tools](https://docs.claude.com/en/docs/agents-and-tools/tool-use/overview#server-tools),\n   * see their individual documentation as each has its own behavior (e.g., the\n   * [web search tool](https://docs.claude.com/en/docs/agents-and-tools/tool-use/web-search-tool)).\n   *\n   * Each tool definition includes:\n   *\n   * - `name`: Name of the tool.\n   * - `description`: Optional, but strongly-recommended description of the tool.\n   * - `input_schema`: [JSON schema](https://json-schema.org/draft/2020-12) for the\n   *   tool `input` shape that the model will produce in `tool_use` output content\n   *   blocks.\n   *\n   * For example, if you defined `tools` as:\n   *\n   * ```json\n   * [\n   *   {\n   *     \"name\": \"get_stock_price\",\n   *     \"description\": \"Get the current stock price for a given ticker symbol.\",\n   *     \"input_schema\": {\n   *       \"type\": \"object\",\n   *       \"properties\": {\n   *         \"ticker\": {\n   *           \"type\": \"string\",\n   *           \"description\": \"The stock ticker symbol, e.g. AAPL for Apple Inc.\"\n   *         }\n   *       },\n   *       \"required\": [\"ticker\"]\n   *     }\n   *   }\n   * ]\n   * ```\n   *\n   * And then asked the model \"What's the S&P 500 at today?\", the model might produce\n   * `tool_use` content blocks in the response like this:\n   *\n   * ```json\n   * [\n   *   {\n   *     \"type\": \"tool_use\",\n   *     \"id\": \"toolu_01D7FLrfh4GYq7yT1ULFeyMV\",\n   *     \"name\": \"get_stock_price\",\n   *     \"input\": { \"ticker\": \"^GSPC\" }\n   *   }\n   * ]\n   * ```\n   *\n   * You might then run your `get_stock_price` tool with `{\"ticker\": \"^GSPC\"}` as an\n   * input, and return the following back to the model in a subsequent `user`\n   * message:\n   *\n   * ```json\n   * [\n   *   {\n   *     \"type\": \"tool_result\",\n   *     \"tool_use_id\": \"toolu_01D7FLrfh4GYq7yT1ULFeyMV\",\n   *     \"content\": \"259.75 USD\"\n   *   }\n   * ]\n   * ```\n   *\n   * Tools can be used for workflows that include running client-side tools and\n   * functions, or more generally whenever you want the model to produce a particular\n   * JSON structure of output.\n   *\n   * See our [guide](https://docs.claude.com/en/docs/tool-use) for more details.\n   */\n  tools?: Array<BetaToolUnion>;\n\n  /**\n   * Body param: Only sample from the top K options for each subsequent token.\n   *\n   * Used to remove \"long tail\" low probability responses.\n   * [Learn more technical details here](https://towardsdatascience.com/how-to-sample-from-language-models-682bceb97277).\n   *\n   * Recommended for advanced use cases only. You usually only need to use\n   * `temperature`.\n   */\n  top_k?: number;\n\n  /**\n   * Body param: Use nucleus sampling.\n   *\n   * In nucleus sampling, we compute the cumulative distribution over all the options\n   * for each subsequent token in decreasing probability order and cut it off once it\n   * reaches a particular probability specified by `top_p`. You should either alter\n   * `temperature` or `top_p`, but not both.\n   *\n   * Recommended for advanced use cases only. You usually only need to use\n   * `temperature`.\n   */\n  top_p?: number;\n\n  /**\n   * Header param: Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport namespace MessageCreateParams {\n  export type MessageCreateParamsNonStreaming = MessagesMessagesAPI.MessageCreateParamsNonStreaming;\n  export type MessageCreateParamsStreaming = MessagesMessagesAPI.MessageCreateParamsStreaming;\n}\n\nexport interface MessageCreateParamsNonStreaming extends MessageCreateParamsBase {\n  /**\n   * Body param: Whether to incrementally stream the response using server-sent\n   * events.\n   *\n   * See [streaming](https://docs.claude.com/en/api/messages-streaming) for details.\n   */\n  stream?: false;\n}\n\nexport interface MessageCreateParamsStreaming extends MessageCreateParamsBase {\n  /**\n   * Body param: Whether to incrementally stream the response using server-sent\n   * events.\n   *\n   * See [streaming](https://docs.claude.com/en/api/messages-streaming) for details.\n   */\n  stream: true;\n}\n\nexport interface MessageCountTokensParams {\n  /**\n   * Body param: Input messages.\n   *\n   * Our models are trained to operate on alternating `user` and `assistant`\n   * conversational turns. When creating a new `Message`, you specify the prior\n   * conversational turns with the `messages` parameter, and the model then generates\n   * the next `Message` in the conversation. Consecutive `user` or `assistant` turns\n   * in your request will be combined into a single turn.\n   *\n   * Each input message must be an object with a `role` and `content`. You can\n   * specify a single `user`-role message, or you can include multiple `user` and\n   * `assistant` messages.\n   *\n   * If the final message uses the `assistant` role, the response content will\n   * continue immediately from the content in that message. This can be used to\n   * constrain part of the model's response.\n   *\n   * Example with a single `user` message:\n   *\n   * ```json\n   * [{ \"role\": \"user\", \"content\": \"Hello, Claude\" }]\n   * ```\n   *\n   * Example with multiple conversational turns:\n   *\n   * ```json\n   * [\n   *   { \"role\": \"user\", \"content\": \"Hello there.\" },\n   *   { \"role\": \"assistant\", \"content\": \"Hi, I'm Claude. How can I help you?\" },\n   *   { \"role\": \"user\", \"content\": \"Can you explain LLMs in plain English?\" }\n   * ]\n   * ```\n   *\n   * Example with a partially-filled response from Claude:\n   *\n   * ```json\n   * [\n   *   {\n   *     \"role\": \"user\",\n   *     \"content\": \"What's the Greek name for Sun? (A) Sol (B) Helios (C) Sun\"\n   *   },\n   *   { \"role\": \"assistant\", \"content\": \"The best answer is (\" }\n   * ]\n   * ```\n   *\n   * Each input message `content` may be either a single `string` or an array of\n   * content blocks, where each block has a specific `type`. Using a `string` for\n   * `content` is shorthand for an array of one content block of type `\"text\"`. The\n   * following input messages are equivalent:\n   *\n   * ```json\n   * { \"role\": \"user\", \"content\": \"Hello, Claude\" }\n   * ```\n   *\n   * ```json\n   * { \"role\": \"user\", \"content\": [{ \"type\": \"text\", \"text\": \"Hello, Claude\" }] }\n   * ```\n   *\n   * See [input examples](https://docs.claude.com/en/api/messages-examples).\n   *\n   * Note that if you want to include a\n   * [system prompt](https://docs.claude.com/en/docs/system-prompts), you can use the\n   * top-level `system` parameter \u2014 there is no `\"system\"` role for input messages in\n   * the Messages API.\n   *\n   * There is a limit of 100,000 messages in a single request.\n   */\n  messages: Array<BetaMessageParam>;\n\n  /**\n   * Body param: The model that will complete your prompt.\\n\\nSee\n   * [models](https://docs.anthropic.com/en/docs/models-overview) for additional\n   * details and options.\n   */\n  model: MessagesAPI.Model;\n\n  /**\n   * Body param: Context management configuration.\n   *\n   * This allows you to control how Claude manages context across multiple requests,\n   * such as whether to clear function results or not.\n   */\n  context_management?: BetaContextManagementConfig | null;\n\n  /**\n   * Body param: MCP servers to be utilized in this request\n   */\n  mcp_servers?: Array<BetaRequestMCPServerURLDefinition>;\n\n  /**\n   * Body param: Configuration options for the model's output. Controls aspects like\n   * how much effort the model puts into its response.\n   */\n  output_config?: BetaOutputConfig;\n\n  /**\n   * Body param: A schema to specify Claude's output format in responses.\n   */\n  output_format?: BetaJSONOutputFormat | null;\n\n  /**\n   * Body param: System prompt.\n   *\n   * A system prompt is a way of providing context and instructions to Claude, such\n   * as specifying a particular goal or role. See our\n   * [guide to system prompts](https://docs.claude.com/en/docs/system-prompts).\n   */\n  system?: string | Array<BetaTextBlockParam>;\n\n  /**\n   * Body param: Configuration for enabling Claude's extended thinking.\n   *\n   * When enabled, responses include `thinking` content blocks showing Claude's\n   * thinking process before the final answer. Requires a minimum budget of 1,024\n   * tokens and counts towards your `max_tokens` limit.\n   *\n   * See\n   * [extended thinking](https://docs.claude.com/en/docs/build-with-claude/extended-thinking)\n   * for details.\n   */\n  thinking?: BetaThinkingConfigParam;\n\n  /**\n   * Body param: How the model should use the provided tools. The model can use a\n   * specific tool, any available tool, decide by itself, or not use tools at all.\n   */\n  tool_choice?: BetaToolChoice;\n\n  /**\n   * Body param: Definitions of tools that the model may use.\n   *\n   * If you include `tools` in your API request, the model may return `tool_use`\n   * content blocks that represent the model's use of those tools. You can then run\n   * those tools using the tool input generated by the model and then optionally\n   * return results back to the model using `tool_result` content blocks.\n   *\n   * There are two types of tools: **client tools** and **server tools**. The\n   * behavior described below applies to client tools. For\n   * [server tools](https://docs.claude.com/en/docs/agents-and-tools/tool-use/overview#server-tools),\n   * see their individual documentation as each has its own behavior (e.g., the\n   * [web search tool](https://docs.claude.com/en/docs/agents-and-tools/tool-use/web-search-tool)).\n   *\n   * Each tool definition includes:\n   *\n   * - `name`: Name of the tool.\n   * - `description`: Optional, but strongly-recommended description of the tool.\n   * - `input_schema`: [JSON schema](https://json-schema.org/draft/2020-12) for the\n   *   tool `input` shape that the model will produce in `tool_use` output content\n   *   blocks.\n   *\n   * For example, if you defined `tools` as:\n   *\n   * ```json\n   * [\n   *   {\n   *     \"name\": \"get_stock_price\",\n   *     \"description\": \"Get the current stock price for a given ticker symbol.\",\n   *     \"input_schema\": {\n   *       \"type\": \"object\",\n   *       \"properties\": {\n   *         \"ticker\": {\n   *           \"type\": \"string\",\n   *           \"description\": \"The stock ticker symbol, e.g. AAPL for Apple Inc.\"\n   *         }\n   *       },\n   *       \"required\": [\"ticker\"]\n   *     }\n   *   }\n   * ]\n   * ```\n   *\n   * And then asked the model \"What's the S&P 500 at today?\", the model might produce\n   * `tool_use` content blocks in the response like this:\n   *\n   * ```json\n   * [\n   *   {\n   *     \"type\": \"tool_use\",\n   *     \"id\": \"toolu_01D7FLrfh4GYq7yT1ULFeyMV\",\n   *     \"name\": \"get_stock_price\",\n   *     \"input\": { \"ticker\": \"^GSPC\" }\n   *   }\n   * ]\n   * ```\n   *\n   * You might then run your `get_stock_price` tool with `{\"ticker\": \"^GSPC\"}` as an\n   * input, and return the following back to the model in a subsequent `user`\n   * message:\n   *\n   * ```json\n   * [\n   *   {\n   *     \"type\": \"tool_result\",\n   *     \"tool_use_id\": \"toolu_01D7FLrfh4GYq7yT1ULFeyMV\",\n   *     \"content\": \"259.75 USD\"\n   *   }\n   * ]\n   * ```\n   *\n   * Tools can be used for workflows that include running client-side tools and\n   * functions, or more generally whenever you want the model to produce a particular\n   * JSON structure of output.\n   *\n   * See our [guide](https://docs.claude.com/en/docs/tool-use) for more details.\n   */\n  tools?: Array<\n    | BetaTool\n    | BetaToolBash20241022\n    | BetaToolBash20250124\n    | BetaCodeExecutionTool20250522\n    | BetaCodeExecutionTool20250825\n    | BetaToolComputerUse20241022\n    | BetaMemoryTool20250818\n    | BetaToolComputerUse20250124\n    | BetaToolTextEditor20241022\n    | BetaToolComputerUse20251124\n    | BetaToolTextEditor20250124\n    | BetaToolTextEditor20250429\n    | BetaToolTextEditor20250728\n    | BetaWebSearchTool20250305\n    | BetaWebFetchTool20250910\n    | BetaToolSearchToolBm25_20251119\n    | BetaToolSearchToolRegex20251119\n    | BetaMCPToolset\n  >;\n\n  /**\n   * Header param: Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport { BetaToolRunner, type BetaToolRunnerParams } from '../../../lib/tools/BetaToolRunner';\n\nMessages.Batches = Batches;\n\nMessages.BetaToolRunner = BetaToolRunner;\n\nexport declare namespace Messages {\n  export {\n    type BetaAllThinkingTurns as BetaAllThinkingTurns,\n    type BetaBase64ImageSource as BetaBase64ImageSource,\n    type BetaBase64PDFSource as BetaBase64PDFSource,\n    type BetaBashCodeExecutionOutputBlock as BetaBashCodeExecutionOutputBlock,\n    type BetaBashCodeExecutionOutputBlockParam as BetaBashCodeExecutionOutputBlockParam,\n    type BetaBashCodeExecutionResultBlock as BetaBashCodeExecutionResultBlock,\n    type BetaBashCodeExecutionResultBlockParam as BetaBashCodeExecutionResultBlockParam,\n    type BetaBashCodeExecutionToolResultBlock as BetaBashCodeExecutionToolResultBlock,\n    type BetaBashCodeExecutionToolResultBlockParam as BetaBashCodeExecutionToolResultBlockParam,\n    type BetaBashCodeExecutionToolResultError as BetaBashCodeExecutionToolResultError,\n    type BetaBashCodeExecutionToolResultErrorParam as BetaBashCodeExecutionToolResultErrorParam,\n    type BetaCacheControlEphemeral as BetaCacheControlEphemeral,\n    type BetaCacheCreation as BetaCacheCreation,\n    type BetaCitationCharLocation as BetaCitationCharLocation,\n    type BetaCitationCharLocationParam as BetaCitationCharLocationParam,\n    type BetaCitationConfig as BetaCitationConfig,\n    type BetaCitationContentBlockLocation as BetaCitationContentBlockLocation,\n    type BetaCitationContentBlockLocationParam as BetaCitationContentBlockLocationParam,\n    type BetaCitationPageLocation as BetaCitationPageLocation,\n    type BetaCitationPageLocationParam as BetaCitationPageLocationParam,\n    type BetaCitationSearchResultLocation as BetaCitationSearchResultLocation,\n    type BetaCitationSearchResultLocationParam as BetaCitationSearchResultLocationParam,\n    type BetaCitationWebSearchResultLocationParam as BetaCitationWebSearchResultLocationParam,\n    type BetaCitationsConfigParam as BetaCitationsConfigParam,\n    type BetaCitationsDelta as BetaCitationsDelta,\n    type BetaCitationsWebSearchResultLocation as BetaCitationsWebSearchResultLocation,\n    type BetaClearThinking20251015Edit as BetaClearThinking20251015Edit,\n    type BetaClearThinking20251015EditResponse as BetaClearThinking20251015EditResponse,\n    type BetaClearToolUses20250919Edit as BetaClearToolUses20250919Edit,\n    type BetaClearToolUses20250919EditResponse as BetaClearToolUses20250919EditResponse,\n    type BetaCodeExecutionOutputBlock as BetaCodeExecutionOutputBlock,\n    type BetaCodeExecutionOutputBlockParam as BetaCodeExecutionOutputBlockParam,\n    type BetaCodeExecutionResultBlock as BetaCodeExecutionResultBlock,\n    type BetaCodeExecutionResultBlockParam as BetaCodeExecutionResultBlockParam,\n    type BetaCodeExecutionTool20250522 as BetaCodeExecutionTool20250522,\n    type BetaCodeExecutionTool20250825 as BetaCodeExecutionTool20250825,\n    type BetaCodeExecutionToolResultBlock as BetaCodeExecutionToolResultBlock,\n    type BetaCodeExecutionToolResultBlockContent as BetaCodeExecutionToolResultBlockContent,\n    type BetaCodeExecutionToolResultBlockParam as BetaCodeExecutionToolResultBlockParam,\n    type BetaCodeExecutionToolResultBlockParamContent as BetaCodeExecutionToolResultBlockParamContent,\n    type BetaCodeExecutionToolResultError as BetaCodeExecutionToolResultError,\n    type BetaCodeExecutionToolResultErrorCode as BetaCodeExecutionToolResultErrorCode,\n    type BetaCodeExecutionToolResultErrorParam as BetaCodeExecutionToolResultErrorParam,\n    type BetaContainer as BetaContainer,\n    type BetaContainerParams as BetaContainerParams,\n    type BetaContainerUploadBlock as BetaContainerUploadBlock,\n    type BetaContainerUploadBlockParam as BetaContainerUploadBlockParam,\n    type BetaContentBlock as BetaContentBlock,\n    type BetaContentBlockParam as BetaContentBlockParam,\n    type BetaContentBlockSource as BetaContentBlockSource,\n    type BetaContentBlockSourceContent as BetaContentBlockSourceContent,\n    type BetaContextManagementConfig as BetaContextManagementConfig,\n    type BetaContextManagementResponse as BetaContextManagementResponse,\n    type BetaCountTokensContextManagementResponse as BetaCountTokensContextManagementResponse,\n    type BetaDirectCaller as BetaDirectCaller,\n    type BetaDocumentBlock as BetaDocumentBlock,\n    type BetaFileDocumentSource as BetaFileDocumentSource,\n    type BetaFileImageSource as BetaFileImageSource,\n    type BetaImageBlockParam as BetaImageBlockParam,\n    type BetaInputJSONDelta as BetaInputJSONDelta,\n    type BetaInputTokensClearAtLeast as BetaInputTokensClearAtLeast,\n    type BetaInputTokensTrigger as BetaInputTokensTrigger,\n    type BetaJSONOutputFormat as BetaJSONOutputFormat,\n    type BetaMCPToolConfig as BetaMCPToolConfig,\n    type BetaMCPToolDefaultConfig as BetaMCPToolDefaultConfig,\n    type BetaMCPToolResultBlock as BetaMCPToolResultBlock,\n    type BetaMCPToolUseBlock as BetaMCPToolUseBlock,\n    type BetaMCPToolUseBlockParam as BetaMCPToolUseBlockParam,\n    type BetaMCPToolset as BetaMCPToolset,\n    type BetaMemoryTool20250818 as BetaMemoryTool20250818,\n    type BetaMemoryTool20250818Command as BetaMemoryTool20250818Command,\n    type BetaMemoryTool20250818CreateCommand as BetaMemoryTool20250818CreateCommand,\n    type BetaMemoryTool20250818DeleteCommand as BetaMemoryTool20250818DeleteCommand,\n    type BetaMemoryTool20250818InsertCommand as BetaMemoryTool20250818InsertCommand,\n    type BetaMemoryTool20250818RenameCommand as BetaMemoryTool20250818RenameCommand,\n    type BetaMemoryTool20250818StrReplaceCommand as BetaMemoryTool20250818StrReplaceCommand,\n    type BetaMemoryTool20250818ViewCommand as BetaMemoryTool20250818ViewCommand,\n    type BetaMessage as BetaMessage,\n    type BetaMessageDeltaUsage as BetaMessageDeltaUsage,\n    type BetaMessageParam as BetaMessageParam,\n    type BetaMessageTokensCount as BetaMessageTokensCount,\n    type BetaMetadata as BetaMetadata,\n    type BetaOutputConfig as BetaOutputConfig,\n    type BetaPlainTextSource as BetaPlainTextSource,\n    type BetaRawContentBlockDelta as BetaRawContentBlockDelta,\n    type BetaRawContentBlockDeltaEvent as BetaRawContentBlockDeltaEvent,\n    type BetaRawContentBlockStartEvent as BetaRawContentBlockStartEvent,\n    type BetaRawContentBlockStopEvent as BetaRawContentBlockStopEvent,\n    type BetaRawMessageDeltaEvent as BetaRawMessageDeltaEvent,\n    type BetaRawMessageStartEvent as BetaRawMessageStartEvent,\n    type BetaRawMessageStopEvent as BetaRawMessageStopEvent,\n    type BetaRawMessageStreamEvent as BetaRawMessageStreamEvent,\n    type BetaRedactedThinkingBlock as BetaRedactedThinkingBlock,\n    type BetaRedactedThinkingBlockParam as BetaRedactedThinkingBlockParam,\n    type BetaRequestDocumentBlock as BetaRequestDocumentBlock,\n    type BetaRequestMCPServerToolConfiguration as BetaRequestMCPServerToolConfiguration,\n    type BetaRequestMCPServerURLDefinition as BetaRequestMCPServerURLDefinition,\n    type BetaRequestMCPToolResultBlockParam as BetaRequestMCPToolResultBlockParam,\n    type BetaSearchResultBlockParam as BetaSearchResultBlockParam,\n    type BetaServerToolCaller as BetaServerToolCaller,\n    type BetaServerToolUsage as BetaServerToolUsage,\n    type BetaServerToolUseBlock as BetaServerToolUseBlock,\n    type BetaServerToolUseBlockParam as BetaServerToolUseBlockParam,\n    type BetaSignatureDelta as BetaSignatureDelta,\n    type BetaSkill as BetaSkill,\n    type BetaSkillParams as BetaSkillParams,\n    type BetaStopReason as BetaStopReason,\n    type BetaTextBlock as BetaTextBlock,\n    type BetaTextBlockParam as BetaTextBlockParam,\n    type BetaTextCitation as BetaTextCitation,\n    type BetaTextCitationParam as BetaTextCitationParam,\n    type BetaTextDelta as BetaTextDelta,\n    type BetaTextEditorCodeExecutionCreateResultBlock as BetaTextEditorCodeExecutionCreateResultBlock,\n    type BetaTextEditorCodeExecutionCreateResultBlockParam as BetaTextEditorCodeExecutionCreateResultBlockParam,\n    type BetaTextEditorCodeExecutionStrReplaceResultBlock as BetaTextEditorCodeExecutionStrReplaceResultBlock,\n    type BetaTextEditorCodeExecutionStrReplaceResultBlockParam as BetaTextEditorCodeExecutionStrReplaceResultBlockParam,\n    type BetaTextEditorCodeExecutionToolResultBlock as BetaTextEditorCodeExecutionToolResultBlock,\n    type BetaTextEditorCodeExecutionToolResultBlockParam as BetaTextEditorCodeExecutionToolResultBlockParam,\n    type BetaTextEditorCodeExecutionToolResultError as BetaTextEditorCodeExecutionToolResultError,\n    type BetaTextEditorCodeExecutionToolResultErrorParam as BetaTextEditorCodeExecutionToolResultErrorParam,\n    type BetaTextEditorCodeExecutionViewResultBlock as BetaTextEditorCodeExecutionViewResultBlock,\n    type BetaTextEditorCodeExecutionViewResultBlockParam as BetaTextEditorCodeExecutionViewResultBlockParam,\n    type BetaThinkingBlock as BetaThinkingBlock,\n    type BetaThinkingBlockParam as BetaThinkingBlockParam,\n    type BetaThinkingConfigDisabled as BetaThinkingConfigDisabled,\n    type BetaThinkingConfigEnabled as BetaThinkingConfigEnabled,\n    type BetaThinkingConfigParam as BetaThinkingConfigParam,\n    type BetaThinkingDelta as BetaThinkingDelta,\n    type BetaThinkingTurns as BetaThinkingTurns,\n    type BetaTool as BetaTool,\n    type BetaToolBash20241022 as BetaToolBash20241022,\n    type BetaToolBash20250124 as BetaToolBash20250124,\n    type BetaToolChoice as BetaToolChoice,\n    type BetaToolChoiceAny as BetaToolChoiceAny,\n    type BetaToolChoiceAuto as BetaToolChoiceAuto,\n    type BetaToolChoiceNone as BetaToolChoiceNone,\n    type BetaToolChoiceTool as BetaToolChoiceTool,\n    type BetaToolComputerUse20241022 as BetaToolComputerUse20241022,\n    type BetaToolComputerUse20250124 as BetaToolComputerUse20250124,\n    type BetaToolComputerUse20251124 as BetaToolComputerUse20251124,\n    type BetaToolReferenceBlock as BetaToolReferenceBlock,\n    type BetaToolReferenceBlockParam as BetaToolReferenceBlockParam,\n    type BetaToolResultBlockParam as BetaToolResultBlockParam,\n    type BetaToolResultContentBlockParam as BetaToolResultContentBlockParam,\n    type BetaToolSearchToolBm25_20251119 as BetaToolSearchToolBm25_20251119,\n    type BetaToolSearchToolRegex20251119 as BetaToolSearchToolRegex20251119,\n    type BetaToolSearchToolResultBlock as BetaToolSearchToolResultBlock,\n    type BetaToolSearchToolResultBlockParam as BetaToolSearchToolResultBlockParam,\n    type BetaToolSearchToolResultError as BetaToolSearchToolResultError,\n    type BetaToolSearchToolResultErrorParam as BetaToolSearchToolResultErrorParam,\n    type BetaToolSearchToolSearchResultBlock as BetaToolSearchToolSearchResultBlock,\n    type BetaToolSearchToolSearchResultBlockParam as BetaToolSearchToolSearchResultBlockParam,\n    type BetaToolTextEditor20241022 as BetaToolTextEditor20241022,\n    type BetaToolTextEditor20250124 as BetaToolTextEditor20250124,\n    type BetaToolTextEditor20250429 as BetaToolTextEditor20250429,\n    type BetaToolTextEditor20250728 as BetaToolTextEditor20250728,\n    type BetaToolUnion as BetaToolUnion,\n    type BetaToolUseBlock as BetaToolUseBlock,\n    type BetaToolUseBlockParam as BetaToolUseBlockParam,\n    type BetaToolUsesKeep as BetaToolUsesKeep,\n    type BetaToolUsesTrigger as BetaToolUsesTrigger,\n    type BetaURLImageSource as BetaURLImageSource,\n    type BetaURLPDFSource as BetaURLPDFSource,\n    type BetaUsage as BetaUsage,\n    type BetaWebFetchBlock as BetaWebFetchBlock,\n    type BetaWebFetchBlockParam as BetaWebFetchBlockParam,\n    type BetaWebFetchTool20250910 as BetaWebFetchTool20250910,\n    type BetaWebFetchToolResultBlock as BetaWebFetchToolResultBlock,\n    type BetaWebFetchToolResultBlockParam as BetaWebFetchToolResultBlockParam,\n    type BetaWebFetchToolResultErrorBlock as BetaWebFetchToolResultErrorBlock,\n    type BetaWebFetchToolResultErrorBlockParam as BetaWebFetchToolResultErrorBlockParam,\n    type BetaWebFetchToolResultErrorCode as BetaWebFetchToolResultErrorCode,\n    type BetaWebSearchResultBlock as BetaWebSearchResultBlock,\n    type BetaWebSearchResultBlockParam as BetaWebSearchResultBlockParam,\n    type BetaWebSearchTool20250305 as BetaWebSearchTool20250305,\n    type BetaWebSearchToolRequestError as BetaWebSearchToolRequestError,\n    type BetaWebSearchToolResultBlock as BetaWebSearchToolResultBlock,\n    type BetaWebSearchToolResultBlockContent as BetaWebSearchToolResultBlockContent,\n    type BetaWebSearchToolResultBlockParam as BetaWebSearchToolResultBlockParam,\n    type BetaWebSearchToolResultBlockParamContent as BetaWebSearchToolResultBlockParamContent,\n    type BetaWebSearchToolResultError as BetaWebSearchToolResultError,\n    type BetaWebSearchToolResultErrorCode as BetaWebSearchToolResultErrorCode,\n    type BetaBase64PDFBlock as BetaBase64PDFBlock,\n    type MessageCreateParams as MessageCreateParams,\n    type MessageCreateParamsNonStreaming as MessageCreateParamsNonStreaming,\n    type MessageCreateParamsStreaming as MessageCreateParamsStreaming,\n    type MessageCountTokensParams as MessageCountTokensParams,\n  };\n\n  export { type BetaToolRunnerParams, BetaToolRunner };\n\n  export {\n    Batches as Batches,\n    type BetaDeletedMessageBatch as BetaDeletedMessageBatch,\n    type BetaMessageBatch as BetaMessageBatch,\n    type BetaMessageBatchCanceledResult as BetaMessageBatchCanceledResult,\n    type BetaMessageBatchErroredResult as BetaMessageBatchErroredResult,\n    type BetaMessageBatchExpiredResult as BetaMessageBatchExpiredResult,\n    type BetaMessageBatchIndividualResponse as BetaMessageBatchIndividualResponse,\n    type BetaMessageBatchRequestCounts as BetaMessageBatchRequestCounts,\n    type BetaMessageBatchResult as BetaMessageBatchResult,\n    type BetaMessageBatchSucceededResult as BetaMessageBatchSucceededResult,\n    type BetaMessageBatchesPage as BetaMessageBatchesPage,\n    type BatchCreateParams as BatchCreateParams,\n    type BatchRetrieveParams as BatchRetrieveParams,\n    type BatchListParams as BatchListParams,\n    type BatchDeleteParams as BatchDeleteParams,\n    type BatchCancelParams as BatchCancelParams,\n    type BatchResultsParams as BatchResultsParams,\n  };\n}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { APIResource } from '../../../core/resource';\nimport * as BetaAPI from '../beta';\nimport { APIPromise } from '../../../core/api-promise';\nimport { PageCursor, type PageCursorParams, PagePromise } from '../../../core/pagination';\nimport { type Uploadable } from '../../../core/uploads';\nimport { buildHeaders } from '../../../internal/headers';\nimport { RequestOptions } from '../../../internal/request-options';\nimport { multipartFormRequestOptions } from '../../../internal/uploads';\nimport { path } from '../../../internal/utils/path';\n\nexport class Versions extends APIResource {\n  /**\n   * Create Skill Version\n   *\n   * @example\n   * ```ts\n   * const version = await client.beta.skills.versions.create(\n   *   'skill_id',\n   * );\n   * ```\n   */\n  create(\n    skillID: string,\n    params: VersionCreateParams | null | undefined = {},\n    options?: RequestOptions,\n  ): APIPromise<VersionCreateResponse> {\n    const { betas, ...body } = params ?? {};\n    return this._client.post(\n      path`/v1/skills/${skillID}/versions?beta=true`,\n      multipartFormRequestOptions(\n        {\n          body,\n          ...options,\n          headers: buildHeaders([\n            { 'anthropic-beta': [...(betas ?? []), 'skills-2025-10-02'].toString() },\n            options?.headers,\n          ]),\n        },\n        this._client,\n      ),\n    );\n  }\n\n  /**\n   * Get Skill Version\n   *\n   * @example\n   * ```ts\n   * const version = await client.beta.skills.versions.retrieve(\n   *   'version',\n   *   { skill_id: 'skill_id' },\n   * );\n   * ```\n   */\n  retrieve(\n    version: string,\n    params: VersionRetrieveParams,\n    options?: RequestOptions,\n  ): APIPromise<VersionRetrieveResponse> {\n    const { skill_id, betas } = params;\n    return this._client.get(path`/v1/skills/${skill_id}/versions/${version}?beta=true`, {\n      ...options,\n      headers: buildHeaders([\n        { 'anthropic-beta': [...(betas ?? []), 'skills-2025-10-02'].toString() },\n        options?.headers,\n      ]),\n    });\n  }\n\n  /**\n   * List Skill Versions\n   *\n   * @example\n   * ```ts\n   * // Automatically fetches more pages as needed.\n   * for await (const versionListResponse of client.beta.skills.versions.list(\n   *   'skill_id',\n   * )) {\n   *   // ...\n   * }\n   * ```\n   */\n  list(\n    skillID: string,\n    params: VersionListParams | null | undefined = {},\n    options?: RequestOptions,\n  ): PagePromise<VersionListResponsesPageCursor, VersionListResponse> {\n    const { betas, ...query } = params ?? {};\n    return this._client.getAPIList(\n      path`/v1/skills/${skillID}/versions?beta=true`,\n      PageCursor<VersionListResponse>,\n      {\n        query,\n        ...options,\n        headers: buildHeaders([\n          { 'anthropic-beta': [...(betas ?? []), 'skills-2025-10-02'].toString() },\n          options?.headers,\n        ]),\n      },\n    );\n  }\n\n  /**\n   * Delete Skill Version\n   *\n   * @example\n   * ```ts\n   * const version = await client.beta.skills.versions.delete(\n   *   'version',\n   *   { skill_id: 'skill_id' },\n   * );\n   * ```\n   */\n  delete(\n    version: string,\n    params: VersionDeleteParams,\n    options?: RequestOptions,\n  ): APIPromise<VersionDeleteResponse> {\n    const { skill_id, betas } = params;\n    return this._client.delete(path`/v1/skills/${skill_id}/versions/${version}?beta=true`, {\n      ...options,\n      headers: buildHeaders([\n        { 'anthropic-beta': [...(betas ?? []), 'skills-2025-10-02'].toString() },\n        options?.headers,\n      ]),\n    });\n  }\n}\n\nexport type VersionListResponsesPageCursor = PageCursor<VersionListResponse>;\n\nexport interface VersionCreateResponse {\n  /**\n   * Unique identifier for the skill version.\n   *\n   * The format and length of IDs may change over time.\n   */\n  id: string;\n\n  /**\n   * ISO 8601 timestamp of when the skill version was created.\n   */\n  created_at: string;\n\n  /**\n   * Description of the skill version.\n   *\n   * This is extracted from the SKILL.md file in the skill upload.\n   */\n  description: string;\n\n  /**\n   * Directory name of the skill version.\n   *\n   * This is the top-level directory name that was extracted from the uploaded files.\n   */\n  directory: string;\n\n  /**\n   * Human-readable name of the skill version.\n   *\n   * This is extracted from the SKILL.md file in the skill upload.\n   */\n  name: string;\n\n  /**\n   * Identifier for the skill that this version belongs to.\n   */\n  skill_id: string;\n\n  /**\n   * Object type.\n   *\n   * For Skill Versions, this is always `\"skill_version\"`.\n   */\n  type: string;\n\n  /**\n   * Version identifier for the skill.\n   *\n   * Each version is identified by a Unix epoch timestamp (e.g., \"1759178010641129\").\n   */\n  version: string;\n}\n\nexport interface VersionRetrieveResponse {\n  /**\n   * Unique identifier for the skill version.\n   *\n   * The format and length of IDs may change over time.\n   */\n  id: string;\n\n  /**\n   * ISO 8601 timestamp of when the skill version was created.\n   */\n  created_at: string;\n\n  /**\n   * Description of the skill version.\n   *\n   * This is extracted from the SKILL.md file in the skill upload.\n   */\n  description: string;\n\n  /**\n   * Directory name of the skill version.\n   *\n   * This is the top-level directory name that was extracted from the uploaded files.\n   */\n  directory: string;\n\n  /**\n   * Human-readable name of the skill version.\n   *\n   * This is extracted from the SKILL.md file in the skill upload.\n   */\n  name: string;\n\n  /**\n   * Identifier for the skill that this version belongs to.\n   */\n  skill_id: string;\n\n  /**\n   * Object type.\n   *\n   * For Skill Versions, this is always `\"skill_version\"`.\n   */\n  type: string;\n\n  /**\n   * Version identifier for the skill.\n   *\n   * Each version is identified by a Unix epoch timestamp (e.g., \"1759178010641129\").\n   */\n  version: string;\n}\n\nexport interface VersionListResponse {\n  /**\n   * Unique identifier for the skill version.\n   *\n   * The format and length of IDs may change over time.\n   */\n  id: string;\n\n  /**\n   * ISO 8601 timestamp of when the skill version was created.\n   */\n  created_at: string;\n\n  /**\n   * Description of the skill version.\n   *\n   * This is extracted from the SKILL.md file in the skill upload.\n   */\n  description: string;\n\n  /**\n   * Directory name of the skill version.\n   *\n   * This is the top-level directory name that was extracted from the uploaded files.\n   */\n  directory: string;\n\n  /**\n   * Human-readable name of the skill version.\n   *\n   * This is extracted from the SKILL.md file in the skill upload.\n   */\n  name: string;\n\n  /**\n   * Identifier for the skill that this version belongs to.\n   */\n  skill_id: string;\n\n  /**\n   * Object type.\n   *\n   * For Skill Versions, this is always `\"skill_version\"`.\n   */\n  type: string;\n\n  /**\n   * Version identifier for the skill.\n   *\n   * Each version is identified by a Unix epoch timestamp (e.g., \"1759178010641129\").\n   */\n  version: string;\n}\n\nexport interface VersionDeleteResponse {\n  /**\n   * Version identifier for the skill.\n   *\n   * Each version is identified by a Unix epoch timestamp (e.g., \"1759178010641129\").\n   */\n  id: string;\n\n  /**\n   * Deleted object type.\n   *\n   * For Skill Versions, this is always `\"skill_version_deleted\"`.\n   */\n  type: string;\n}\n\nexport interface VersionCreateParams {\n  /**\n   * Body param: Files to upload for the skill.\n   *\n   * All files must be in the same top-level directory and must include a SKILL.md\n   * file at the root of that directory.\n   */\n  files?: Array<Uploadable> | null;\n\n  /**\n   * Header param: Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport interface VersionRetrieveParams {\n  /**\n   * Path param: Unique identifier for the skill.\n   *\n   * The format and length of IDs may change over time.\n   */\n  skill_id: string;\n\n  /**\n   * Header param: Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport interface VersionListParams extends PageCursorParams {\n  /**\n   * Header param: Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport interface VersionDeleteParams {\n  /**\n   * Path param: Unique identifier for the skill.\n   *\n   * The format and length of IDs may change over time.\n   */\n  skill_id: string;\n\n  /**\n   * Header param: Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport declare namespace Versions {\n  export {\n    type VersionCreateResponse as VersionCreateResponse,\n    type VersionRetrieveResponse as VersionRetrieveResponse,\n    type VersionListResponse as VersionListResponse,\n    type VersionDeleteResponse as VersionDeleteResponse,\n    type VersionListResponsesPageCursor as VersionListResponsesPageCursor,\n    type VersionCreateParams as VersionCreateParams,\n    type VersionRetrieveParams as VersionRetrieveParams,\n    type VersionListParams as VersionListParams,\n    type VersionDeleteParams as VersionDeleteParams,\n  };\n}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { APIResource } from '../../../core/resource';\nimport * as BetaAPI from '../beta';\nimport * as VersionsAPI from './versions';\nimport {\n  VersionCreateParams,\n  VersionCreateResponse,\n  VersionDeleteParams,\n  VersionDeleteResponse,\n  VersionListParams,\n  VersionListResponse,\n  VersionListResponsesPageCursor,\n  VersionRetrieveParams,\n  VersionRetrieveResponse,\n  Versions,\n} from './versions';\nimport { APIPromise } from '../../../core/api-promise';\nimport { PageCursor, type PageCursorParams, PagePromise } from '../../../core/pagination';\nimport { type Uploadable } from '../../../core/uploads';\nimport { buildHeaders } from '../../../internal/headers';\nimport { RequestOptions } from '../../../internal/request-options';\nimport { multipartFormRequestOptions } from '../../../internal/uploads';\nimport { path } from '../../../internal/utils/path';\n\nexport class Skills extends APIResource {\n  versions: VersionsAPI.Versions = new VersionsAPI.Versions(this._client);\n\n  /**\n   * Create Skill\n   *\n   * @example\n   * ```ts\n   * const skill = await client.beta.skills.create();\n   * ```\n   */\n  create(\n    params: SkillCreateParams | null | undefined = {},\n    options?: RequestOptions,\n  ): APIPromise<SkillCreateResponse> {\n    const { betas, ...body } = params ?? {};\n    return this._client.post(\n      '/v1/skills?beta=true',\n      multipartFormRequestOptions(\n        {\n          body,\n          ...options,\n          headers: buildHeaders([\n            { 'anthropic-beta': [...(betas ?? []), 'skills-2025-10-02'].toString() },\n            options?.headers,\n          ]),\n        },\n        this._client,\n      ),\n    );\n  }\n\n  /**\n   * Get Skill\n   *\n   * @example\n   * ```ts\n   * const skill = await client.beta.skills.retrieve('skill_id');\n   * ```\n   */\n  retrieve(\n    skillID: string,\n    params: SkillRetrieveParams | null | undefined = {},\n    options?: RequestOptions,\n  ): APIPromise<SkillRetrieveResponse> {\n    const { betas } = params ?? {};\n    return this._client.get(path`/v1/skills/${skillID}?beta=true`, {\n      ...options,\n      headers: buildHeaders([\n        { 'anthropic-beta': [...(betas ?? []), 'skills-2025-10-02'].toString() },\n        options?.headers,\n      ]),\n    });\n  }\n\n  /**\n   * List Skills\n   *\n   * @example\n   * ```ts\n   * // Automatically fetches more pages as needed.\n   * for await (const skillListResponse of client.beta.skills.list()) {\n   *   // ...\n   * }\n   * ```\n   */\n  list(\n    params: SkillListParams | null | undefined = {},\n    options?: RequestOptions,\n  ): PagePromise<SkillListResponsesPageCursor, SkillListResponse> {\n    const { betas, ...query } = params ?? {};\n    return this._client.getAPIList('/v1/skills?beta=true', PageCursor<SkillListResponse>, {\n      query,\n      ...options,\n      headers: buildHeaders([\n        { 'anthropic-beta': [...(betas ?? []), 'skills-2025-10-02'].toString() },\n        options?.headers,\n      ]),\n    });\n  }\n\n  /**\n   * Delete Skill\n   *\n   * @example\n   * ```ts\n   * const skill = await client.beta.skills.delete('skill_id');\n   * ```\n   */\n  delete(\n    skillID: string,\n    params: SkillDeleteParams | null | undefined = {},\n    options?: RequestOptions,\n  ): APIPromise<SkillDeleteResponse> {\n    const { betas } = params ?? {};\n    return this._client.delete(path`/v1/skills/${skillID}?beta=true`, {\n      ...options,\n      headers: buildHeaders([\n        { 'anthropic-beta': [...(betas ?? []), 'skills-2025-10-02'].toString() },\n        options?.headers,\n      ]),\n    });\n  }\n}\n\nexport type SkillListResponsesPageCursor = PageCursor<SkillListResponse>;\n\nexport interface SkillCreateResponse {\n  /**\n   * Unique identifier for the skill.\n   *\n   * The format and length of IDs may change over time.\n   */\n  id: string;\n\n  /**\n   * ISO 8601 timestamp of when the skill was created.\n   */\n  created_at: string;\n\n  /**\n   * Display title for the skill.\n   *\n   * This is a human-readable label that is not included in the prompt sent to the\n   * model.\n   */\n  display_title: string | null;\n\n  /**\n   * The latest version identifier for the skill.\n   *\n   * This represents the most recent version of the skill that has been created.\n   */\n  latest_version: string | null;\n\n  /**\n   * Source of the skill.\n   *\n   * This may be one of the following values:\n   *\n   * - `\"custom\"`: the skill was created by a user\n   * - `\"anthropic\"`: the skill was created by Anthropic\n   */\n  source: string;\n\n  /**\n   * Object type.\n   *\n   * For Skills, this is always `\"skill\"`.\n   */\n  type: string;\n\n  /**\n   * ISO 8601 timestamp of when the skill was last updated.\n   */\n  updated_at: string;\n}\n\nexport interface SkillRetrieveResponse {\n  /**\n   * Unique identifier for the skill.\n   *\n   * The format and length of IDs may change over time.\n   */\n  id: string;\n\n  /**\n   * ISO 8601 timestamp of when the skill was created.\n   */\n  created_at: string;\n\n  /**\n   * Display title for the skill.\n   *\n   * This is a human-readable label that is not included in the prompt sent to the\n   * model.\n   */\n  display_title: string | null;\n\n  /**\n   * The latest version identifier for the skill.\n   *\n   * This represents the most recent version of the skill that has been created.\n   */\n  latest_version: string | null;\n\n  /**\n   * Source of the skill.\n   *\n   * This may be one of the following values:\n   *\n   * - `\"custom\"`: the skill was created by a user\n   * - `\"anthropic\"`: the skill was created by Anthropic\n   */\n  source: string;\n\n  /**\n   * Object type.\n   *\n   * For Skills, this is always `\"skill\"`.\n   */\n  type: string;\n\n  /**\n   * ISO 8601 timestamp of when the skill was last updated.\n   */\n  updated_at: string;\n}\n\nexport interface SkillListResponse {\n  /**\n   * Unique identifier for the skill.\n   *\n   * The format and length of IDs may change over time.\n   */\n  id: string;\n\n  /**\n   * ISO 8601 timestamp of when the skill was created.\n   */\n  created_at: string;\n\n  /**\n   * Display title for the skill.\n   *\n   * This is a human-readable label that is not included in the prompt sent to the\n   * model.\n   */\n  display_title: string | null;\n\n  /**\n   * The latest version identifier for the skill.\n   *\n   * This represents the most recent version of the skill that has been created.\n   */\n  latest_version: string | null;\n\n  /**\n   * Source of the skill.\n   *\n   * This may be one of the following values:\n   *\n   * - `\"custom\"`: the skill was created by a user\n   * - `\"anthropic\"`: the skill was created by Anthropic\n   */\n  source: string;\n\n  /**\n   * Object type.\n   *\n   * For Skills, this is always `\"skill\"`.\n   */\n  type: string;\n\n  /**\n   * ISO 8601 timestamp of when the skill was last updated.\n   */\n  updated_at: string;\n}\n\nexport interface SkillDeleteResponse {\n  /**\n   * Unique identifier for the skill.\n   *\n   * The format and length of IDs may change over time.\n   */\n  id: string;\n\n  /**\n   * Deleted object type.\n   *\n   * For Skills, this is always `\"skill_deleted\"`.\n   */\n  type: string;\n}\n\nexport interface SkillCreateParams {\n  /**\n   * Body param: Display title for the skill.\n   *\n   * This is a human-readable label that is not included in the prompt sent to the\n   * model.\n   */\n  display_title?: string | null;\n\n  /**\n   * Body param: Files to upload for the skill.\n   *\n   * All files must be in the same top-level directory and must include a SKILL.md\n   * file at the root of that directory.\n   */\n  files?: Array<Uploadable> | null;\n\n  /**\n   * Header param: Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport interface SkillRetrieveParams {\n  /**\n   * Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport interface SkillListParams extends PageCursorParams {\n  /**\n   * Query param: Filter skills by source.\n   *\n   * If provided, only skills from the specified source will be returned:\n   *\n   * - `\"custom\"`: only return user-created skills\n   * - `\"anthropic\"`: only return Anthropic-created skills\n   */\n  source?: string | null;\n\n  /**\n   * Header param: Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport interface SkillDeleteParams {\n  /**\n   * Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nSkills.Versions = Versions;\n\nexport declare namespace Skills {\n  export {\n    type SkillCreateResponse as SkillCreateResponse,\n    type SkillRetrieveResponse as SkillRetrieveResponse,\n    type SkillListResponse as SkillListResponse,\n    type SkillDeleteResponse as SkillDeleteResponse,\n    type SkillListResponsesPageCursor as SkillListResponsesPageCursor,\n    type SkillCreateParams as SkillCreateParams,\n    type SkillRetrieveParams as SkillRetrieveParams,\n    type SkillListParams as SkillListParams,\n    type SkillDeleteParams as SkillDeleteParams,\n  };\n\n  export {\n    Versions as Versions,\n    type VersionCreateResponse as VersionCreateResponse,\n    type VersionRetrieveResponse as VersionRetrieveResponse,\n    type VersionListResponse as VersionListResponse,\n    type VersionDeleteResponse as VersionDeleteResponse,\n    type VersionListResponsesPageCursor as VersionListResponsesPageCursor,\n    type VersionCreateParams as VersionCreateParams,\n    type VersionRetrieveParams as VersionRetrieveParams,\n    type VersionListParams as VersionListParams,\n    type VersionDeleteParams as VersionDeleteParams,\n  };\n}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { APIResource } from '../../core/resource';\nimport * as FilesAPI from './files';\nimport {\n  DeletedFile,\n  FileDeleteParams,\n  FileDownloadParams,\n  FileListParams,\n  FileMetadata,\n  FileMetadataPage,\n  FileRetrieveMetadataParams,\n  FileUploadParams,\n  Files,\n} from './files';\nimport * as ModelsAPI from './models';\nimport { BetaModelInfo, BetaModelInfosPage, ModelListParams, ModelRetrieveParams, Models } from './models';\nimport * as MessagesAPI from './messages/messages';\nimport {\n  BetaAllThinkingTurns,\n  BetaBase64ImageSource,\n  BetaBase64PDFBlock,\n  BetaBase64PDFSource,\n  BetaBashCodeExecutionOutputBlock,\n  BetaBashCodeExecutionOutputBlockParam,\n  BetaBashCodeExecutionResultBlock,\n  BetaBashCodeExecutionResultBlockParam,\n  BetaBashCodeExecutionToolResultBlock,\n  BetaBashCodeExecutionToolResultBlockParam,\n  BetaBashCodeExecutionToolResultError,\n  BetaBashCodeExecutionToolResultErrorParam,\n  BetaCacheControlEphemeral,\n  BetaCacheCreation,\n  BetaCitationCharLocation,\n  BetaCitationCharLocationParam,\n  BetaCitationConfig,\n  BetaCitationContentBlockLocation,\n  BetaCitationContentBlockLocationParam,\n  BetaCitationPageLocation,\n  BetaCitationPageLocationParam,\n  BetaCitationSearchResultLocation,\n  BetaCitationSearchResultLocationParam,\n  BetaCitationWebSearchResultLocationParam,\n  BetaCitationsConfigParam,\n  BetaCitationsDelta,\n  BetaCitationsWebSearchResultLocation,\n  BetaClearThinking20251015Edit,\n  BetaClearThinking20251015EditResponse,\n  BetaClearToolUses20250919Edit,\n  BetaClearToolUses20250919EditResponse,\n  BetaCodeExecutionOutputBlock,\n  BetaCodeExecutionOutputBlockParam,\n  BetaCodeExecutionResultBlock,\n  BetaCodeExecutionResultBlockParam,\n  BetaCodeExecutionTool20250522,\n  BetaCodeExecutionTool20250825,\n  BetaCodeExecutionToolResultBlock,\n  BetaCodeExecutionToolResultBlockContent,\n  BetaCodeExecutionToolResultBlockParam,\n  BetaCodeExecutionToolResultBlockParamContent,\n  BetaCodeExecutionToolResultError,\n  BetaCodeExecutionToolResultErrorCode,\n  BetaCodeExecutionToolResultErrorParam,\n  BetaContainer,\n  BetaContainerParams,\n  BetaContainerUploadBlock,\n  BetaContainerUploadBlockParam,\n  BetaContentBlock,\n  BetaContentBlockParam,\n  BetaContentBlockSource,\n  BetaContentBlockSourceContent,\n  BetaContextManagementConfig,\n  BetaContextManagementResponse,\n  BetaCountTokensContextManagementResponse,\n  BetaDirectCaller,\n  BetaDocumentBlock,\n  BetaFileDocumentSource,\n  BetaFileImageSource,\n  BetaImageBlockParam,\n  BetaInputJSONDelta,\n  BetaJSONOutputFormat,\n  BetaInputTokensClearAtLeast,\n  BetaInputTokensTrigger,\n  BetaMCPToolResultBlock,\n  BetaMCPToolUseBlock,\n  BetaMCPToolUseBlockParam,\n  BetaMCPToolset,\n  BetaMemoryTool20250818,\n  BetaMemoryTool20250818Command,\n  BetaMemoryTool20250818CreateCommand,\n  BetaMemoryTool20250818DeleteCommand,\n  BetaMemoryTool20250818InsertCommand,\n  BetaMemoryTool20250818RenameCommand,\n  BetaMemoryTool20250818StrReplaceCommand,\n  BetaMemoryTool20250818ViewCommand,\n  BetaMessage,\n  BetaMessageDeltaUsage,\n  BetaMessageParam,\n  BetaMessageTokensCount,\n  BetaMetadata,\n  BetaOutputConfig,\n  BetaPlainTextSource,\n  BetaRawContentBlockDelta,\n  BetaRawContentBlockDeltaEvent,\n  BetaRawContentBlockStartEvent,\n  BetaRawContentBlockStopEvent,\n  BetaRawMessageDeltaEvent,\n  BetaRawMessageStartEvent,\n  BetaRawMessageStopEvent,\n  BetaRawMessageStreamEvent,\n  BetaRedactedThinkingBlock,\n  BetaRedactedThinkingBlockParam,\n  BetaRequestDocumentBlock,\n  BetaRequestMCPServerToolConfiguration,\n  BetaRequestMCPServerURLDefinition,\n  BetaRequestMCPToolResultBlockParam,\n  BetaSearchResultBlockParam,\n  BetaServerToolCaller,\n  BetaServerToolUsage,\n  BetaServerToolUseBlock,\n  BetaServerToolUseBlockParam,\n  BetaSignatureDelta,\n  BetaSkill,\n  BetaSkillParams,\n  BetaStopReason,\n  BetaTextBlock,\n  BetaTextBlockParam,\n  BetaTextCitation,\n  BetaTextCitationParam,\n  BetaTextDelta,\n  BetaTextEditorCodeExecutionCreateResultBlock,\n  BetaTextEditorCodeExecutionCreateResultBlockParam,\n  BetaTextEditorCodeExecutionStrReplaceResultBlock,\n  BetaTextEditorCodeExecutionStrReplaceResultBlockParam,\n  BetaTextEditorCodeExecutionToolResultBlock,\n  BetaTextEditorCodeExecutionToolResultBlockParam,\n  BetaTextEditorCodeExecutionToolResultError,\n  BetaTextEditorCodeExecutionToolResultErrorParam,\n  BetaTextEditorCodeExecutionViewResultBlock,\n  BetaTextEditorCodeExecutionViewResultBlockParam,\n  BetaThinkingBlock,\n  BetaThinkingBlockParam,\n  BetaThinkingConfigDisabled,\n  BetaThinkingConfigEnabled,\n  BetaThinkingConfigParam,\n  BetaThinkingDelta,\n  BetaThinkingTurns,\n  BetaTool,\n  BetaToolBash20241022,\n  BetaToolBash20250124,\n  BetaToolChoice,\n  BetaToolChoiceAny,\n  BetaToolChoiceAuto,\n  BetaToolChoiceNone,\n  BetaToolChoiceTool,\n  BetaToolComputerUse20241022,\n  BetaToolComputerUse20250124,\n  BetaToolComputerUse20251124,\n  BetaToolReferenceBlock,\n  BetaToolReferenceBlockParam,\n  BetaToolResultBlockParam,\n  BetaToolTextEditor20241022,\n  BetaToolTextEditor20250124,\n  BetaToolTextEditor20250429,\n  BetaToolTextEditor20250728,\n  BetaToolUnion,\n  BetaToolUseBlock,\n  BetaToolUseBlockParam,\n  BetaToolUsesKeep,\n  BetaToolUsesTrigger,\n  BetaURLImageSource,\n  BetaURLPDFSource,\n  BetaUsage,\n  BetaWebFetchBlock,\n  BetaWebFetchBlockParam,\n  BetaWebFetchTool20250910,\n  BetaWebFetchToolResultBlock,\n  BetaWebFetchToolResultBlockParam,\n  BetaWebFetchToolResultErrorBlock,\n  BetaWebFetchToolResultErrorBlockParam,\n  BetaWebFetchToolResultErrorCode,\n  BetaWebSearchResultBlock,\n  BetaWebSearchResultBlockParam,\n  BetaWebSearchTool20250305,\n  BetaWebSearchToolRequestError,\n  BetaWebSearchToolResultBlock,\n  BetaWebSearchToolResultBlockContent,\n  BetaWebSearchToolResultBlockParam,\n  BetaWebSearchToolResultBlockParamContent,\n  BetaWebSearchToolResultError,\n  BetaWebSearchToolResultErrorCode,\n  MessageCountTokensParams,\n  MessageCreateParams,\n  MessageCreateParamsNonStreaming,\n  MessageCreateParamsStreaming,\n  Messages,\n  BetaMCPToolConfig,\n  BetaMCPToolDefaultConfig,\n} from './messages/messages';\nimport * as SkillsAPI from './skills/skills';\nimport {\n  SkillCreateParams,\n  SkillCreateResponse,\n  SkillDeleteParams,\n  SkillDeleteResponse,\n  SkillListParams,\n  SkillListResponse,\n  SkillListResponsesPageCursor,\n  SkillRetrieveParams,\n  SkillRetrieveResponse,\n  Skills,\n} from './skills/skills';\n\nexport class Beta extends APIResource {\n  models: ModelsAPI.Models = new ModelsAPI.Models(this._client);\n  messages: MessagesAPI.Messages = new MessagesAPI.Messages(this._client);\n  files: FilesAPI.Files = new FilesAPI.Files(this._client);\n  skills: SkillsAPI.Skills = new SkillsAPI.Skills(this._client);\n}\n\nexport type AnthropicBeta =\n  | (string & {})\n  | 'message-batches-2024-09-24'\n  | 'prompt-caching-2024-07-31'\n  | 'computer-use-2024-10-22'\n  | 'computer-use-2025-01-24'\n  | 'pdfs-2024-09-25'\n  | 'token-counting-2024-11-01'\n  | 'token-efficient-tools-2025-02-19'\n  | 'output-128k-2025-02-19'\n  | 'files-api-2025-04-14'\n  | 'mcp-client-2025-04-04'\n  | 'mcp-client-2025-11-20'\n  | 'dev-full-thinking-2025-05-14'\n  | 'interleaved-thinking-2025-05-14'\n  | 'code-execution-2025-05-22'\n  | 'extended-cache-ttl-2025-04-11'\n  | 'context-1m-2025-08-07'\n  | 'context-management-2025-06-27'\n  | 'model-context-window-exceeded-2025-08-26'\n  | 'skills-2025-10-02';\n\nexport interface BetaAPIError {\n  message: string;\n\n  type: 'api_error';\n}\n\nexport interface BetaAuthenticationError {\n  message: string;\n\n  type: 'authentication_error';\n}\n\nexport interface BetaBillingError {\n  message: string;\n\n  type: 'billing_error';\n}\n\nexport type BetaError =\n  | BetaInvalidRequestError\n  | BetaAuthenticationError\n  | BetaBillingError\n  | BetaPermissionError\n  | BetaNotFoundError\n  | BetaRateLimitError\n  | BetaGatewayTimeoutError\n  | BetaAPIError\n  | BetaOverloadedError;\n\nexport interface BetaErrorResponse {\n  error: BetaError;\n\n  request_id: string | null;\n\n  type: 'error';\n}\n\nexport interface BetaGatewayTimeoutError {\n  message: string;\n\n  type: 'timeout_error';\n}\n\nexport interface BetaInvalidRequestError {\n  message: string;\n\n  type: 'invalid_request_error';\n}\n\nexport interface BetaNotFoundError {\n  message: string;\n\n  type: 'not_found_error';\n}\n\nexport interface BetaOverloadedError {\n  message: string;\n\n  type: 'overloaded_error';\n}\n\nexport interface BetaPermissionError {\n  message: string;\n\n  type: 'permission_error';\n}\n\nexport interface BetaRateLimitError {\n  message: string;\n\n  type: 'rate_limit_error';\n}\n\nBeta.Models = Models;\nBeta.Messages = Messages;\nBeta.Files = Files;\nBeta.Skills = Skills;\n\nexport declare namespace Beta {\n  export {\n    type AnthropicBeta as AnthropicBeta,\n    type BetaAPIError as BetaAPIError,\n    type BetaAuthenticationError as BetaAuthenticationError,\n    type BetaBillingError as BetaBillingError,\n    type BetaError as BetaError,\n    type BetaErrorResponse as BetaErrorResponse,\n    type BetaGatewayTimeoutError as BetaGatewayTimeoutError,\n    type BetaInvalidRequestError as BetaInvalidRequestError,\n    type BetaNotFoundError as BetaNotFoundError,\n    type BetaOverloadedError as BetaOverloadedError,\n    type BetaPermissionError as BetaPermissionError,\n    type BetaRateLimitError as BetaRateLimitError,\n  };\n\n  export {\n    Models as Models,\n    type BetaModelInfo as BetaModelInfo,\n    type BetaModelInfosPage as BetaModelInfosPage,\n    type ModelRetrieveParams as ModelRetrieveParams,\n    type ModelListParams as ModelListParams,\n  };\n\n  export {\n    Messages as Messages,\n    type BetaAllThinkingTurns as BetaAllThinkingTurns,\n    type BetaBase64ImageSource as BetaBase64ImageSource,\n    type BetaBase64PDFSource as BetaBase64PDFSource,\n    type BetaBashCodeExecutionOutputBlock as BetaBashCodeExecutionOutputBlock,\n    type BetaBashCodeExecutionOutputBlockParam as BetaBashCodeExecutionOutputBlockParam,\n    type BetaBashCodeExecutionResultBlock as BetaBashCodeExecutionResultBlock,\n    type BetaBashCodeExecutionResultBlockParam as BetaBashCodeExecutionResultBlockParam,\n    type BetaBashCodeExecutionToolResultBlock as BetaBashCodeExecutionToolResultBlock,\n    type BetaBashCodeExecutionToolResultBlockParam as BetaBashCodeExecutionToolResultBlockParam,\n    type BetaBashCodeExecutionToolResultError as BetaBashCodeExecutionToolResultError,\n    type BetaBashCodeExecutionToolResultErrorParam as BetaBashCodeExecutionToolResultErrorParam,\n    type BetaCacheControlEphemeral as BetaCacheControlEphemeral,\n    type BetaCacheCreation as BetaCacheCreation,\n    type BetaCitationCharLocation as BetaCitationCharLocation,\n    type BetaCitationCharLocationParam as BetaCitationCharLocationParam,\n    type BetaCitationConfig as BetaCitationConfig,\n    type BetaCitationContentBlockLocation as BetaCitationContentBlockLocation,\n    type BetaCitationContentBlockLocationParam as BetaCitationContentBlockLocationParam,\n    type BetaCitationPageLocation as BetaCitationPageLocation,\n    type BetaCitationPageLocationParam as BetaCitationPageLocationParam,\n    type BetaCitationSearchResultLocation as BetaCitationSearchResultLocation,\n    type BetaCitationSearchResultLocationParam as BetaCitationSearchResultLocationParam,\n    type BetaCitationWebSearchResultLocationParam as BetaCitationWebSearchResultLocationParam,\n    type BetaCitationsConfigParam as BetaCitationsConfigParam,\n    type BetaCitationsDelta as BetaCitationsDelta,\n    type BetaCitationsWebSearchResultLocation as BetaCitationsWebSearchResultLocation,\n    type BetaClearThinking20251015Edit as BetaClearThinking20251015Edit,\n    type BetaClearThinking20251015EditResponse as BetaClearThinking20251015EditResponse,\n    type BetaClearToolUses20250919Edit as BetaClearToolUses20250919Edit,\n    type BetaClearToolUses20250919EditResponse as BetaClearToolUses20250919EditResponse,\n    type BetaCodeExecutionOutputBlock as BetaCodeExecutionOutputBlock,\n    type BetaCodeExecutionOutputBlockParam as BetaCodeExecutionOutputBlockParam,\n    type BetaCodeExecutionResultBlock as BetaCodeExecutionResultBlock,\n    type BetaCodeExecutionResultBlockParam as BetaCodeExecutionResultBlockParam,\n    type BetaCodeExecutionTool20250522 as BetaCodeExecutionTool20250522,\n    type BetaCodeExecutionTool20250825 as BetaCodeExecutionTool20250825,\n    type BetaCodeExecutionToolResultBlock as BetaCodeExecutionToolResultBlock,\n    type BetaCodeExecutionToolResultBlockContent as BetaCodeExecutionToolResultBlockContent,\n    type BetaCodeExecutionToolResultBlockParam as BetaCodeExecutionToolResultBlockParam,\n    type BetaCodeExecutionToolResultBlockParamContent as BetaCodeExecutionToolResultBlockParamContent,\n    type BetaCodeExecutionToolResultError as BetaCodeExecutionToolResultError,\n    type BetaCodeExecutionToolResultErrorCode as BetaCodeExecutionToolResultErrorCode,\n    type BetaCodeExecutionToolResultErrorParam as BetaCodeExecutionToolResultErrorParam,\n    type BetaContainer as BetaContainer,\n    type BetaContainerParams as BetaContainerParams,\n    type BetaContainerUploadBlock as BetaContainerUploadBlock,\n    type BetaContainerUploadBlockParam as BetaContainerUploadBlockParam,\n    type BetaContentBlock as BetaContentBlock,\n    type BetaContentBlockParam as BetaContentBlockParam,\n    type BetaContentBlockSource as BetaContentBlockSource,\n    type BetaContentBlockSourceContent as BetaContentBlockSourceContent,\n    type BetaContextManagementConfig as BetaContextManagementConfig,\n    type BetaContextManagementResponse as BetaContextManagementResponse,\n    type BetaCountTokensContextManagementResponse as BetaCountTokensContextManagementResponse,\n    type BetaDirectCaller as BetaDirectCaller,\n    type BetaDocumentBlock as BetaDocumentBlock,\n    type BetaFileDocumentSource as BetaFileDocumentSource,\n    type BetaFileImageSource as BetaFileImageSource,\n    type BetaImageBlockParam as BetaImageBlockParam,\n    type BetaInputJSONDelta as BetaInputJSONDelta,\n    type BetaJSONOutputFormat as BetaJSONOutputFormat,\n    type BetaInputTokensClearAtLeast as BetaInputTokensClearAtLeast,\n    type BetaInputTokensTrigger as BetaInputTokensTrigger,\n    type BetaMCPToolConfig as BetaMCPToolConfig,\n    type BetaMCPToolDefaultConfig as BetaMCPToolDefaultConfig,\n    type BetaMCPToolResultBlock as BetaMCPToolResultBlock,\n    type BetaMCPToolUseBlock as BetaMCPToolUseBlock,\n    type BetaMCPToolUseBlockParam as BetaMCPToolUseBlockParam,\n    type BetaMCPToolset as BetaMCPToolset,\n    type BetaMemoryTool20250818 as BetaMemoryTool20250818,\n    type BetaMemoryTool20250818Command as BetaMemoryTool20250818Command,\n    type BetaMemoryTool20250818CreateCommand as BetaMemoryTool20250818CreateCommand,\n    type BetaMemoryTool20250818DeleteCommand as BetaMemoryTool20250818DeleteCommand,\n    type BetaMemoryTool20250818InsertCommand as BetaMemoryTool20250818InsertCommand,\n    type BetaMemoryTool20250818RenameCommand as BetaMemoryTool20250818RenameCommand,\n    type BetaMemoryTool20250818StrReplaceCommand as BetaMemoryTool20250818StrReplaceCommand,\n    type BetaMemoryTool20250818ViewCommand as BetaMemoryTool20250818ViewCommand,\n    type BetaMessage as BetaMessage,\n    type BetaMessageDeltaUsage as BetaMessageDeltaUsage,\n    type BetaMessageParam as BetaMessageParam,\n    type BetaMessageTokensCount as BetaMessageTokensCount,\n    type BetaMetadata as BetaMetadata,\n    type BetaOutputConfig as BetaOutputConfig,\n    type BetaPlainTextSource as BetaPlainTextSource,\n    type BetaRawContentBlockDelta as BetaRawContentBlockDelta,\n    type BetaRawContentBlockDeltaEvent as BetaRawContentBlockDeltaEvent,\n    type BetaRawContentBlockStartEvent as BetaRawContentBlockStartEvent,\n    type BetaRawContentBlockStopEvent as BetaRawContentBlockStopEvent,\n    type BetaRawMessageDeltaEvent as BetaRawMessageDeltaEvent,\n    type BetaRawMessageStartEvent as BetaRawMessageStartEvent,\n    type BetaRawMessageStopEvent as BetaRawMessageStopEvent,\n    type BetaRawMessageStreamEvent as BetaRawMessageStreamEvent,\n    type BetaRedactedThinkingBlock as BetaRedactedThinkingBlock,\n    type BetaRedactedThinkingBlockParam as BetaRedactedThinkingBlockParam,\n    type BetaRequestDocumentBlock as BetaRequestDocumentBlock,\n    type BetaRequestMCPServerToolConfiguration as BetaRequestMCPServerToolConfiguration,\n    type BetaRequestMCPServerURLDefinition as BetaRequestMCPServerURLDefinition,\n    type BetaRequestMCPToolResultBlockParam as BetaRequestMCPToolResultBlockParam,\n    type BetaSearchResultBlockParam as BetaSearchResultBlockParam,\n    type BetaServerToolCaller as BetaServerToolCaller,\n    type BetaServerToolUsage as BetaServerToolUsage,\n    type BetaServerToolUseBlock as BetaServerToolUseBlock,\n    type BetaServerToolUseBlockParam as BetaServerToolUseBlockParam,\n    type BetaSignatureDelta as BetaSignatureDelta,\n    type BetaSkill as BetaSkill,\n    type BetaSkillParams as BetaSkillParams,\n    type BetaStopReason as BetaStopReason,\n    type BetaTextBlock as BetaTextBlock,\n    type BetaTextBlockParam as BetaTextBlockParam,\n    type BetaTextCitation as BetaTextCitation,\n    type BetaTextCitationParam as BetaTextCitationParam,\n    type BetaTextDelta as BetaTextDelta,\n    type BetaTextEditorCodeExecutionCreateResultBlock as BetaTextEditorCodeExecutionCreateResultBlock,\n    type BetaTextEditorCodeExecutionCreateResultBlockParam as BetaTextEditorCodeExecutionCreateResultBlockParam,\n    type BetaTextEditorCodeExecutionStrReplaceResultBlock as BetaTextEditorCodeExecutionStrReplaceResultBlock,\n    type BetaTextEditorCodeExecutionStrReplaceResultBlockParam as BetaTextEditorCodeExecutionStrReplaceResultBlockParam,\n    type BetaTextEditorCodeExecutionToolResultBlock as BetaTextEditorCodeExecutionToolResultBlock,\n    type BetaTextEditorCodeExecutionToolResultBlockParam as BetaTextEditorCodeExecutionToolResultBlockParam,\n    type BetaTextEditorCodeExecutionToolResultError as BetaTextEditorCodeExecutionToolResultError,\n    type BetaTextEditorCodeExecutionToolResultErrorParam as BetaTextEditorCodeExecutionToolResultErrorParam,\n    type BetaTextEditorCodeExecutionViewResultBlock as BetaTextEditorCodeExecutionViewResultBlock,\n    type BetaTextEditorCodeExecutionViewResultBlockParam as BetaTextEditorCodeExecutionViewResultBlockParam,\n    type BetaThinkingBlock as BetaThinkingBlock,\n    type BetaThinkingBlockParam as BetaThinkingBlockParam,\n    type BetaThinkingConfigDisabled as BetaThinkingConfigDisabled,\n    type BetaThinkingConfigEnabled as BetaThinkingConfigEnabled,\n    type BetaThinkingConfigParam as BetaThinkingConfigParam,\n    type BetaThinkingDelta as BetaThinkingDelta,\n    type BetaThinkingTurns as BetaThinkingTurns,\n    type BetaTool as BetaTool,\n    type BetaToolBash20241022 as BetaToolBash20241022,\n    type BetaToolBash20250124 as BetaToolBash20250124,\n    type BetaToolChoice as BetaToolChoice,\n    type BetaToolChoiceAny as BetaToolChoiceAny,\n    type BetaToolChoiceAuto as BetaToolChoiceAuto,\n    type BetaToolChoiceNone as BetaToolChoiceNone,\n    type BetaToolChoiceTool as BetaToolChoiceTool,\n    type BetaToolComputerUse20241022 as BetaToolComputerUse20241022,\n    type BetaToolComputerUse20250124 as BetaToolComputerUse20250124,\n    type BetaToolComputerUse20251124 as BetaToolComputerUse20251124,\n    type BetaToolReferenceBlock as BetaToolReferenceBlock,\n    type BetaToolReferenceBlockParam as BetaToolReferenceBlockParam,\n    type BetaToolResultBlockParam as BetaToolResultBlockParam,\n    type BetaToolTextEditor20241022 as BetaToolTextEditor20241022,\n    type BetaToolTextEditor20250124 as BetaToolTextEditor20250124,\n    type BetaToolTextEditor20250429 as BetaToolTextEditor20250429,\n    type BetaToolTextEditor20250728 as BetaToolTextEditor20250728,\n    type BetaToolUnion as BetaToolUnion,\n    type BetaToolUseBlock as BetaToolUseBlock,\n    type BetaToolUseBlockParam as BetaToolUseBlockParam,\n    type BetaToolUsesKeep as BetaToolUsesKeep,\n    type BetaToolUsesTrigger as BetaToolUsesTrigger,\n    type BetaURLImageSource as BetaURLImageSource,\n    type BetaURLPDFSource as BetaURLPDFSource,\n    type BetaUsage as BetaUsage,\n    type BetaWebFetchBlock as BetaWebFetchBlock,\n    type BetaWebFetchBlockParam as BetaWebFetchBlockParam,\n    type BetaWebFetchTool20250910 as BetaWebFetchTool20250910,\n    type BetaWebFetchToolResultBlock as BetaWebFetchToolResultBlock,\n    type BetaWebFetchToolResultBlockParam as BetaWebFetchToolResultBlockParam,\n    type BetaWebFetchToolResultErrorBlock as BetaWebFetchToolResultErrorBlock,\n    type BetaWebFetchToolResultErrorBlockParam as BetaWebFetchToolResultErrorBlockParam,\n    type BetaWebFetchToolResultErrorCode as BetaWebFetchToolResultErrorCode,\n    type BetaWebSearchResultBlock as BetaWebSearchResultBlock,\n    type BetaWebSearchResultBlockParam as BetaWebSearchResultBlockParam,\n    type BetaWebSearchTool20250305 as BetaWebSearchTool20250305,\n    type BetaWebSearchToolRequestError as BetaWebSearchToolRequestError,\n    type BetaWebSearchToolResultBlock as BetaWebSearchToolResultBlock,\n    type BetaWebSearchToolResultBlockContent as BetaWebSearchToolResultBlockContent,\n    type BetaWebSearchToolResultBlockParam as BetaWebSearchToolResultBlockParam,\n    type BetaWebSearchToolResultBlockParamContent as BetaWebSearchToolResultBlockParamContent,\n    type BetaWebSearchToolResultError as BetaWebSearchToolResultError,\n    type BetaWebSearchToolResultErrorCode as BetaWebSearchToolResultErrorCode,\n    type BetaBase64PDFBlock as BetaBase64PDFBlock,\n    type MessageCreateParams as MessageCreateParams,\n    type MessageCreateParamsNonStreaming as MessageCreateParamsNonStreaming,\n    type MessageCreateParamsStreaming as MessageCreateParamsStreaming,\n    type MessageCountTokensParams as MessageCountTokensParams,\n  };\n\n  export {\n    Files as Files,\n    type DeletedFile as DeletedFile,\n    type FileMetadata as FileMetadata,\n    type FileMetadataPage as FileMetadataPage,\n    type FileListParams as FileListParams,\n    type FileDeleteParams as FileDeleteParams,\n    type FileDownloadParams as FileDownloadParams,\n    type FileRetrieveMetadataParams as FileRetrieveMetadataParams,\n    type FileUploadParams as FileUploadParams,\n  };\n\n  export {\n    Skills as Skills,\n    type SkillCreateResponse as SkillCreateResponse,\n    type SkillRetrieveResponse as SkillRetrieveResponse,\n    type SkillListResponse as SkillListResponse,\n    type SkillDeleteResponse as SkillDeleteResponse,\n    type SkillListResponsesPageCursor as SkillListResponsesPageCursor,\n    type SkillCreateParams as SkillCreateParams,\n    type SkillRetrieveParams as SkillRetrieveParams,\n    type SkillListParams as SkillListParams,\n    type SkillDeleteParams as SkillDeleteParams,\n  };\n}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { APIResource } from '../core/resource';\nimport * as CompletionsAPI from './completions';\nimport * as BetaAPI from './beta/beta';\nimport * as MessagesAPI from './messages/messages';\nimport { APIPromise } from '../core/api-promise';\nimport { Stream } from '../core/streaming';\nimport { buildHeaders } from '../internal/headers';\nimport { RequestOptions } from '../internal/request-options';\n\nexport class Completions extends APIResource {\n  /**\n   * [Legacy] Create a Text Completion.\n   *\n   * The Text Completions API is a legacy API. We recommend using the\n   * [Messages API](https://docs.claude.com/en/api/messages) going forward.\n   *\n   * Future models and features will not be compatible with Text Completions. See our\n   * [migration guide](https://docs.claude.com/en/api/migrating-from-text-completions-to-messages)\n   * for guidance in migrating from Text Completions to Messages.\n   *\n   * @example\n   * ```ts\n   * const completion = await client.completions.create({\n   *   max_tokens_to_sample: 256,\n   *   model: 'claude-opus-4-5-20251101',\n   *   prompt: '\\n\\nHuman: Hello, world!\\n\\nAssistant:',\n   * });\n   * ```\n   */\n  create(params: CompletionCreateParamsNonStreaming, options?: RequestOptions): APIPromise<Completion>;\n  create(params: CompletionCreateParamsStreaming, options?: RequestOptions): APIPromise<Stream<Completion>>;\n  create(\n    params: CompletionCreateParamsBase,\n    options?: RequestOptions,\n  ): APIPromise<Stream<Completion> | Completion>;\n  create(\n    params: CompletionCreateParams,\n    options?: RequestOptions,\n  ): APIPromise<Completion> | APIPromise<Stream<Completion>> {\n    const { betas, ...body } = params;\n    return this._client.post('/v1/complete', {\n      body,\n      timeout: (this._client as any)._options.timeout ?? 600000,\n      ...options,\n      headers: buildHeaders([\n        { ...(betas?.toString() != null ? { 'anthropic-beta': betas?.toString() } : undefined) },\n        options?.headers,\n      ]),\n      stream: params.stream ?? false,\n    }) as APIPromise<Completion> | APIPromise<Stream<Completion>>;\n  }\n}\n\nexport interface Completion {\n  /**\n   * Unique object identifier.\n   *\n   * The format and length of IDs may change over time.\n   */\n  id: string;\n\n  /**\n   * The resulting completion up to and excluding the stop sequences.\n   */\n  completion: string;\n\n  /**\n   * The model that will complete your prompt.\\n\\nSee\n   * [models](https://docs.anthropic.com/en/docs/models-overview) for additional\n   * details and options.\n   */\n  model: MessagesAPI.Model;\n\n  /**\n   * The reason that we stopped.\n   *\n   * This may be one the following values:\n   *\n   * - `\"stop_sequence\"`: we reached a stop sequence \u2014 either provided by you via the\n   *   `stop_sequences` parameter, or a stop sequence built into the model\n   * - `\"max_tokens\"`: we exceeded `max_tokens_to_sample` or the model's maximum\n   */\n  stop_reason: string | null;\n\n  /**\n   * Object type.\n   *\n   * For Text Completions, this is always `\"completion\"`.\n   */\n  type: 'completion';\n}\n\nexport type CompletionCreateParams = CompletionCreateParamsNonStreaming | CompletionCreateParamsStreaming;\n\nexport interface CompletionCreateParamsBase {\n  /**\n   * Body param: The maximum number of tokens to generate before stopping.\n   *\n   * Note that our models may stop _before_ reaching this maximum. This parameter\n   * only specifies the absolute maximum number of tokens to generate.\n   */\n  max_tokens_to_sample: number;\n\n  /**\n   * Body param: The model that will complete your prompt.\\n\\nSee\n   * [models](https://docs.anthropic.com/en/docs/models-overview) for additional\n   * details and options.\n   */\n  model: MessagesAPI.Model;\n\n  /**\n   * Body param: The prompt that you want Claude to complete.\n   *\n   * For proper response generation you will need to format your prompt using\n   * alternating `\\n\\nHuman:` and `\\n\\nAssistant:` conversational turns. For example:\n   *\n   * ```\n   * \"\\n\\nHuman: {userQuestion}\\n\\nAssistant:\"\n   * ```\n   *\n   * See [prompt validation](https://docs.claude.com/en/api/prompt-validation) and\n   * our guide to [prompt design](https://docs.claude.com/en/docs/intro-to-prompting)\n   * for more details.\n   */\n  prompt: string;\n\n  /**\n   * Body param: An object describing metadata about the request.\n   */\n  metadata?: MessagesAPI.Metadata;\n\n  /**\n   * Body param: Sequences that will cause the model to stop generating.\n   *\n   * Our models stop on `\"\\n\\nHuman:\"`, and may include additional built-in stop\n   * sequences in the future. By providing the stop_sequences parameter, you may\n   * include additional strings that will cause the model to stop generating.\n   */\n  stop_sequences?: Array<string>;\n\n  /**\n   * Body param: Whether to incrementally stream the response using server-sent\n   * events.\n   *\n   * See [streaming](https://docs.claude.com/en/api/streaming) for details.\n   */\n  stream?: boolean;\n\n  /**\n   * Body param: Amount of randomness injected into the response.\n   *\n   * Defaults to `1.0`. Ranges from `0.0` to `1.0`. Use `temperature` closer to `0.0`\n   * for analytical / multiple choice, and closer to `1.0` for creative and\n   * generative tasks.\n   *\n   * Note that even with `temperature` of `0.0`, the results will not be fully\n   * deterministic.\n   */\n  temperature?: number;\n\n  /**\n   * Body param: Only sample from the top K options for each subsequent token.\n   *\n   * Used to remove \"long tail\" low probability responses.\n   * [Learn more technical details here](https://towardsdatascience.com/how-to-sample-from-language-models-682bceb97277).\n   *\n   * Recommended for advanced use cases only. You usually only need to use\n   * `temperature`.\n   */\n  top_k?: number;\n\n  /**\n   * Body param: Use nucleus sampling.\n   *\n   * In nucleus sampling, we compute the cumulative distribution over all the options\n   * for each subsequent token in decreasing probability order and cut it off once it\n   * reaches a particular probability specified by `top_p`. You should either alter\n   * `temperature` or `top_p`, but not both.\n   *\n   * Recommended for advanced use cases only. You usually only need to use\n   * `temperature`.\n   */\n  top_p?: number;\n\n  /**\n   * Header param: Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport namespace CompletionCreateParams {\n  /**\n   * @deprecated use `Anthropic.Messages.Metadata` instead\n   */\n  export type Metadata = MessagesAPI.Metadata;\n\n  export type CompletionCreateParamsNonStreaming = CompletionsAPI.CompletionCreateParamsNonStreaming;\n  export type CompletionCreateParamsStreaming = CompletionsAPI.CompletionCreateParamsStreaming;\n}\n\nexport interface CompletionCreateParamsNonStreaming extends CompletionCreateParamsBase {\n  /**\n   * Body param: Whether to incrementally stream the response using server-sent\n   * events.\n   *\n   * See [streaming](https://docs.claude.com/en/api/streaming) for details.\n   */\n  stream?: false;\n}\n\nexport interface CompletionCreateParamsStreaming extends CompletionCreateParamsBase {\n  /**\n   * Body param: Whether to incrementally stream the response using server-sent\n   * events.\n   *\n   * See [streaming](https://docs.claude.com/en/api/streaming) for details.\n   */\n  stream: true;\n}\n\nexport declare namespace Completions {\n  export {\n    type Completion as Completion,\n    type CompletionCreateParams as CompletionCreateParams,\n    type CompletionCreateParamsNonStreaming as CompletionCreateParamsNonStreaming,\n    type CompletionCreateParamsStreaming as CompletionCreateParamsStreaming,\n  };\n}\n", "import { isAbortError } from '../internal/errors';\nimport { AnthropicError, APIUserAbortError } from '../error';\nimport {\n  type ContentBlock,\n  Messages,\n  type Message,\n  type MessageStreamEvent,\n  type MessageParam,\n  type MessageCreateParams,\n  type MessageCreateParamsBase,\n  type TextBlock,\n  type TextCitation,\n  type ToolUseBlock,\n  type ServerToolUseBlock,\n} from '../resources/messages';\nimport { Stream } from '../streaming';\nimport { partialParse } from '../_vendor/partial-json-parser/parser';\nimport { RequestOptions } from '../internal/request-options';\n\nexport interface MessageStreamEvents {\n  connect: () => void;\n  streamEvent: (event: MessageStreamEvent, snapshot: Message) => void;\n  text: (textDelta: string, textSnapshot: string) => void;\n  citation: (citation: TextCitation, citationsSnapshot: TextCitation[]) => void;\n  inputJson: (partialJson: string, jsonSnapshot: unknown) => void;\n  thinking: (thinkingDelta: string, thinkingSnapshot: string) => void;\n  signature: (signature: string) => void;\n  message: (message: Message) => void;\n  contentBlock: (content: ContentBlock) => void;\n  finalMessage: (message: Message) => void;\n  error: (error: AnthropicError) => void;\n  abort: (error: APIUserAbortError) => void;\n  end: () => void;\n}\n\ntype MessageStreamEventListeners<Event extends keyof MessageStreamEvents> = {\n  listener: MessageStreamEvents[Event];\n  once?: boolean;\n}[];\n\nconst JSON_BUF_PROPERTY = '__json_buf';\n\nexport type TracksToolInput = ToolUseBlock | ServerToolUseBlock;\n\nfunction tracksToolInput(content: ContentBlock): content is TracksToolInput {\n  return content.type === 'tool_use' || content.type === 'server_tool_use';\n}\n\nexport class MessageStream implements AsyncIterable<MessageStreamEvent> {\n  messages: MessageParam[] = [];\n  receivedMessages: Message[] = [];\n  #currentMessageSnapshot: Message | undefined;\n\n  controller: AbortController = new AbortController();\n\n  #connectedPromise: Promise<Response | null>;\n  #resolveConnectedPromise: (response: Response | null) => void = () => {};\n  #rejectConnectedPromise: (error: AnthropicError) => void = () => {};\n\n  #endPromise: Promise<void>;\n  #resolveEndPromise: () => void = () => {};\n  #rejectEndPromise: (error: AnthropicError) => void = () => {};\n\n  #listeners: { [Event in keyof MessageStreamEvents]?: MessageStreamEventListeners<Event> } = {};\n\n  #ended = false;\n  #errored = false;\n  #aborted = false;\n  #catchingPromiseCreated = false;\n  #response: Response | null | undefined;\n  #request_id: string | null | undefined;\n\n  constructor() {\n    this.#connectedPromise = new Promise<Response | null>((resolve, reject) => {\n      this.#resolveConnectedPromise = resolve;\n      this.#rejectConnectedPromise = reject;\n    });\n\n    this.#endPromise = new Promise<void>((resolve, reject) => {\n      this.#resolveEndPromise = resolve;\n      this.#rejectEndPromise = reject;\n    });\n\n    // Don't let these promises cause unhandled rejection errors.\n    // we will manually cause an unhandled rejection error later\n    // if the user hasn't registered any error listener or called\n    // any promise-returning method.\n    this.#connectedPromise.catch(() => {});\n    this.#endPromise.catch(() => {});\n  }\n\n  get response(): Response | null | undefined {\n    return this.#response;\n  }\n\n  get request_id(): string | null | undefined {\n    return this.#request_id;\n  }\n\n  /**\n   * Returns the `MessageStream` data, the raw `Response` instance and the ID of the request,\n   * returned vie the `request-id` header which is useful for debugging requests and resporting\n   * issues to Anthropic.\n   *\n   * This is the same as the `APIPromise.withResponse()` method.\n   *\n   * This method will raise an error if you created the stream using `MessageStream.fromReadableStream`\n   * as no `Response` is available.\n   */\n  async withResponse(): Promise<{\n    data: MessageStream;\n    response: Response;\n    request_id: string | null | undefined;\n  }> {\n    this.#catchingPromiseCreated = true;\n\n    const response = await this.#connectedPromise;\n    if (!response) {\n      throw new Error('Could not resolve a `Response` object');\n    }\n\n    return {\n      data: this,\n      response,\n      request_id: response.headers.get('request-id'),\n    };\n  }\n\n  /**\n   * Intended for use on the frontend, consuming a stream produced with\n   * `.toReadableStream()` on the backend.\n   *\n   * Note that messages sent to the model do not appear in `.on('message')`\n   * in this context.\n   */\n  static fromReadableStream(stream: ReadableStream): MessageStream {\n    const runner = new MessageStream();\n    runner._run(() => runner._fromReadableStream(stream));\n    return runner;\n  }\n\n  static createMessage(\n    messages: Messages,\n    params: MessageCreateParamsBase,\n    options?: RequestOptions,\n  ): MessageStream {\n    const runner = new MessageStream();\n    for (const message of params.messages) {\n      runner._addMessageParam(message);\n    }\n    runner._run(() =>\n      runner._createMessage(\n        messages,\n        { ...params, stream: true },\n        { ...options, headers: { ...options?.headers, 'X-Stainless-Helper-Method': 'stream' } },\n      ),\n    );\n    return runner;\n  }\n\n  protected _run(executor: () => Promise<any>) {\n    executor().then(() => {\n      this._emitFinal();\n      this._emit('end');\n    }, this.#handleError);\n  }\n\n  protected _addMessageParam(message: MessageParam) {\n    this.messages.push(message);\n  }\n\n  protected _addMessage(message: Message, emit = true) {\n    this.receivedMessages.push(message);\n    if (emit) {\n      this._emit('message', message);\n    }\n  }\n\n  protected async _createMessage(\n    messages: Messages,\n    params: MessageCreateParams,\n    options?: RequestOptions,\n  ): Promise<void> {\n    const signal = options?.signal;\n    let abortHandler: (() => void) | undefined;\n    if (signal) {\n      if (signal.aborted) this.controller.abort();\n      abortHandler = this.controller.abort.bind(this.controller);\n      signal.addEventListener('abort', abortHandler);\n    }\n    try {\n      this.#beginRequest();\n      const { response, data: stream } = await messages\n        .create({ ...params, stream: true }, { ...options, signal: this.controller.signal })\n        .withResponse();\n      this._connected(response);\n      for await (const event of stream) {\n        this.#addStreamEvent(event);\n      }\n      if (stream.controller.signal?.aborted) {\n        throw new APIUserAbortError();\n      }\n      this.#endRequest();\n    } finally {\n      if (signal && abortHandler) {\n        signal.removeEventListener('abort', abortHandler);\n      }\n    }\n  }\n\n  protected _connected(response: Response | null) {\n    if (this.ended) return;\n    this.#response = response;\n    this.#request_id = response?.headers.get('request-id');\n    this.#resolveConnectedPromise(response);\n    this._emit('connect');\n  }\n\n  get ended(): boolean {\n    return this.#ended;\n  }\n\n  get errored(): boolean {\n    return this.#errored;\n  }\n\n  get aborted(): boolean {\n    return this.#aborted;\n  }\n\n  abort() {\n    this.controller.abort();\n  }\n\n  /**\n   * Adds the listener function to the end of the listeners array for the event.\n   * No checks are made to see if the listener has already been added. Multiple calls passing\n   * the same combination of event and listener will result in the listener being added, and\n   * called, multiple times.\n   * @returns this MessageStream, so that calls can be chained\n   */\n  on<Event extends keyof MessageStreamEvents>(event: Event, listener: MessageStreamEvents[Event]): this {\n    const listeners: MessageStreamEventListeners<Event> =\n      this.#listeners[event] || (this.#listeners[event] = []);\n    listeners.push({ listener });\n    return this;\n  }\n\n  /**\n   * Removes the specified listener from the listener array for the event.\n   * off() will remove, at most, one instance of a listener from the listener array. If any single\n   * listener has been added multiple times to the listener array for the specified event, then\n   * off() must be called multiple times to remove each instance.\n   * @returns this MessageStream, so that calls can be chained\n   */\n  off<Event extends keyof MessageStreamEvents>(event: Event, listener: MessageStreamEvents[Event]): this {\n    const listeners = this.#listeners[event];\n    if (!listeners) return this;\n    const index = listeners.findIndex((l) => l.listener === listener);\n    if (index >= 0) listeners.splice(index, 1);\n    return this;\n  }\n\n  /**\n   * Adds a one-time listener function for the event. The next time the event is triggered,\n   * this listener is removed and then invoked.\n   * @returns this MessageStream, so that calls can be chained\n   */\n  once<Event extends keyof MessageStreamEvents>(event: Event, listener: MessageStreamEvents[Event]): this {\n    const listeners: MessageStreamEventListeners<Event> =\n      this.#listeners[event] || (this.#listeners[event] = []);\n    listeners.push({ listener, once: true });\n    return this;\n  }\n\n  /**\n   * This is similar to `.once()`, but returns a Promise that resolves the next time\n   * the event is triggered, instead of calling a listener callback.\n   * @returns a Promise that resolves the next time given event is triggered,\n   * or rejects if an error is emitted.  (If you request the 'error' event,\n   * returns a promise that resolves with the error).\n   *\n   * Example:\n   *\n   *   const message = await stream.emitted('message') // rejects if the stream errors\n   */\n  emitted<Event extends keyof MessageStreamEvents>(\n    event: Event,\n  ): Promise<\n    Parameters<MessageStreamEvents[Event]> extends [infer Param] ? Param\n    : Parameters<MessageStreamEvents[Event]> extends [] ? void\n    : Parameters<MessageStreamEvents[Event]>\n  > {\n    return new Promise((resolve, reject) => {\n      this.#catchingPromiseCreated = true;\n      if (event !== 'error') this.once('error', reject);\n      this.once(event, resolve as any);\n    });\n  }\n\n  async done(): Promise<void> {\n    this.#catchingPromiseCreated = true;\n    await this.#endPromise;\n  }\n\n  get currentMessage(): Message | undefined {\n    return this.#currentMessageSnapshot;\n  }\n\n  #getFinalMessage(): Message {\n    if (this.receivedMessages.length === 0) {\n      throw new AnthropicError('stream ended without producing a Message with role=assistant');\n    }\n    return this.receivedMessages.at(-1)!;\n  }\n\n  /**\n   * @returns a promise that resolves with the the final assistant Message response,\n   * or rejects if an error occurred or the stream ended prematurely without producing a Message.\n   */\n  async finalMessage(): Promise<Message> {\n    await this.done();\n    return this.#getFinalMessage();\n  }\n\n  #getFinalText(): string {\n    if (this.receivedMessages.length === 0) {\n      throw new AnthropicError('stream ended without producing a Message with role=assistant');\n    }\n    const textBlocks = this.receivedMessages\n      .at(-1)!\n      .content.filter((block): block is TextBlock => block.type === 'text')\n      .map((block) => block.text);\n    if (textBlocks.length === 0) {\n      throw new AnthropicError('stream ended without producing a content block with type=text');\n    }\n    return textBlocks.join(' ');\n  }\n\n  /**\n   * @returns a promise that resolves with the the final assistant Message's text response, concatenated\n   * together if there are more than one text blocks.\n   * Rejects if an error occurred or the stream ended prematurely without producing a Message.\n   */\n  async finalText(): Promise<string> {\n    await this.done();\n    return this.#getFinalText();\n  }\n\n  #handleError = (error: unknown) => {\n    this.#errored = true;\n    if (isAbortError(error)) {\n      error = new APIUserAbortError();\n    }\n    if (error instanceof APIUserAbortError) {\n      this.#aborted = true;\n      return this._emit('abort', error);\n    }\n    if (error instanceof AnthropicError) {\n      return this._emit('error', error);\n    }\n    if (error instanceof Error) {\n      const anthropicError: AnthropicError = new AnthropicError(error.message);\n      // @ts-ignore\n      anthropicError.cause = error;\n      return this._emit('error', anthropicError);\n    }\n    return this._emit('error', new AnthropicError(String(error)));\n  };\n\n  protected _emit<Event extends keyof MessageStreamEvents>(\n    event: Event,\n    ...args: Parameters<MessageStreamEvents[Event]>\n  ) {\n    // make sure we don't emit any MessageStreamEvents after end\n    if (this.#ended) return;\n\n    if (event === 'end') {\n      this.#ended = true;\n      this.#resolveEndPromise();\n    }\n\n    const listeners: MessageStreamEventListeners<Event> | undefined = this.#listeners[event];\n    if (listeners) {\n      this.#listeners[event] = listeners.filter((l) => !l.once) as any;\n      listeners.forEach(({ listener }: any) => listener(...args));\n    }\n\n    if (event === 'abort') {\n      const error = args[0] as APIUserAbortError;\n      if (!this.#catchingPromiseCreated && !listeners?.length) {\n        Promise.reject(error);\n      }\n      this.#rejectConnectedPromise(error);\n      this.#rejectEndPromise(error);\n      this._emit('end');\n      return;\n    }\n\n    if (event === 'error') {\n      // NOTE: _emit('error', error) should only be called from #handleError().\n\n      const error = args[0] as AnthropicError;\n      if (!this.#catchingPromiseCreated && !listeners?.length) {\n        // Trigger an unhandled rejection if the user hasn't registered any error handlers.\n        // If you are seeing stack traces here, make sure to handle errors via either:\n        // - runner.on('error', () => ...)\n        // - await runner.done()\n        // - await runner.final...()\n        // - etc.\n        Promise.reject(error);\n      }\n      this.#rejectConnectedPromise(error);\n      this.#rejectEndPromise(error);\n      this._emit('end');\n    }\n  }\n\n  protected _emitFinal() {\n    const finalMessage = this.receivedMessages.at(-1);\n    if (finalMessage) {\n      this._emit('finalMessage', this.#getFinalMessage());\n    }\n  }\n\n  #beginRequest() {\n    if (this.ended) return;\n    this.#currentMessageSnapshot = undefined;\n  }\n  #addStreamEvent(event: MessageStreamEvent) {\n    if (this.ended) return;\n    const messageSnapshot = this.#accumulateMessage(event);\n    this._emit('streamEvent', event, messageSnapshot);\n\n    switch (event.type) {\n      case 'content_block_delta': {\n        const content = messageSnapshot.content.at(-1)!;\n        switch (event.delta.type) {\n          case 'text_delta': {\n            if (content.type === 'text') {\n              this._emit('text', event.delta.text, content.text || '');\n            }\n            break;\n          }\n          case 'citations_delta': {\n            if (content.type === 'text') {\n              this._emit('citation', event.delta.citation, content.citations ?? []);\n            }\n            break;\n          }\n          case 'input_json_delta': {\n            if (tracksToolInput(content) && content.input) {\n              this._emit('inputJson', event.delta.partial_json, content.input);\n            }\n            break;\n          }\n          case 'thinking_delta': {\n            if (content.type === 'thinking') {\n              this._emit('thinking', event.delta.thinking, content.thinking);\n            }\n            break;\n          }\n          case 'signature_delta': {\n            if (content.type === 'thinking') {\n              this._emit('signature', content.signature);\n            }\n            break;\n          }\n          default:\n            checkNever(event.delta);\n        }\n        break;\n      }\n      case 'message_stop': {\n        this._addMessageParam(messageSnapshot);\n        this._addMessage(messageSnapshot, true);\n        break;\n      }\n      case 'content_block_stop': {\n        this._emit('contentBlock', messageSnapshot.content.at(-1)!);\n        break;\n      }\n      case 'message_start': {\n        this.#currentMessageSnapshot = messageSnapshot;\n        break;\n      }\n      case 'content_block_start':\n      case 'message_delta':\n        break;\n    }\n  }\n  #endRequest(): Message {\n    if (this.ended) {\n      throw new AnthropicError(`stream has ended, this shouldn't happen`);\n    }\n    const snapshot = this.#currentMessageSnapshot;\n    if (!snapshot) {\n      throw new AnthropicError(`request ended without sending any chunks`);\n    }\n    this.#currentMessageSnapshot = undefined;\n    return snapshot;\n  }\n\n  protected async _fromReadableStream(\n    readableStream: ReadableStream,\n    options?: RequestOptions,\n  ): Promise<void> {\n    const signal = options?.signal;\n    let abortHandler: (() => void) | undefined;\n    if (signal) {\n      if (signal.aborted) this.controller.abort();\n      abortHandler = this.controller.abort.bind(this.controller);\n      signal.addEventListener('abort', abortHandler);\n    }\n    try {\n      this.#beginRequest();\n      this._connected(null);\n      const stream = Stream.fromReadableStream<MessageStreamEvent>(readableStream, this.controller);\n      for await (const event of stream) {\n        this.#addStreamEvent(event);\n      }\n      if (stream.controller.signal?.aborted) {\n        throw new APIUserAbortError();\n      }\n      this.#endRequest();\n    } finally {\n      if (signal && abortHandler) {\n        signal.removeEventListener('abort', abortHandler);\n      }\n    }\n  }\n\n  /**\n   * Mutates this.#currentMessage with the current event. Handling the accumulation of multiple messages\n   * will be needed to be handled by the caller, this method will throw if you try to accumulate for multiple\n   * messages.\n   */\n  #accumulateMessage(event: MessageStreamEvent): Message {\n    let snapshot = this.#currentMessageSnapshot;\n\n    if (event.type === 'message_start') {\n      if (snapshot) {\n        throw new AnthropicError(`Unexpected event order, got ${event.type} before receiving \"message_stop\"`);\n      }\n      return event.message;\n    }\n\n    if (!snapshot) {\n      throw new AnthropicError(`Unexpected event order, got ${event.type} before \"message_start\"`);\n    }\n\n    switch (event.type) {\n      case 'message_stop':\n        return snapshot;\n      case 'message_delta':\n        snapshot.stop_reason = event.delta.stop_reason;\n        snapshot.stop_sequence = event.delta.stop_sequence;\n        snapshot.usage.output_tokens = event.usage.output_tokens;\n\n        // Update other usage fields if they exist in the event\n        if (event.usage.input_tokens != null) {\n          snapshot.usage.input_tokens = event.usage.input_tokens;\n        }\n\n        if (event.usage.cache_creation_input_tokens != null) {\n          snapshot.usage.cache_creation_input_tokens = event.usage.cache_creation_input_tokens;\n        }\n\n        if (event.usage.cache_read_input_tokens != null) {\n          snapshot.usage.cache_read_input_tokens = event.usage.cache_read_input_tokens;\n        }\n\n        if (event.usage.server_tool_use != null) {\n          snapshot.usage.server_tool_use = event.usage.server_tool_use;\n        }\n\n        return snapshot;\n      case 'content_block_start':\n        snapshot.content.push({ ...event.content_block });\n        return snapshot;\n      case 'content_block_delta': {\n        const snapshotContent = snapshot.content.at(event.index);\n\n        switch (event.delta.type) {\n          case 'text_delta': {\n            if (snapshotContent?.type === 'text') {\n              snapshot.content[event.index] = {\n                ...snapshotContent,\n                text: (snapshotContent.text || '') + event.delta.text,\n              };\n            }\n            break;\n          }\n          case 'citations_delta': {\n            if (snapshotContent?.type === 'text') {\n              snapshot.content[event.index] = {\n                ...snapshotContent,\n                citations: [...(snapshotContent.citations ?? []), event.delta.citation],\n              };\n            }\n            break;\n          }\n          case 'input_json_delta': {\n            if (snapshotContent && tracksToolInput(snapshotContent)) {\n              // we need to keep track of the raw JSON string as well so that we can\n              // re-parse it for each delta, for now we just store it as an untyped\n              // non-enumerable property on the snapshot\n              let jsonBuf = (snapshotContent as any)[JSON_BUF_PROPERTY] || '';\n              jsonBuf += event.delta.partial_json;\n\n              const newContent = { ...snapshotContent };\n              Object.defineProperty(newContent, JSON_BUF_PROPERTY, {\n                value: jsonBuf,\n                enumerable: false,\n                writable: true,\n              });\n\n              if (jsonBuf) {\n                newContent.input = partialParse(jsonBuf);\n              }\n              snapshot.content[event.index] = newContent;\n            }\n            break;\n          }\n          case 'thinking_delta': {\n            if (snapshotContent?.type === 'thinking') {\n              snapshot.content[event.index] = {\n                ...snapshotContent,\n                thinking: snapshotContent.thinking + event.delta.thinking,\n              };\n            }\n            break;\n          }\n          case 'signature_delta': {\n            if (snapshotContent?.type === 'thinking') {\n              snapshot.content[event.index] = {\n                ...snapshotContent,\n                signature: event.delta.signature,\n              };\n            }\n            break;\n          }\n          default:\n            checkNever(event.delta);\n        }\n\n        return snapshot;\n      }\n      case 'content_block_stop':\n        return snapshot;\n    }\n  }\n\n  [Symbol.asyncIterator](): AsyncIterator<MessageStreamEvent> {\n    const pushQueue: MessageStreamEvent[] = [];\n    const readQueue: {\n      resolve: (chunk: MessageStreamEvent | undefined) => void;\n      reject: (error: unknown) => void;\n    }[] = [];\n    let done = false;\n\n    this.on('streamEvent', (event) => {\n      const reader = readQueue.shift();\n      if (reader) {\n        reader.resolve(event);\n      } else {\n        pushQueue.push(event);\n      }\n    });\n\n    this.on('end', () => {\n      done = true;\n      for (const reader of readQueue) {\n        reader.resolve(undefined);\n      }\n      readQueue.length = 0;\n    });\n\n    this.on('abort', (err) => {\n      done = true;\n      for (const reader of readQueue) {\n        reader.reject(err);\n      }\n      readQueue.length = 0;\n    });\n\n    this.on('error', (err) => {\n      done = true;\n      for (const reader of readQueue) {\n        reader.reject(err);\n      }\n      readQueue.length = 0;\n    });\n\n    return {\n      next: async (): Promise<IteratorResult<MessageStreamEvent>> => {\n        if (!pushQueue.length) {\n          if (done) {\n            return { value: undefined, done: true };\n          }\n          return new Promise<MessageStreamEvent | undefined>((resolve, reject) =>\n            readQueue.push({ resolve, reject }),\n          ).then((chunk) => (chunk ? { value: chunk, done: false } : { value: undefined, done: true }));\n        }\n        const chunk = pushQueue.shift()!;\n        return { value: chunk, done: false };\n      },\n      return: async () => {\n        this.abort();\n        return { value: undefined, done: true };\n      },\n    };\n  }\n\n  toReadableStream(): ReadableStream {\n    const stream = new Stream(this[Symbol.asyncIterator].bind(this), this.controller);\n    return stream.toReadableStream();\n  }\n}\n\n// used to ensure exhaustive case matching without throwing a runtime error\nfunction checkNever(x: never) {}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { APIResource } from '../../core/resource';\nimport * as Shared from '../shared';\nimport * as MessagesAPI from './messages';\nimport { APIPromise } from '../../core/api-promise';\nimport { Page, type PageParams, PagePromise } from '../../core/pagination';\nimport { buildHeaders } from '../../internal/headers';\nimport { RequestOptions } from '../../internal/request-options';\nimport { JSONLDecoder } from '../../internal/decoders/jsonl';\nimport { AnthropicError } from '../../error';\nimport { path } from '../../internal/utils/path';\n\nexport class Batches extends APIResource {\n  /**\n   * Send a batch of Message creation requests.\n   *\n   * The Message Batches API can be used to process multiple Messages API requests at\n   * once. Once a Message Batch is created, it begins processing immediately. Batches\n   * can take up to 24 hours to complete.\n   *\n   * Learn more about the Message Batches API in our\n   * [user guide](https://docs.claude.com/en/docs/build-with-claude/batch-processing)\n   *\n   * @example\n   * ```ts\n   * const messageBatch = await client.messages.batches.create({\n   *   requests: [\n   *     {\n   *       custom_id: 'my-custom-id-1',\n   *       params: {\n   *         max_tokens: 1024,\n   *         messages: [\n   *           { content: 'Hello, world', role: 'user' },\n   *         ],\n   *         model: 'claude-sonnet-4-5-20250929',\n   *       },\n   *     },\n   *   ],\n   * });\n   * ```\n   */\n  create(body: BatchCreateParams, options?: RequestOptions): APIPromise<MessageBatch> {\n    return this._client.post('/v1/messages/batches', { body, ...options });\n  }\n\n  /**\n   * This endpoint is idempotent and can be used to poll for Message Batch\n   * completion. To access the results of a Message Batch, make a request to the\n   * `results_url` field in the response.\n   *\n   * Learn more about the Message Batches API in our\n   * [user guide](https://docs.claude.com/en/docs/build-with-claude/batch-processing)\n   *\n   * @example\n   * ```ts\n   * const messageBatch = await client.messages.batches.retrieve(\n   *   'message_batch_id',\n   * );\n   * ```\n   */\n  retrieve(messageBatchID: string, options?: RequestOptions): APIPromise<MessageBatch> {\n    return this._client.get(path`/v1/messages/batches/${messageBatchID}`, options);\n  }\n\n  /**\n   * List all Message Batches within a Workspace. Most recently created batches are\n   * returned first.\n   *\n   * Learn more about the Message Batches API in our\n   * [user guide](https://docs.claude.com/en/docs/build-with-claude/batch-processing)\n   *\n   * @example\n   * ```ts\n   * // Automatically fetches more pages as needed.\n   * for await (const messageBatch of client.messages.batches.list()) {\n   *   // ...\n   * }\n   * ```\n   */\n  list(\n    query: BatchListParams | null | undefined = {},\n    options?: RequestOptions,\n  ): PagePromise<MessageBatchesPage, MessageBatch> {\n    return this._client.getAPIList('/v1/messages/batches', Page<MessageBatch>, { query, ...options });\n  }\n\n  /**\n   * Delete a Message Batch.\n   *\n   * Message Batches can only be deleted once they've finished processing. If you'd\n   * like to delete an in-progress batch, you must first cancel it.\n   *\n   * Learn more about the Message Batches API in our\n   * [user guide](https://docs.claude.com/en/docs/build-with-claude/batch-processing)\n   *\n   * @example\n   * ```ts\n   * const deletedMessageBatch =\n   *   await client.messages.batches.delete('message_batch_id');\n   * ```\n   */\n  delete(messageBatchID: string, options?: RequestOptions): APIPromise<DeletedMessageBatch> {\n    return this._client.delete(path`/v1/messages/batches/${messageBatchID}`, options);\n  }\n\n  /**\n   * Batches may be canceled any time before processing ends. Once cancellation is\n   * initiated, the batch enters a `canceling` state, at which time the system may\n   * complete any in-progress, non-interruptible requests before finalizing\n   * cancellation.\n   *\n   * The number of canceled requests is specified in `request_counts`. To determine\n   * which requests were canceled, check the individual results within the batch.\n   * Note that cancellation may not result in any canceled requests if they were\n   * non-interruptible.\n   *\n   * Learn more about the Message Batches API in our\n   * [user guide](https://docs.claude.com/en/docs/build-with-claude/batch-processing)\n   *\n   * @example\n   * ```ts\n   * const messageBatch = await client.messages.batches.cancel(\n   *   'message_batch_id',\n   * );\n   * ```\n   */\n  cancel(messageBatchID: string, options?: RequestOptions): APIPromise<MessageBatch> {\n    return this._client.post(path`/v1/messages/batches/${messageBatchID}/cancel`, options);\n  }\n\n  /**\n   * Streams the results of a Message Batch as a `.jsonl` file.\n   *\n   * Each line in the file is a JSON object containing the result of a single request\n   * in the Message Batch. Results are not guaranteed to be in the same order as\n   * requests. Use the `custom_id` field to match results to requests.\n   *\n   * Learn more about the Message Batches API in our\n   * [user guide](https://docs.claude.com/en/docs/build-with-claude/batch-processing)\n   *\n   * @example\n   * ```ts\n   * const messageBatchIndividualResponse =\n   *   await client.messages.batches.results('message_batch_id');\n   * ```\n   */\n  async results(\n    messageBatchID: string,\n    options?: RequestOptions,\n  ): Promise<JSONLDecoder<MessageBatchIndividualResponse>> {\n    const batch = await this.retrieve(messageBatchID);\n    if (!batch.results_url) {\n      throw new AnthropicError(\n        `No batch \\`results_url\\`; Has it finished processing? ${batch.processing_status} - ${batch.id}`,\n      );\n    }\n\n    return this._client\n      .get(batch.results_url, {\n        ...options,\n        headers: buildHeaders([{ Accept: 'application/binary' }, options?.headers]),\n        stream: true,\n        __binaryResponse: true,\n      })\n      ._thenUnwrap((_, props) => JSONLDecoder.fromResponse(props.response, props.controller)) as APIPromise<\n      JSONLDecoder<MessageBatchIndividualResponse>\n    >;\n  }\n}\n\nexport type MessageBatchesPage = Page<MessageBatch>;\n\nexport interface DeletedMessageBatch {\n  /**\n   * ID of the Message Batch.\n   */\n  id: string;\n\n  /**\n   * Deleted object type.\n   *\n   * For Message Batches, this is always `\"message_batch_deleted\"`.\n   */\n  type: 'message_batch_deleted';\n}\n\nexport interface MessageBatch {\n  /**\n   * Unique object identifier.\n   *\n   * The format and length of IDs may change over time.\n   */\n  id: string;\n\n  /**\n   * RFC 3339 datetime string representing the time at which the Message Batch was\n   * archived and its results became unavailable.\n   */\n  archived_at: string | null;\n\n  /**\n   * RFC 3339 datetime string representing the time at which cancellation was\n   * initiated for the Message Batch. Specified only if cancellation was initiated.\n   */\n  cancel_initiated_at: string | null;\n\n  /**\n   * RFC 3339 datetime string representing the time at which the Message Batch was\n   * created.\n   */\n  created_at: string;\n\n  /**\n   * RFC 3339 datetime string representing the time at which processing for the\n   * Message Batch ended. Specified only once processing ends.\n   *\n   * Processing ends when every request in a Message Batch has either succeeded,\n   * errored, canceled, or expired.\n   */\n  ended_at: string | null;\n\n  /**\n   * RFC 3339 datetime string representing the time at which the Message Batch will\n   * expire and end processing, which is 24 hours after creation.\n   */\n  expires_at: string;\n\n  /**\n   * Processing status of the Message Batch.\n   */\n  processing_status: 'in_progress' | 'canceling' | 'ended';\n\n  /**\n   * Tallies requests within the Message Batch, categorized by their status.\n   *\n   * Requests start as `processing` and move to one of the other statuses only once\n   * processing of the entire batch ends. The sum of all values always matches the\n   * total number of requests in the batch.\n   */\n  request_counts: MessageBatchRequestCounts;\n\n  /**\n   * URL to a `.jsonl` file containing the results of the Message Batch requests.\n   * Specified only once processing ends.\n   *\n   * Results in the file are not guaranteed to be in the same order as requests. Use\n   * the `custom_id` field to match results to requests.\n   */\n  results_url: string | null;\n\n  /**\n   * Object type.\n   *\n   * For Message Batches, this is always `\"message_batch\"`.\n   */\n  type: 'message_batch';\n}\n\nexport interface MessageBatchCanceledResult {\n  type: 'canceled';\n}\n\nexport interface MessageBatchErroredResult {\n  error: Shared.ErrorResponse;\n\n  type: 'errored';\n}\n\nexport interface MessageBatchExpiredResult {\n  type: 'expired';\n}\n\n/**\n * This is a single line in the response `.jsonl` file and does not represent the\n * response as a whole.\n */\nexport interface MessageBatchIndividualResponse {\n  /**\n   * Developer-provided ID created for each request in a Message Batch. Useful for\n   * matching results to requests, as results may be given out of request order.\n   *\n   * Must be unique for each request within the Message Batch.\n   */\n  custom_id: string;\n\n  /**\n   * Processing result for this request.\n   *\n   * Contains a Message output if processing was successful, an error response if\n   * processing failed, or the reason why processing was not attempted, such as\n   * cancellation or expiration.\n   */\n  result: MessageBatchResult;\n}\n\nexport interface MessageBatchRequestCounts {\n  /**\n   * Number of requests in the Message Batch that have been canceled.\n   *\n   * This is zero until processing of the entire Message Batch has ended.\n   */\n  canceled: number;\n\n  /**\n   * Number of requests in the Message Batch that encountered an error.\n   *\n   * This is zero until processing of the entire Message Batch has ended.\n   */\n  errored: number;\n\n  /**\n   * Number of requests in the Message Batch that have expired.\n   *\n   * This is zero until processing of the entire Message Batch has ended.\n   */\n  expired: number;\n\n  /**\n   * Number of requests in the Message Batch that are processing.\n   */\n  processing: number;\n\n  /**\n   * Number of requests in the Message Batch that have completed successfully.\n   *\n   * This is zero until processing of the entire Message Batch has ended.\n   */\n  succeeded: number;\n}\n\n/**\n * Processing result for this request.\n *\n * Contains a Message output if processing was successful, an error response if\n * processing failed, or the reason why processing was not attempted, such as\n * cancellation or expiration.\n */\nexport type MessageBatchResult =\n  | MessageBatchSucceededResult\n  | MessageBatchErroredResult\n  | MessageBatchCanceledResult\n  | MessageBatchExpiredResult;\n\nexport interface MessageBatchSucceededResult {\n  message: MessagesAPI.Message;\n\n  type: 'succeeded';\n}\n\nexport interface BatchCreateParams {\n  /**\n   * List of requests for prompt completion. Each is an individual request to create\n   * a Message.\n   */\n  requests: Array<BatchCreateParams.Request>;\n}\n\nexport namespace BatchCreateParams {\n  export interface Request {\n    /**\n     * Developer-provided ID created for each request in a Message Batch. Useful for\n     * matching results to requests, as results may be given out of request order.\n     *\n     * Must be unique for each request within the Message Batch.\n     */\n    custom_id: string;\n\n    /**\n     * Messages API creation parameters for the individual request.\n     *\n     * See the [Messages API reference](https://docs.claude.com/en/api/messages) for\n     * full documentation on available parameters.\n     */\n    params: MessagesAPI.MessageCreateParamsNonStreaming;\n  }\n}\n\nexport interface BatchListParams extends PageParams {}\n\nexport declare namespace Batches {\n  export {\n    type DeletedMessageBatch as DeletedMessageBatch,\n    type MessageBatch as MessageBatch,\n    type MessageBatchCanceledResult as MessageBatchCanceledResult,\n    type MessageBatchErroredResult as MessageBatchErroredResult,\n    type MessageBatchExpiredResult as MessageBatchExpiredResult,\n    type MessageBatchIndividualResponse as MessageBatchIndividualResponse,\n    type MessageBatchRequestCounts as MessageBatchRequestCounts,\n    type MessageBatchResult as MessageBatchResult,\n    type MessageBatchSucceededResult as MessageBatchSucceededResult,\n    type MessageBatchesPage as MessageBatchesPage,\n    type BatchCreateParams as BatchCreateParams,\n    type BatchListParams as BatchListParams,\n  };\n}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { APIPromise } from '../../core/api-promise';\nimport { APIResource } from '../../core/resource';\nimport { Stream } from '../../core/streaming';\nimport { RequestOptions } from '../../internal/request-options';\nimport { MessageStream } from '../../lib/MessageStream';\nimport * as BatchesAPI from './batches';\nimport {\n  BatchCreateParams,\n  BatchListParams,\n  Batches,\n  DeletedMessageBatch,\n  MessageBatch,\n  MessageBatchCanceledResult,\n  MessageBatchErroredResult,\n  MessageBatchExpiredResult,\n  MessageBatchIndividualResponse,\n  MessageBatchRequestCounts,\n  MessageBatchResult,\n  MessageBatchSucceededResult,\n  MessageBatchesPage,\n} from './batches';\nimport * as MessagesAPI from './messages';\n\nimport { MODEL_NONSTREAMING_TOKENS } from '../../internal/constants';\n\nexport class Messages extends APIResource {\n  batches: BatchesAPI.Batches = new BatchesAPI.Batches(this._client);\n\n  /**\n   * Send a structured list of input messages with text and/or image content, and the\n   * model will generate the next message in the conversation.\n   *\n   * The Messages API can be used for either single queries or stateless multi-turn\n   * conversations.\n   *\n   * Learn more about the Messages API in our\n   * [user guide](https://docs.claude.com/en/docs/initial-setup)\n   *\n   * @example\n   * ```ts\n   * const message = await client.messages.create({\n   *   max_tokens: 1024,\n   *   messages: [{ content: 'Hello, world', role: 'user' }],\n   *   model: 'claude-sonnet-4-5-20250929',\n   * });\n   * ```\n   */\n  create(body: MessageCreateParamsNonStreaming, options?: RequestOptions): APIPromise<Message>;\n  create(\n    body: MessageCreateParamsStreaming,\n    options?: RequestOptions,\n  ): APIPromise<Stream<RawMessageStreamEvent>>;\n  create(\n    body: MessageCreateParamsBase,\n    options?: RequestOptions,\n  ): APIPromise<Stream<RawMessageStreamEvent> | Message>;\n  create(\n    body: MessageCreateParams,\n    options?: RequestOptions,\n  ): APIPromise<Message> | APIPromise<Stream<RawMessageStreamEvent>> {\n    if (body.model in DEPRECATED_MODELS) {\n      console.warn(\n        `The model '${body.model}' is deprecated and will reach end-of-life on ${\n          DEPRECATED_MODELS[body.model]\n        }\\nPlease migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`,\n      );\n    }\n    let timeout = (this._client as any)._options.timeout as number | null;\n    if (!body.stream && timeout == null) {\n      const maxNonstreamingTokens = MODEL_NONSTREAMING_TOKENS[body.model] ?? undefined;\n      timeout = this._client.calculateNonstreamingTimeout(body.max_tokens, maxNonstreamingTokens);\n    }\n    return this._client.post('/v1/messages', {\n      body,\n      timeout: timeout ?? 600000,\n      ...options,\n      stream: body.stream ?? false,\n    }) as APIPromise<Message> | APIPromise<Stream<RawMessageStreamEvent>>;\n  }\n\n  /**\n   * Create a Message stream\n   */\n  stream(body: MessageStreamParams, options?: RequestOptions): MessageStream {\n    return MessageStream.createMessage(this, body, options);\n  }\n\n  /**\n   * Count the number of tokens in a Message.\n   *\n   * The Token Count API can be used to count the number of tokens in a Message,\n   * including tools, images, and documents, without creating it.\n   *\n   * Learn more about token counting in our\n   * [user guide](https://docs.claude.com/en/docs/build-with-claude/token-counting)\n   *\n   * @example\n   * ```ts\n   * const messageTokensCount =\n   *   await client.messages.countTokens({\n   *     messages: [{ content: 'string', role: 'user' }],\n   *     model: 'claude-opus-4-5-20251101',\n   *   });\n   * ```\n   */\n  countTokens(body: MessageCountTokensParams, options?: RequestOptions): APIPromise<MessageTokensCount> {\n    return this._client.post('/v1/messages/count_tokens', { body, ...options });\n  }\n}\n\nexport interface Base64ImageSource {\n  data: string;\n\n  media_type: 'image/jpeg' | 'image/png' | 'image/gif' | 'image/webp';\n\n  type: 'base64';\n}\n\nexport interface Base64PDFSource {\n  data: string;\n\n  media_type: 'application/pdf';\n\n  type: 'base64';\n}\n\nexport interface CacheControlEphemeral {\n  type: 'ephemeral';\n\n  /**\n   * The time-to-live for the cache control breakpoint.\n   *\n   * This may be one the following values:\n   *\n   * - `5m`: 5 minutes\n   * - `1h`: 1 hour\n   *\n   * Defaults to `5m`.\n   */\n  ttl?: '5m' | '1h';\n}\n\nexport interface CacheCreation {\n  /**\n   * The number of input tokens used to create the 1 hour cache entry.\n   */\n  ephemeral_1h_input_tokens: number;\n\n  /**\n   * The number of input tokens used to create the 5 minute cache entry.\n   */\n  ephemeral_5m_input_tokens: number;\n}\n\nexport interface CitationCharLocation {\n  cited_text: string;\n\n  document_index: number;\n\n  document_title: string | null;\n\n  end_char_index: number;\n\n  file_id: string | null;\n\n  start_char_index: number;\n\n  type: 'char_location';\n}\n\nexport interface CitationCharLocationParam {\n  cited_text: string;\n\n  document_index: number;\n\n  document_title: string | null;\n\n  end_char_index: number;\n\n  start_char_index: number;\n\n  type: 'char_location';\n}\n\nexport interface CitationContentBlockLocation {\n  cited_text: string;\n\n  document_index: number;\n\n  document_title: string | null;\n\n  end_block_index: number;\n\n  file_id: string | null;\n\n  start_block_index: number;\n\n  type: 'content_block_location';\n}\n\nexport interface CitationContentBlockLocationParam {\n  cited_text: string;\n\n  document_index: number;\n\n  document_title: string | null;\n\n  end_block_index: number;\n\n  start_block_index: number;\n\n  type: 'content_block_location';\n}\n\nexport interface CitationPageLocation {\n  cited_text: string;\n\n  document_index: number;\n\n  document_title: string | null;\n\n  end_page_number: number;\n\n  file_id: string | null;\n\n  start_page_number: number;\n\n  type: 'page_location';\n}\n\nexport interface CitationPageLocationParam {\n  cited_text: string;\n\n  document_index: number;\n\n  document_title: string | null;\n\n  end_page_number: number;\n\n  start_page_number: number;\n\n  type: 'page_location';\n}\n\nexport interface CitationSearchResultLocationParam {\n  cited_text: string;\n\n  end_block_index: number;\n\n  search_result_index: number;\n\n  source: string;\n\n  start_block_index: number;\n\n  title: string | null;\n\n  type: 'search_result_location';\n}\n\nexport interface CitationWebSearchResultLocationParam {\n  cited_text: string;\n\n  encrypted_index: string;\n\n  title: string | null;\n\n  type: 'web_search_result_location';\n\n  url: string;\n}\n\nexport interface CitationsConfigParam {\n  enabled?: boolean;\n}\n\nexport interface CitationsDelta {\n  citation:\n    | CitationCharLocation\n    | CitationPageLocation\n    | CitationContentBlockLocation\n    | CitationsWebSearchResultLocation\n    | CitationsSearchResultLocation;\n\n  type: 'citations_delta';\n}\n\nexport interface CitationsSearchResultLocation {\n  cited_text: string;\n\n  end_block_index: number;\n\n  search_result_index: number;\n\n  source: string;\n\n  start_block_index: number;\n\n  title: string | null;\n\n  type: 'search_result_location';\n}\n\nexport interface CitationsWebSearchResultLocation {\n  cited_text: string;\n\n  encrypted_index: string;\n\n  title: string | null;\n\n  type: 'web_search_result_location';\n\n  url: string;\n}\n\nexport type ContentBlock =\n  | TextBlock\n  | ThinkingBlock\n  | RedactedThinkingBlock\n  | ToolUseBlock\n  | ServerToolUseBlock\n  | WebSearchToolResultBlock;\n\n/**\n * Regular text content.\n */\nexport type ContentBlockParam =\n  | TextBlockParam\n  | ImageBlockParam\n  | DocumentBlockParam\n  | SearchResultBlockParam\n  | ThinkingBlockParam\n  | RedactedThinkingBlockParam\n  | ToolUseBlockParam\n  | ToolResultBlockParam\n  | ServerToolUseBlockParam\n  | WebSearchToolResultBlockParam;\n\nexport interface ContentBlockSource {\n  content: string | Array<ContentBlockSourceContent>;\n\n  type: 'content';\n}\n\nexport type ContentBlockSourceContent = TextBlockParam | ImageBlockParam;\n\nexport interface DocumentBlockParam {\n  source: Base64PDFSource | PlainTextSource | ContentBlockSource | URLPDFSource;\n\n  type: 'document';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: CacheControlEphemeral | null;\n\n  citations?: CitationsConfigParam | null;\n\n  context?: string | null;\n\n  title?: string | null;\n}\n\nexport interface ImageBlockParam {\n  source: Base64ImageSource | URLImageSource;\n\n  type: 'image';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: CacheControlEphemeral | null;\n}\n\nexport interface InputJSONDelta {\n  partial_json: string;\n\n  type: 'input_json_delta';\n}\n\nexport interface Message {\n  /**\n   * Unique object identifier.\n   *\n   * The format and length of IDs may change over time.\n   */\n  id: string;\n\n  /**\n   * Content generated by the model.\n   *\n   * This is an array of content blocks, each of which has a `type` that determines\n   * its shape.\n   *\n   * Example:\n   *\n   * ```json\n   * [{ \"type\": \"text\", \"text\": \"Hi, I'm Claude.\" }]\n   * ```\n   *\n   * If the request input `messages` ended with an `assistant` turn, then the\n   * response `content` will continue directly from that last turn. You can use this\n   * to constrain the model's output.\n   *\n   * For example, if the input `messages` were:\n   *\n   * ```json\n   * [\n   *   {\n   *     \"role\": \"user\",\n   *     \"content\": \"What's the Greek name for Sun? (A) Sol (B) Helios (C) Sun\"\n   *   },\n   *   { \"role\": \"assistant\", \"content\": \"The best answer is (\" }\n   * ]\n   * ```\n   *\n   * Then the response `content` might be:\n   *\n   * ```json\n   * [{ \"type\": \"text\", \"text\": \"B)\" }]\n   * ```\n   */\n  content: Array<ContentBlock>;\n\n  /**\n   * The model that will complete your prompt.\\n\\nSee\n   * [models](https://docs.anthropic.com/en/docs/models-overview) for additional\n   * details and options.\n   */\n  model: Model;\n\n  /**\n   * Conversational role of the generated message.\n   *\n   * This will always be `\"assistant\"`.\n   */\n  role: 'assistant';\n\n  /**\n   * The reason that we stopped.\n   *\n   * This may be one the following values:\n   *\n   * - `\"end_turn\"`: the model reached a natural stopping point\n   * - `\"max_tokens\"`: we exceeded the requested `max_tokens` or the model's maximum\n   * - `\"stop_sequence\"`: one of your provided custom `stop_sequences` was generated\n   * - `\"tool_use\"`: the model invoked one or more tools\n   * - `\"pause_turn\"`: we paused a long-running turn. You may provide the response\n   *   back as-is in a subsequent request to let the model continue.\n   * - `\"refusal\"`: when streaming classifiers intervene to handle potential policy\n   *   violations\n   *\n   * In non-streaming mode this value is always non-null. In streaming mode, it is\n   * null in the `message_start` event and non-null otherwise.\n   */\n  stop_reason: StopReason | null;\n\n  /**\n   * Which custom stop sequence was generated, if any.\n   *\n   * This value will be a non-null string if one of your custom stop sequences was\n   * generated.\n   */\n  stop_sequence: string | null;\n\n  /**\n   * Object type.\n   *\n   * For Messages, this is always `\"message\"`.\n   */\n  type: 'message';\n\n  /**\n   * Billing and rate-limit usage.\n   *\n   * Anthropic's API bills and rate-limits by token counts, as tokens represent the\n   * underlying cost to our systems.\n   *\n   * Under the hood, the API transforms requests into a format suitable for the\n   * model. The model's output then goes through a parsing stage before becoming an\n   * API response. As a result, the token counts in `usage` will not match one-to-one\n   * with the exact visible content of an API request or response.\n   *\n   * For example, `output_tokens` will be non-zero, even for an empty string response\n   * from Claude.\n   *\n   * Total input tokens in a request is the summation of `input_tokens`,\n   * `cache_creation_input_tokens`, and `cache_read_input_tokens`.\n   */\n  usage: Usage;\n}\n\nexport type MessageCountTokensTool =\n  | Tool\n  | ToolBash20250124\n  | ToolTextEditor20250124\n  | ToolTextEditor20250429\n  | ToolTextEditor20250728\n  | WebSearchTool20250305;\n\nexport interface MessageDeltaUsage {\n  /**\n   * The cumulative number of input tokens used to create the cache entry.\n   */\n  cache_creation_input_tokens: number | null;\n\n  /**\n   * The cumulative number of input tokens read from the cache.\n   */\n  cache_read_input_tokens: number | null;\n\n  /**\n   * The cumulative number of input tokens which were used.\n   */\n  input_tokens: number | null;\n\n  /**\n   * The cumulative number of output tokens which were used.\n   */\n  output_tokens: number;\n\n  /**\n   * The number of server tool requests.\n   */\n  server_tool_use: ServerToolUsage | null;\n}\n\nexport interface MessageParam {\n  content: string | Array<ContentBlockParam>;\n\n  role: 'user' | 'assistant';\n}\n\nexport interface MessageTokensCount {\n  /**\n   * The total number of tokens across the provided list of messages, system prompt,\n   * and tools.\n   */\n  input_tokens: number;\n}\n\nexport interface Metadata {\n  /**\n   * An external identifier for the user who is associated with the request.\n   *\n   * This should be a uuid, hash value, or other opaque identifier. Anthropic may use\n   * this id to help detect abuse. Do not include any identifying information such as\n   * name, email address, or phone number.\n   */\n  user_id?: string | null;\n}\n\n/**\n * The model that will complete your prompt.\\n\\nSee\n * [models](https://docs.anthropic.com/en/docs/models-overview) for additional\n * details and options.\n */\nexport type Model =\n  | 'claude-opus-4-5-20251101'\n  | 'claude-opus-4-5'\n  | 'claude-3-7-sonnet-latest'\n  | 'claude-3-7-sonnet-20250219'\n  | 'claude-3-5-haiku-latest'\n  | 'claude-3-5-haiku-20241022'\n  | 'claude-haiku-4-5'\n  | 'claude-haiku-4-5-20251001'\n  | 'claude-sonnet-4-20250514'\n  | 'claude-sonnet-4-0'\n  | 'claude-4-sonnet-20250514'\n  | 'claude-sonnet-4-5'\n  | 'claude-sonnet-4-5-20250929'\n  | 'claude-opus-4-0'\n  | 'claude-opus-4-20250514'\n  | 'claude-4-opus-20250514'\n  | 'claude-opus-4-1-20250805'\n  | 'claude-3-opus-latest'\n  | 'claude-3-opus-20240229'\n  | 'claude-3-haiku-20240307'\n  | (string & {});\n\nconst DEPRECATED_MODELS: {\n  [K in Model]?: string;\n} = {\n  'claude-1.3': 'November 6th, 2024',\n  'claude-1.3-100k': 'November 6th, 2024',\n  'claude-instant-1.1': 'November 6th, 2024',\n  'claude-instant-1.1-100k': 'November 6th, 2024',\n  'claude-instant-1.2': 'November 6th, 2024',\n  'claude-3-sonnet-20240229': 'July 21st, 2025',\n  'claude-3-opus-20240229': 'January 5th, 2026',\n  'claude-2.1': 'July 21st, 2025',\n  'claude-2.0': 'July 21st, 2025',\n  'claude-3-7-sonnet-latest': 'February 19th, 2026',\n  'claude-3-7-sonnet-20250219': 'February 19th, 2026',\n};\n\nexport interface PlainTextSource {\n  data: string;\n\n  media_type: 'text/plain';\n\n  type: 'text';\n}\n\nexport type RawContentBlockDelta =\n  | TextDelta\n  | InputJSONDelta\n  | CitationsDelta\n  | ThinkingDelta\n  | SignatureDelta;\n\nexport interface RawContentBlockDeltaEvent {\n  delta: RawContentBlockDelta;\n\n  index: number;\n\n  type: 'content_block_delta';\n}\n\nexport interface RawContentBlockStartEvent {\n  content_block:\n    | TextBlock\n    | ThinkingBlock\n    | RedactedThinkingBlock\n    | ToolUseBlock\n    | ServerToolUseBlock\n    | WebSearchToolResultBlock;\n\n  index: number;\n\n  type: 'content_block_start';\n}\n\nexport interface RawContentBlockStopEvent {\n  index: number;\n\n  type: 'content_block_stop';\n}\n\nexport interface RawMessageDeltaEvent {\n  delta: RawMessageDeltaEvent.Delta;\n\n  type: 'message_delta';\n\n  /**\n   * Billing and rate-limit usage.\n   *\n   * Anthropic's API bills and rate-limits by token counts, as tokens represent the\n   * underlying cost to our systems.\n   *\n   * Under the hood, the API transforms requests into a format suitable for the\n   * model. The model's output then goes through a parsing stage before becoming an\n   * API response. As a result, the token counts in `usage` will not match one-to-one\n   * with the exact visible content of an API request or response.\n   *\n   * For example, `output_tokens` will be non-zero, even for an empty string response\n   * from Claude.\n   *\n   * Total input tokens in a request is the summation of `input_tokens`,\n   * `cache_creation_input_tokens`, and `cache_read_input_tokens`.\n   */\n  usage: MessageDeltaUsage;\n}\n\nexport namespace RawMessageDeltaEvent {\n  export interface Delta {\n    stop_reason: MessagesAPI.StopReason | null;\n\n    stop_sequence: string | null;\n  }\n}\n\nexport interface RawMessageStartEvent {\n  message: Message;\n\n  type: 'message_start';\n}\n\nexport interface RawMessageStopEvent {\n  type: 'message_stop';\n}\n\nexport type RawMessageStreamEvent =\n  | RawMessageStartEvent\n  | RawMessageDeltaEvent\n  | RawMessageStopEvent\n  | RawContentBlockStartEvent\n  | RawContentBlockDeltaEvent\n  | RawContentBlockStopEvent;\n\nexport interface RedactedThinkingBlock {\n  data: string;\n\n  type: 'redacted_thinking';\n}\n\nexport interface RedactedThinkingBlockParam {\n  data: string;\n\n  type: 'redacted_thinking';\n}\n\nexport interface SearchResultBlockParam {\n  content: Array<TextBlockParam>;\n\n  source: string;\n\n  title: string;\n\n  type: 'search_result';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: CacheControlEphemeral | null;\n\n  citations?: CitationsConfigParam;\n}\n\nexport interface ServerToolUsage {\n  /**\n   * The number of web search tool requests.\n   */\n  web_search_requests: number;\n}\n\nexport interface ServerToolUseBlock {\n  id: string;\n\n  input: unknown;\n\n  name: 'web_search';\n\n  type: 'server_tool_use';\n}\n\nexport interface ServerToolUseBlockParam {\n  id: string;\n\n  input: unknown;\n\n  name: 'web_search';\n\n  type: 'server_tool_use';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: CacheControlEphemeral | null;\n}\n\nexport interface SignatureDelta {\n  signature: string;\n\n  type: 'signature_delta';\n}\n\nexport type StopReason = 'end_turn' | 'max_tokens' | 'stop_sequence' | 'tool_use' | 'pause_turn' | 'refusal';\n\nexport interface TextBlock {\n  /**\n   * Citations supporting the text block.\n   *\n   * The type of citation returned will depend on the type of document being cited.\n   * Citing a PDF results in `page_location`, plain text results in `char_location`,\n   * and content document results in `content_block_location`.\n   */\n  citations: Array<TextCitation> | null;\n\n  text: string;\n\n  type: 'text';\n}\n\nexport interface TextBlockParam {\n  text: string;\n\n  type: 'text';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: CacheControlEphemeral | null;\n\n  citations?: Array<TextCitationParam> | null;\n}\n\nexport type TextCitation =\n  | CitationCharLocation\n  | CitationPageLocation\n  | CitationContentBlockLocation\n  | CitationsWebSearchResultLocation\n  | CitationsSearchResultLocation;\n\nexport type TextCitationParam =\n  | CitationCharLocationParam\n  | CitationPageLocationParam\n  | CitationContentBlockLocationParam\n  | CitationWebSearchResultLocationParam\n  | CitationSearchResultLocationParam;\n\nexport interface TextDelta {\n  text: string;\n\n  type: 'text_delta';\n}\n\nexport interface ThinkingBlock {\n  signature: string;\n\n  thinking: string;\n\n  type: 'thinking';\n}\n\nexport interface ThinkingBlockParam {\n  signature: string;\n\n  thinking: string;\n\n  type: 'thinking';\n}\n\nexport interface ThinkingConfigDisabled {\n  type: 'disabled';\n}\n\nexport interface ThinkingConfigEnabled {\n  /**\n   * Determines how many tokens Claude can use for its internal reasoning process.\n   * Larger budgets can enable more thorough analysis for complex problems, improving\n   * response quality.\n   *\n   * Must be \u22651024 and less than `max_tokens`.\n   *\n   * See\n   * [extended thinking](https://docs.claude.com/en/docs/build-with-claude/extended-thinking)\n   * for details.\n   */\n  budget_tokens: number;\n\n  type: 'enabled';\n}\n\n/**\n * Configuration for enabling Claude's extended thinking.\n *\n * When enabled, responses include `thinking` content blocks showing Claude's\n * thinking process before the final answer. Requires a minimum budget of 1,024\n * tokens and counts towards your `max_tokens` limit.\n *\n * See\n * [extended thinking](https://docs.claude.com/en/docs/build-with-claude/extended-thinking)\n * for details.\n */\nexport type ThinkingConfigParam = ThinkingConfigEnabled | ThinkingConfigDisabled;\n\nexport interface ThinkingDelta {\n  thinking: string;\n\n  type: 'thinking_delta';\n}\n\nexport interface Tool {\n  /**\n   * [JSON schema](https://json-schema.org/draft/2020-12) for this tool's input.\n   *\n   * This defines the shape of the `input` that your tool accepts and that the model\n   * will produce.\n   */\n  input_schema: Tool.InputSchema;\n\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: string;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: CacheControlEphemeral | null;\n\n  /**\n   * Description of what this tool does.\n   *\n   * Tool descriptions should be as detailed as possible. The more information that\n   * the model has about what the tool is and how to use it, the better it will\n   * perform. You can use natural language descriptions to reinforce important\n   * aspects of the tool input JSON schema.\n   */\n  description?: string;\n\n  type?: 'custom' | null;\n}\n\nexport namespace Tool {\n  /**\n   * [JSON schema](https://json-schema.org/draft/2020-12) for this tool's input.\n   *\n   * This defines the shape of the `input` that your tool accepts and that the model\n   * will produce.\n   */\n  export interface InputSchema {\n    type: 'object';\n\n    properties?: unknown | null;\n\n    required?: Array<string> | null;\n\n    [k: string]: unknown;\n  }\n}\n\nexport interface ToolBash20250124 {\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'bash';\n\n  type: 'bash_20250124';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: CacheControlEphemeral | null;\n}\n\n/**\n * How the model should use the provided tools. The model can use a specific tool,\n * any available tool, decide by itself, or not use tools at all.\n */\nexport type ToolChoice = ToolChoiceAuto | ToolChoiceAny | ToolChoiceTool | ToolChoiceNone;\n\n/**\n * The model will use any available tools.\n */\nexport interface ToolChoiceAny {\n  type: 'any';\n\n  /**\n   * Whether to disable parallel tool use.\n   *\n   * Defaults to `false`. If set to `true`, the model will output exactly one tool\n   * use.\n   */\n  disable_parallel_tool_use?: boolean;\n}\n\n/**\n * The model will automatically decide whether to use tools.\n */\nexport interface ToolChoiceAuto {\n  type: 'auto';\n\n  /**\n   * Whether to disable parallel tool use.\n   *\n   * Defaults to `false`. If set to `true`, the model will output at most one tool\n   * use.\n   */\n  disable_parallel_tool_use?: boolean;\n}\n\n/**\n * The model will not be allowed to use tools.\n */\nexport interface ToolChoiceNone {\n  type: 'none';\n}\n\n/**\n * The model will use the specified tool with `tool_choice.name`.\n */\nexport interface ToolChoiceTool {\n  /**\n   * The name of the tool to use.\n   */\n  name: string;\n\n  type: 'tool';\n\n  /**\n   * Whether to disable parallel tool use.\n   *\n   * Defaults to `false`. If set to `true`, the model will output exactly one tool\n   * use.\n   */\n  disable_parallel_tool_use?: boolean;\n}\n\nexport interface ToolResultBlockParam {\n  tool_use_id: string;\n\n  type: 'tool_result';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: CacheControlEphemeral | null;\n\n  content?: string | Array<TextBlockParam | ImageBlockParam | SearchResultBlockParam | DocumentBlockParam>;\n\n  is_error?: boolean;\n}\n\nexport interface ToolTextEditor20250124 {\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'str_replace_editor';\n\n  type: 'text_editor_20250124';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: CacheControlEphemeral | null;\n}\n\nexport interface ToolTextEditor20250429 {\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'str_replace_based_edit_tool';\n\n  type: 'text_editor_20250429';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: CacheControlEphemeral | null;\n}\n\nexport interface ToolTextEditor20250728 {\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'str_replace_based_edit_tool';\n\n  type: 'text_editor_20250728';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: CacheControlEphemeral | null;\n\n  /**\n   * Maximum number of characters to display when viewing a file. If not specified,\n   * defaults to displaying the full file.\n   */\n  max_characters?: number | null;\n}\n\nexport type ToolUnion =\n  | Tool\n  | ToolBash20250124\n  | ToolTextEditor20250124\n  | ToolTextEditor20250429\n  | ToolTextEditor20250728\n  | WebSearchTool20250305;\n\nexport interface ToolUseBlock {\n  id: string;\n\n  input: unknown;\n\n  name: string;\n\n  type: 'tool_use';\n}\n\nexport interface ToolUseBlockParam {\n  id: string;\n\n  input: unknown;\n\n  name: string;\n\n  type: 'tool_use';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: CacheControlEphemeral | null;\n}\n\nexport interface URLImageSource {\n  type: 'url';\n\n  url: string;\n}\n\nexport interface URLPDFSource {\n  type: 'url';\n\n  url: string;\n}\n\nexport interface Usage {\n  /**\n   * Breakdown of cached tokens by TTL\n   */\n  cache_creation: CacheCreation | null;\n\n  /**\n   * The number of input tokens used to create the cache entry.\n   */\n  cache_creation_input_tokens: number | null;\n\n  /**\n   * The number of input tokens read from the cache.\n   */\n  cache_read_input_tokens: number | null;\n\n  /**\n   * The number of input tokens which were used.\n   */\n  input_tokens: number;\n\n  /**\n   * The number of output tokens which were used.\n   */\n  output_tokens: number;\n\n  /**\n   * The number of server tool requests.\n   */\n  server_tool_use: ServerToolUsage | null;\n\n  /**\n   * If the request used the priority, standard, or batch tier.\n   */\n  service_tier: 'standard' | 'priority' | 'batch' | null;\n}\n\nexport interface WebSearchResultBlock {\n  encrypted_content: string;\n\n  page_age: string | null;\n\n  title: string;\n\n  type: 'web_search_result';\n\n  url: string;\n}\n\nexport interface WebSearchResultBlockParam {\n  encrypted_content: string;\n\n  title: string;\n\n  type: 'web_search_result';\n\n  url: string;\n\n  page_age?: string | null;\n}\n\nexport interface WebSearchTool20250305 {\n  /**\n   * Name of the tool.\n   *\n   * This is how the tool will be called by the model and in `tool_use` blocks.\n   */\n  name: 'web_search';\n\n  type: 'web_search_20250305';\n\n  /**\n   * If provided, only these domains will be included in results. Cannot be used\n   * alongside `blocked_domains`.\n   */\n  allowed_domains?: Array<string> | null;\n\n  /**\n   * If provided, these domains will never appear in results. Cannot be used\n   * alongside `allowed_domains`.\n   */\n  blocked_domains?: Array<string> | null;\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: CacheControlEphemeral | null;\n\n  /**\n   * Maximum number of times the tool can be used in the API request.\n   */\n  max_uses?: number | null;\n\n  /**\n   * Parameters for the user's location. Used to provide more relevant search\n   * results.\n   */\n  user_location?: WebSearchTool20250305.UserLocation | null;\n}\n\nexport namespace WebSearchTool20250305 {\n  /**\n   * Parameters for the user's location. Used to provide more relevant search\n   * results.\n   */\n  export interface UserLocation {\n    type: 'approximate';\n\n    /**\n     * The city of the user.\n     */\n    city?: string | null;\n\n    /**\n     * The two letter\n     * [ISO country code](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2) of the\n     * user.\n     */\n    country?: string | null;\n\n    /**\n     * The region of the user.\n     */\n    region?: string | null;\n\n    /**\n     * The [IANA timezone](https://nodatime.org/TimeZones) of the user.\n     */\n    timezone?: string | null;\n  }\n}\n\nexport interface WebSearchToolRequestError {\n  error_code:\n    | 'invalid_tool_input'\n    | 'unavailable'\n    | 'max_uses_exceeded'\n    | 'too_many_requests'\n    | 'query_too_long';\n\n  type: 'web_search_tool_result_error';\n}\n\nexport interface WebSearchToolResultBlock {\n  content: WebSearchToolResultBlockContent;\n\n  tool_use_id: string;\n\n  type: 'web_search_tool_result';\n}\n\nexport type WebSearchToolResultBlockContent = WebSearchToolResultError | Array<WebSearchResultBlock>;\n\nexport interface WebSearchToolResultBlockParam {\n  content: WebSearchToolResultBlockParamContent;\n\n  tool_use_id: string;\n\n  type: 'web_search_tool_result';\n\n  /**\n   * Create a cache control breakpoint at this content block.\n   */\n  cache_control?: CacheControlEphemeral | null;\n}\n\nexport type WebSearchToolResultBlockParamContent =\n  | Array<WebSearchResultBlockParam>\n  | WebSearchToolRequestError;\n\nexport interface WebSearchToolResultError {\n  error_code:\n    | 'invalid_tool_input'\n    | 'unavailable'\n    | 'max_uses_exceeded'\n    | 'too_many_requests'\n    | 'query_too_long';\n\n  type: 'web_search_tool_result_error';\n}\n\nexport type MessageStreamEvent = RawMessageStreamEvent;\n\nexport type MessageStartEvent = RawMessageStartEvent;\n\nexport type MessageDeltaEvent = RawMessageDeltaEvent;\n\nexport type MessageStopEvent = RawMessageStopEvent;\n\nexport type ContentBlockStartEvent = RawContentBlockStartEvent;\n\nexport type ContentBlockDeltaEvent = RawContentBlockDeltaEvent;\n\nexport type ContentBlockStopEvent = RawContentBlockStopEvent;\n\nexport type MessageCreateParams = MessageCreateParamsNonStreaming | MessageCreateParamsStreaming;\n\nexport interface MessageCreateParamsBase {\n  /**\n   * The maximum number of tokens to generate before stopping.\n   *\n   * Note that our models may stop _before_ reaching this maximum. This parameter\n   * only specifies the absolute maximum number of tokens to generate.\n   *\n   * Different models have different maximum values for this parameter. See\n   * [models](https://docs.claude.com/en/docs/models-overview) for details.\n   */\n  max_tokens: number;\n\n  /**\n   * Input messages.\n   *\n   * Our models are trained to operate on alternating `user` and `assistant`\n   * conversational turns. When creating a new `Message`, you specify the prior\n   * conversational turns with the `messages` parameter, and the model then generates\n   * the next `Message` in the conversation. Consecutive `user` or `assistant` turns\n   * in your request will be combined into a single turn.\n   *\n   * Each input message must be an object with a `role` and `content`. You can\n   * specify a single `user`-role message, or you can include multiple `user` and\n   * `assistant` messages.\n   *\n   * If the final message uses the `assistant` role, the response content will\n   * continue immediately from the content in that message. This can be used to\n   * constrain part of the model's response.\n   *\n   * Example with a single `user` message:\n   *\n   * ```json\n   * [{ \"role\": \"user\", \"content\": \"Hello, Claude\" }]\n   * ```\n   *\n   * Example with multiple conversational turns:\n   *\n   * ```json\n   * [\n   *   { \"role\": \"user\", \"content\": \"Hello there.\" },\n   *   { \"role\": \"assistant\", \"content\": \"Hi, I'm Claude. How can I help you?\" },\n   *   { \"role\": \"user\", \"content\": \"Can you explain LLMs in plain English?\" }\n   * ]\n   * ```\n   *\n   * Example with a partially-filled response from Claude:\n   *\n   * ```json\n   * [\n   *   {\n   *     \"role\": \"user\",\n   *     \"content\": \"What's the Greek name for Sun? (A) Sol (B) Helios (C) Sun\"\n   *   },\n   *   { \"role\": \"assistant\", \"content\": \"The best answer is (\" }\n   * ]\n   * ```\n   *\n   * Each input message `content` may be either a single `string` or an array of\n   * content blocks, where each block has a specific `type`. Using a `string` for\n   * `content` is shorthand for an array of one content block of type `\"text\"`. The\n   * following input messages are equivalent:\n   *\n   * ```json\n   * { \"role\": \"user\", \"content\": \"Hello, Claude\" }\n   * ```\n   *\n   * ```json\n   * { \"role\": \"user\", \"content\": [{ \"type\": \"text\", \"text\": \"Hello, Claude\" }] }\n   * ```\n   *\n   * See [input examples](https://docs.claude.com/en/api/messages-examples).\n   *\n   * Note that if you want to include a\n   * [system prompt](https://docs.claude.com/en/docs/system-prompts), you can use the\n   * top-level `system` parameter \u2014 there is no `\"system\"` role for input messages in\n   * the Messages API.\n   *\n   * There is a limit of 100,000 messages in a single request.\n   */\n  messages: Array<MessageParam>;\n\n  /**\n   * The model that will complete your prompt.\\n\\nSee\n   * [models](https://docs.anthropic.com/en/docs/models-overview) for additional\n   * details and options.\n   */\n  model: Model;\n\n  /**\n   * An object describing metadata about the request.\n   */\n  metadata?: Metadata;\n\n  /**\n   * Determines whether to use priority capacity (if available) or standard capacity\n   * for this request.\n   *\n   * Anthropic offers different levels of service for your API requests. See\n   * [service-tiers](https://docs.claude.com/en/api/service-tiers) for details.\n   */\n  service_tier?: 'auto' | 'standard_only';\n\n  /**\n   * Custom text sequences that will cause the model to stop generating.\n   *\n   * Our models will normally stop when they have naturally completed their turn,\n   * which will result in a response `stop_reason` of `\"end_turn\"`.\n   *\n   * If you want the model to stop generating when it encounters custom strings of\n   * text, you can use the `stop_sequences` parameter. If the model encounters one of\n   * the custom sequences, the response `stop_reason` value will be `\"stop_sequence\"`\n   * and the response `stop_sequence` value will contain the matched stop sequence.\n   */\n  stop_sequences?: Array<string>;\n\n  /**\n   * Whether to incrementally stream the response using server-sent events.\n   *\n   * See [streaming](https://docs.claude.com/en/api/messages-streaming) for details.\n   */\n  stream?: boolean;\n\n  /**\n   * System prompt.\n   *\n   * A system prompt is a way of providing context and instructions to Claude, such\n   * as specifying a particular goal or role. See our\n   * [guide to system prompts](https://docs.claude.com/en/docs/system-prompts).\n   */\n  system?: string | Array<TextBlockParam>;\n\n  /**\n   * Amount of randomness injected into the response.\n   *\n   * Defaults to `1.0`. Ranges from `0.0` to `1.0`. Use `temperature` closer to `0.0`\n   * for analytical / multiple choice, and closer to `1.0` for creative and\n   * generative tasks.\n   *\n   * Note that even with `temperature` of `0.0`, the results will not be fully\n   * deterministic.\n   */\n  temperature?: number;\n\n  /**\n   * Configuration for enabling Claude's extended thinking.\n   *\n   * When enabled, responses include `thinking` content blocks showing Claude's\n   * thinking process before the final answer. Requires a minimum budget of 1,024\n   * tokens and counts towards your `max_tokens` limit.\n   *\n   * See\n   * [extended thinking](https://docs.claude.com/en/docs/build-with-claude/extended-thinking)\n   * for details.\n   */\n  thinking?: ThinkingConfigParam;\n\n  /**\n   * How the model should use the provided tools. The model can use a specific tool,\n   * any available tool, decide by itself, or not use tools at all.\n   */\n  tool_choice?: ToolChoice;\n\n  /**\n   * Definitions of tools that the model may use.\n   *\n   * If you include `tools` in your API request, the model may return `tool_use`\n   * content blocks that represent the model's use of those tools. You can then run\n   * those tools using the tool input generated by the model and then optionally\n   * return results back to the model using `tool_result` content blocks.\n   *\n   * There are two types of tools: **client tools** and **server tools**. The\n   * behavior described below applies to client tools. For\n   * [server tools](https://docs.claude.com/en/docs/agents-and-tools/tool-use/overview#server-tools),\n   * see their individual documentation as each has its own behavior (e.g., the\n   * [web search tool](https://docs.claude.com/en/docs/agents-and-tools/tool-use/web-search-tool)).\n   *\n   * Each tool definition includes:\n   *\n   * - `name`: Name of the tool.\n   * - `description`: Optional, but strongly-recommended description of the tool.\n   * - `input_schema`: [JSON schema](https://json-schema.org/draft/2020-12) for the\n   *   tool `input` shape that the model will produce in `tool_use` output content\n   *   blocks.\n   *\n   * For example, if you defined `tools` as:\n   *\n   * ```json\n   * [\n   *   {\n   *     \"name\": \"get_stock_price\",\n   *     \"description\": \"Get the current stock price for a given ticker symbol.\",\n   *     \"input_schema\": {\n   *       \"type\": \"object\",\n   *       \"properties\": {\n   *         \"ticker\": {\n   *           \"type\": \"string\",\n   *           \"description\": \"The stock ticker symbol, e.g. AAPL for Apple Inc.\"\n   *         }\n   *       },\n   *       \"required\": [\"ticker\"]\n   *     }\n   *   }\n   * ]\n   * ```\n   *\n   * And then asked the model \"What's the S&P 500 at today?\", the model might produce\n   * `tool_use` content blocks in the response like this:\n   *\n   * ```json\n   * [\n   *   {\n   *     \"type\": \"tool_use\",\n   *     \"id\": \"toolu_01D7FLrfh4GYq7yT1ULFeyMV\",\n   *     \"name\": \"get_stock_price\",\n   *     \"input\": { \"ticker\": \"^GSPC\" }\n   *   }\n   * ]\n   * ```\n   *\n   * You might then run your `get_stock_price` tool with `{\"ticker\": \"^GSPC\"}` as an\n   * input, and return the following back to the model in a subsequent `user`\n   * message:\n   *\n   * ```json\n   * [\n   *   {\n   *     \"type\": \"tool_result\",\n   *     \"tool_use_id\": \"toolu_01D7FLrfh4GYq7yT1ULFeyMV\",\n   *     \"content\": \"259.75 USD\"\n   *   }\n   * ]\n   * ```\n   *\n   * Tools can be used for workflows that include running client-side tools and\n   * functions, or more generally whenever you want the model to produce a particular\n   * JSON structure of output.\n   *\n   * See our [guide](https://docs.claude.com/en/docs/tool-use) for more details.\n   */\n  tools?: Array<ToolUnion>;\n\n  /**\n   * Only sample from the top K options for each subsequent token.\n   *\n   * Used to remove \"long tail\" low probability responses.\n   * [Learn more technical details here](https://towardsdatascience.com/how-to-sample-from-language-models-682bceb97277).\n   *\n   * Recommended for advanced use cases only. You usually only need to use\n   * `temperature`.\n   */\n  top_k?: number;\n\n  /**\n   * Use nucleus sampling.\n   *\n   * In nucleus sampling, we compute the cumulative distribution over all the options\n   * for each subsequent token in decreasing probability order and cut it off once it\n   * reaches a particular probability specified by `top_p`. You should either alter\n   * `temperature` or `top_p`, but not both.\n   *\n   * Recommended for advanced use cases only. You usually only need to use\n   * `temperature`.\n   */\n  top_p?: number;\n}\n\nexport namespace MessageCreateParams {\n  export type MessageCreateParamsNonStreaming = MessagesAPI.MessageCreateParamsNonStreaming;\n  export type MessageCreateParamsStreaming = MessagesAPI.MessageCreateParamsStreaming;\n}\n\nexport interface MessageCreateParamsNonStreaming extends MessageCreateParamsBase {\n  /**\n   * Whether to incrementally stream the response using server-sent events.\n   *\n   * See [streaming](https://docs.claude.com/en/api/messages-streaming) for details.\n   */\n  stream?: false;\n}\n\nexport interface MessageCreateParamsStreaming extends MessageCreateParamsBase {\n  /**\n   * Whether to incrementally stream the response using server-sent events.\n   *\n   * See [streaming](https://docs.claude.com/en/api/messages-streaming) for details.\n   */\n  stream: true;\n}\n\nexport type MessageStreamParams = MessageCreateParamsBase;\n\nexport interface MessageCountTokensParams {\n  /**\n   * Input messages.\n   *\n   * Our models are trained to operate on alternating `user` and `assistant`\n   * conversational turns. When creating a new `Message`, you specify the prior\n   * conversational turns with the `messages` parameter, and the model then generates\n   * the next `Message` in the conversation. Consecutive `user` or `assistant` turns\n   * in your request will be combined into a single turn.\n   *\n   * Each input message must be an object with a `role` and `content`. You can\n   * specify a single `user`-role message, or you can include multiple `user` and\n   * `assistant` messages.\n   *\n   * If the final message uses the `assistant` role, the response content will\n   * continue immediately from the content in that message. This can be used to\n   * constrain part of the model's response.\n   *\n   * Example with a single `user` message:\n   *\n   * ```json\n   * [{ \"role\": \"user\", \"content\": \"Hello, Claude\" }]\n   * ```\n   *\n   * Example with multiple conversational turns:\n   *\n   * ```json\n   * [\n   *   { \"role\": \"user\", \"content\": \"Hello there.\" },\n   *   { \"role\": \"assistant\", \"content\": \"Hi, I'm Claude. How can I help you?\" },\n   *   { \"role\": \"user\", \"content\": \"Can you explain LLMs in plain English?\" }\n   * ]\n   * ```\n   *\n   * Example with a partially-filled response from Claude:\n   *\n   * ```json\n   * [\n   *   {\n   *     \"role\": \"user\",\n   *     \"content\": \"What's the Greek name for Sun? (A) Sol (B) Helios (C) Sun\"\n   *   },\n   *   { \"role\": \"assistant\", \"content\": \"The best answer is (\" }\n   * ]\n   * ```\n   *\n   * Each input message `content` may be either a single `string` or an array of\n   * content blocks, where each block has a specific `type`. Using a `string` for\n   * `content` is shorthand for an array of one content block of type `\"text\"`. The\n   * following input messages are equivalent:\n   *\n   * ```json\n   * { \"role\": \"user\", \"content\": \"Hello, Claude\" }\n   * ```\n   *\n   * ```json\n   * { \"role\": \"user\", \"content\": [{ \"type\": \"text\", \"text\": \"Hello, Claude\" }] }\n   * ```\n   *\n   * See [input examples](https://docs.claude.com/en/api/messages-examples).\n   *\n   * Note that if you want to include a\n   * [system prompt](https://docs.claude.com/en/docs/system-prompts), you can use the\n   * top-level `system` parameter \u2014 there is no `\"system\"` role for input messages in\n   * the Messages API.\n   *\n   * There is a limit of 100,000 messages in a single request.\n   */\n  messages: Array<MessageParam>;\n\n  /**\n   * The model that will complete your prompt.\\n\\nSee\n   * [models](https://docs.anthropic.com/en/docs/models-overview) for additional\n   * details and options.\n   */\n  model: Model;\n\n  /**\n   * System prompt.\n   *\n   * A system prompt is a way of providing context and instructions to Claude, such\n   * as specifying a particular goal or role. See our\n   * [guide to system prompts](https://docs.claude.com/en/docs/system-prompts).\n   */\n  system?: string | Array<TextBlockParam>;\n\n  /**\n   * Configuration for enabling Claude's extended thinking.\n   *\n   * When enabled, responses include `thinking` content blocks showing Claude's\n   * thinking process before the final answer. Requires a minimum budget of 1,024\n   * tokens and counts towards your `max_tokens` limit.\n   *\n   * See\n   * [extended thinking](https://docs.claude.com/en/docs/build-with-claude/extended-thinking)\n   * for details.\n   */\n  thinking?: ThinkingConfigParam;\n\n  /**\n   * How the model should use the provided tools. The model can use a specific tool,\n   * any available tool, decide by itself, or not use tools at all.\n   */\n  tool_choice?: ToolChoice;\n\n  /**\n   * Definitions of tools that the model may use.\n   *\n   * If you include `tools` in your API request, the model may return `tool_use`\n   * content blocks that represent the model's use of those tools. You can then run\n   * those tools using the tool input generated by the model and then optionally\n   * return results back to the model using `tool_result` content blocks.\n   *\n   * There are two types of tools: **client tools** and **server tools**. The\n   * behavior described below applies to client tools. For\n   * [server tools](https://docs.claude.com/en/docs/agents-and-tools/tool-use/overview#server-tools),\n   * see their individual documentation as each has its own behavior (e.g., the\n   * [web search tool](https://docs.claude.com/en/docs/agents-and-tools/tool-use/web-search-tool)).\n   *\n   * Each tool definition includes:\n   *\n   * - `name`: Name of the tool.\n   * - `description`: Optional, but strongly-recommended description of the tool.\n   * - `input_schema`: [JSON schema](https://json-schema.org/draft/2020-12) for the\n   *   tool `input` shape that the model will produce in `tool_use` output content\n   *   blocks.\n   *\n   * For example, if you defined `tools` as:\n   *\n   * ```json\n   * [\n   *   {\n   *     \"name\": \"get_stock_price\",\n   *     \"description\": \"Get the current stock price for a given ticker symbol.\",\n   *     \"input_schema\": {\n   *       \"type\": \"object\",\n   *       \"properties\": {\n   *         \"ticker\": {\n   *           \"type\": \"string\",\n   *           \"description\": \"The stock ticker symbol, e.g. AAPL for Apple Inc.\"\n   *         }\n   *       },\n   *       \"required\": [\"ticker\"]\n   *     }\n   *   }\n   * ]\n   * ```\n   *\n   * And then asked the model \"What's the S&P 500 at today?\", the model might produce\n   * `tool_use` content blocks in the response like this:\n   *\n   * ```json\n   * [\n   *   {\n   *     \"type\": \"tool_use\",\n   *     \"id\": \"toolu_01D7FLrfh4GYq7yT1ULFeyMV\",\n   *     \"name\": \"get_stock_price\",\n   *     \"input\": { \"ticker\": \"^GSPC\" }\n   *   }\n   * ]\n   * ```\n   *\n   * You might then run your `get_stock_price` tool with `{\"ticker\": \"^GSPC\"}` as an\n   * input, and return the following back to the model in a subsequent `user`\n   * message:\n   *\n   * ```json\n   * [\n   *   {\n   *     \"type\": \"tool_result\",\n   *     \"tool_use_id\": \"toolu_01D7FLrfh4GYq7yT1ULFeyMV\",\n   *     \"content\": \"259.75 USD\"\n   *   }\n   * ]\n   * ```\n   *\n   * Tools can be used for workflows that include running client-side tools and\n   * functions, or more generally whenever you want the model to produce a particular\n   * JSON structure of output.\n   *\n   * See our [guide](https://docs.claude.com/en/docs/tool-use) for more details.\n   */\n  tools?: Array<MessageCountTokensTool>;\n}\n\nMessages.Batches = Batches;\n\nexport declare namespace Messages {\n  export {\n    type Base64ImageSource as Base64ImageSource,\n    type Base64PDFSource as Base64PDFSource,\n    type CacheControlEphemeral as CacheControlEphemeral,\n    type CacheCreation as CacheCreation,\n    type CitationCharLocation as CitationCharLocation,\n    type CitationCharLocationParam as CitationCharLocationParam,\n    type CitationContentBlockLocation as CitationContentBlockLocation,\n    type CitationContentBlockLocationParam as CitationContentBlockLocationParam,\n    type CitationPageLocation as CitationPageLocation,\n    type CitationPageLocationParam as CitationPageLocationParam,\n    type CitationSearchResultLocationParam as CitationSearchResultLocationParam,\n    type CitationWebSearchResultLocationParam as CitationWebSearchResultLocationParam,\n    type CitationsConfigParam as CitationsConfigParam,\n    type CitationsDelta as CitationsDelta,\n    type CitationsSearchResultLocation as CitationsSearchResultLocation,\n    type CitationsWebSearchResultLocation as CitationsWebSearchResultLocation,\n    type ContentBlock as ContentBlock,\n    type ContentBlockParam as ContentBlockParam,\n    type ContentBlockStartEvent as ContentBlockStartEvent,\n    type ContentBlockStopEvent as ContentBlockStopEvent,\n    type ContentBlockSource as ContentBlockSource,\n    type ContentBlockSourceContent as ContentBlockSourceContent,\n    type DocumentBlockParam as DocumentBlockParam,\n    type ImageBlockParam as ImageBlockParam,\n    type InputJSONDelta as InputJSONDelta,\n    type Message as Message,\n    type MessageCountTokensTool as MessageCountTokensTool,\n    type MessageDeltaEvent as MessageDeltaEvent,\n    type MessageDeltaUsage as MessageDeltaUsage,\n    type MessageParam as MessageParam,\n    type MessageTokensCount as MessageTokensCount,\n    type Metadata as Metadata,\n    type Model as Model,\n    type PlainTextSource as PlainTextSource,\n    type RawContentBlockDelta as RawContentBlockDelta,\n    type RawContentBlockDeltaEvent as RawContentBlockDeltaEvent,\n    type RawContentBlockStartEvent as RawContentBlockStartEvent,\n    type RawContentBlockStopEvent as RawContentBlockStopEvent,\n    type RawMessageDeltaEvent as RawMessageDeltaEvent,\n    type RawMessageStartEvent as RawMessageStartEvent,\n    type RawMessageStopEvent as RawMessageStopEvent,\n    type RawMessageStreamEvent as RawMessageStreamEvent,\n    type RedactedThinkingBlock as RedactedThinkingBlock,\n    type RedactedThinkingBlockParam as RedactedThinkingBlockParam,\n    type SearchResultBlockParam as SearchResultBlockParam,\n    type ServerToolUsage as ServerToolUsage,\n    type ServerToolUseBlock as ServerToolUseBlock,\n    type ServerToolUseBlockParam as ServerToolUseBlockParam,\n    type SignatureDelta as SignatureDelta,\n    type StopReason as StopReason,\n    type TextBlock as TextBlock,\n    type TextBlockParam as TextBlockParam,\n    type TextCitation as TextCitation,\n    type TextCitationParam as TextCitationParam,\n    type TextDelta as TextDelta,\n    type ThinkingBlock as ThinkingBlock,\n    type ThinkingBlockParam as ThinkingBlockParam,\n    type ThinkingConfigDisabled as ThinkingConfigDisabled,\n    type ThinkingConfigEnabled as ThinkingConfigEnabled,\n    type ThinkingConfigParam as ThinkingConfigParam,\n    type ThinkingDelta as ThinkingDelta,\n    type Tool as Tool,\n    type ToolBash20250124 as ToolBash20250124,\n    type ToolChoice as ToolChoice,\n    type ToolChoiceAny as ToolChoiceAny,\n    type ToolChoiceAuto as ToolChoiceAuto,\n    type ToolChoiceNone as ToolChoiceNone,\n    type ToolChoiceTool as ToolChoiceTool,\n    type ToolResultBlockParam as ToolResultBlockParam,\n    type ToolTextEditor20250124 as ToolTextEditor20250124,\n    type ToolTextEditor20250429 as ToolTextEditor20250429,\n    type ToolTextEditor20250728 as ToolTextEditor20250728,\n    type ToolUnion as ToolUnion,\n    type ToolUseBlock as ToolUseBlock,\n    type ToolUseBlockParam as ToolUseBlockParam,\n    type URLImageSource as URLImageSource,\n    type URLPDFSource as URLPDFSource,\n    type Usage as Usage,\n    type WebSearchResultBlock as WebSearchResultBlock,\n    type WebSearchResultBlockParam as WebSearchResultBlockParam,\n    type WebSearchTool20250305 as WebSearchTool20250305,\n    type WebSearchToolRequestError as WebSearchToolRequestError,\n    type WebSearchToolResultBlock as WebSearchToolResultBlock,\n    type WebSearchToolResultBlockContent as WebSearchToolResultBlockContent,\n    type WebSearchToolResultBlockParam as WebSearchToolResultBlockParam,\n    type WebSearchToolResultBlockParamContent as WebSearchToolResultBlockParamContent,\n    type WebSearchToolResultError as WebSearchToolResultError,\n    type MessageStreamEvent as MessageStreamEvent,\n    type MessageStartEvent as MessageStartEvent,\n    type MessageStopEvent as MessageStopEvent,\n    type ContentBlockDeltaEvent as ContentBlockDeltaEvent,\n    type MessageCreateParams as MessageCreateParams,\n    type MessageCreateParamsNonStreaming as MessageCreateParamsNonStreaming,\n    type MessageCreateParamsStreaming as MessageCreateParamsStreaming,\n    type MessageStreamParams as MessageStreamParams,\n    type MessageCountTokensParams as MessageCountTokensParams,\n  };\n\n  export {\n    Batches as Batches,\n    type DeletedMessageBatch as DeletedMessageBatch,\n    type MessageBatch as MessageBatch,\n    type MessageBatchCanceledResult as MessageBatchCanceledResult,\n    type MessageBatchErroredResult as MessageBatchErroredResult,\n    type MessageBatchExpiredResult as MessageBatchExpiredResult,\n    type MessageBatchIndividualResponse as MessageBatchIndividualResponse,\n    type MessageBatchRequestCounts as MessageBatchRequestCounts,\n    type MessageBatchResult as MessageBatchResult,\n    type MessageBatchSucceededResult as MessageBatchSucceededResult,\n    type MessageBatchesPage as MessageBatchesPage,\n    type BatchCreateParams as BatchCreateParams,\n    type BatchListParams as BatchListParams,\n  };\n}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { APIResource } from '../core/resource';\nimport * as BetaAPI from './beta/beta';\nimport { APIPromise } from '../core/api-promise';\nimport { Page, type PageParams, PagePromise } from '../core/pagination';\nimport { buildHeaders } from '../internal/headers';\nimport { RequestOptions } from '../internal/request-options';\nimport { path } from '../internal/utils/path';\n\nexport class Models extends APIResource {\n  /**\n   * Get a specific model.\n   *\n   * The Models API response can be used to determine information about a specific\n   * model or resolve a model alias to a model ID.\n   */\n  retrieve(\n    modelID: string,\n    params: ModelRetrieveParams | null | undefined = {},\n    options?: RequestOptions,\n  ): APIPromise<ModelInfo> {\n    const { betas } = params ?? {};\n    return this._client.get(path`/v1/models/${modelID}`, {\n      ...options,\n      headers: buildHeaders([\n        { ...(betas?.toString() != null ? { 'anthropic-beta': betas?.toString() } : undefined) },\n        options?.headers,\n      ]),\n    });\n  }\n\n  /**\n   * List available models.\n   *\n   * The Models API response can be used to determine which models are available for\n   * use in the API. More recently released models are listed first.\n   */\n  list(\n    params: ModelListParams | null | undefined = {},\n    options?: RequestOptions,\n  ): PagePromise<ModelInfosPage, ModelInfo> {\n    const { betas, ...query } = params ?? {};\n    return this._client.getAPIList('/v1/models', Page<ModelInfo>, {\n      query,\n      ...options,\n      headers: buildHeaders([\n        { ...(betas?.toString() != null ? { 'anthropic-beta': betas?.toString() } : undefined) },\n        options?.headers,\n      ]),\n    });\n  }\n}\n\nexport type ModelInfosPage = Page<ModelInfo>;\n\nexport interface ModelInfo {\n  /**\n   * Unique model identifier.\n   */\n  id: string;\n\n  /**\n   * RFC 3339 datetime string representing the time at which the model was released.\n   * May be set to an epoch value if the release date is unknown.\n   */\n  created_at: string;\n\n  /**\n   * A human-readable name for the model.\n   */\n  display_name: string;\n\n  /**\n   * Object type.\n   *\n   * For Models, this is always `\"model\"`.\n   */\n  type: 'model';\n}\n\nexport interface ModelRetrieveParams {\n  /**\n   * Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport interface ModelListParams extends PageParams {\n  /**\n   * Header param: Optional header to specify the beta version(s) you want to use.\n   */\n  betas?: Array<BetaAPI.AnthropicBeta>;\n}\n\nexport declare namespace Models {\n  export {\n    type ModelInfo as ModelInfo,\n    type ModelInfosPage as ModelInfosPage,\n    type ModelRetrieveParams as ModelRetrieveParams,\n    type ModelListParams as ModelListParams,\n  };\n}\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\n/**\n * Read an environment variable.\n *\n * Trims beginning and trailing whitespace.\n *\n * Will return undefined if the environment variable doesn't exist or cannot be accessed.\n */\nexport const readEnv = (env: string): string | undefined => {\n  if (typeof (globalThis as any).process !== 'undefined') {\n    return (globalThis as any).process.env?.[env]?.trim() ?? undefined;\n  }\n  if (typeof (globalThis as any).Deno !== 'undefined') {\n    return (globalThis as any).Deno.env?.get?.(env)?.trim();\n  }\n  return undefined;\n};\n", "// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport type { RequestInit, RequestInfo, BodyInit } from './internal/builtin-types';\nimport type { HTTPMethod, PromiseOrValue, MergedRequestInit, FinalizedRequestInit } from './internal/types';\nimport { uuid4 } from './internal/utils/uuid';\nimport { validatePositiveInteger, isAbsoluteURL, safeJSON } from './internal/utils/values';\nimport { sleep } from './internal/utils/sleep';\nexport type { Logger, LogLevel } from './internal/utils/log';\nimport { castToError, isAbortError } from './internal/errors';\nimport type { APIResponseProps } from './internal/parse';\nimport { getPlatformHeaders } from './internal/detect-platform';\nimport * as Shims from './internal/shims';\nimport * as Opts from './internal/request-options';\nimport { VERSION } from './version';\nimport * as Errors from './core/error';\nimport * as Pagination from './core/pagination';\nimport {\n  type PageParams,\n  PageResponse,\n  type PageCursorParams,\n  PageCursorResponse,\n  type TokenPageParams,\n  TokenPageResponse,\n} from './core/pagination';\nimport * as Uploads from './core/uploads';\nimport * as API from './resources/index';\nimport { APIPromise } from './core/api-promise';\nimport {\n  Completion,\n  CompletionCreateParams,\n  CompletionCreateParamsNonStreaming,\n  CompletionCreateParamsStreaming,\n  Completions,\n} from './resources/completions';\nimport { ModelInfo, ModelInfosPage, ModelListParams, ModelRetrieveParams, Models } from './resources/models';\nimport {\n  AnthropicBeta,\n  Beta,\n  BetaAPIError,\n  BetaAuthenticationError,\n  BetaBillingError,\n  BetaError,\n  BetaErrorResponse,\n  BetaGatewayTimeoutError,\n  BetaInvalidRequestError,\n  BetaNotFoundError,\n  BetaOverloadedError,\n  BetaPermissionError,\n  BetaRateLimitError,\n} from './resources/beta/beta';\nimport {\n  Base64ImageSource,\n  Base64PDFSource,\n  CacheControlEphemeral,\n  CacheCreation,\n  CitationCharLocation,\n  CitationCharLocationParam,\n  CitationContentBlockLocation,\n  CitationContentBlockLocationParam,\n  CitationPageLocation,\n  CitationPageLocationParam,\n  CitationSearchResultLocationParam,\n  CitationWebSearchResultLocationParam,\n  CitationsConfigParam,\n  CitationsDelta,\n  CitationsSearchResultLocation,\n  CitationsWebSearchResultLocation,\n  ContentBlock,\n  ContentBlockDeltaEvent,\n  ContentBlockParam,\n  ContentBlockStartEvent,\n  ContentBlockStopEvent,\n  ContentBlockSource,\n  ContentBlockSourceContent,\n  DocumentBlockParam,\n  ImageBlockParam,\n  InputJSONDelta,\n  Message,\n  MessageStreamParams,\n  MessageCountTokensParams,\n  MessageCountTokensTool,\n  MessageCreateParams,\n  MessageCreateParamsNonStreaming,\n  MessageCreateParamsStreaming,\n  MessageDeltaEvent,\n  MessageDeltaUsage,\n  MessageParam,\n  MessageStartEvent,\n  MessageStopEvent,\n  MessageStreamEvent,\n  MessageTokensCount,\n  Messages,\n  Metadata,\n  Model,\n  PlainTextSource,\n  RawContentBlockDelta,\n  RawContentBlockDeltaEvent,\n  RawContentBlockStartEvent,\n  RawContentBlockStopEvent,\n  RawMessageDeltaEvent,\n  RawMessageStartEvent,\n  RawMessageStopEvent,\n  RawMessageStreamEvent,\n  RedactedThinkingBlock,\n  RedactedThinkingBlockParam,\n  SearchResultBlockParam,\n  ServerToolUsage,\n  ServerToolUseBlock,\n  ServerToolUseBlockParam,\n  SignatureDelta,\n  StopReason,\n  TextBlock,\n  TextBlockParam,\n  TextCitation,\n  TextCitationParam,\n  TextDelta,\n  ThinkingBlock,\n  ThinkingBlockParam,\n  ThinkingConfigDisabled,\n  ThinkingConfigEnabled,\n  ThinkingConfigParam,\n  ThinkingDelta,\n  Tool,\n  ToolBash20250124,\n  ToolChoice,\n  ToolChoiceAny,\n  ToolChoiceAuto,\n  ToolChoiceNone,\n  ToolChoiceTool,\n  ToolResultBlockParam,\n  ToolTextEditor20250124,\n  ToolTextEditor20250429,\n  ToolTextEditor20250728,\n  ToolUnion,\n  ToolUseBlock,\n  ToolUseBlockParam,\n  URLImageSource,\n  URLPDFSource,\n  Usage,\n  WebSearchResultBlock,\n  WebSearchResultBlockParam,\n  WebSearchTool20250305,\n  WebSearchToolRequestError,\n  WebSearchToolResultBlock,\n  WebSearchToolResultBlockContent,\n  WebSearchToolResultBlockParam,\n  WebSearchToolResultBlockParamContent,\n  WebSearchToolResultError,\n} from './resources/messages/messages';\nimport { type Fetch } from './internal/builtin-types';\nimport { isRunningInBrowser } from './internal/detect-platform';\nimport { HeadersLike, NullableHeaders, buildHeaders } from './internal/headers';\nimport { FinalRequestOptions, RequestOptions } from './internal/request-options';\nimport { readEnv } from './internal/utils/env';\nimport {\n  type LogLevel,\n  type Logger,\n  formatRequestDetails,\n  loggerFor,\n  parseLogLevel,\n} from './internal/utils/log';\nimport { isEmptyObj } from './internal/utils/values';\n\nexport type ApiKeySetter = () => Promise<string>;\n\nexport interface ClientOptions {\n  /**\n   * API key used for authentication.\n   *\n   * - Accepts either a static string or an async function that resolves to a string.\n   * - Defaults to process.env['ANTHROPIC_API_KEY'].\n   * - When a function is provided, it is invoked before each request so you can rotate\n   *   or refresh credentials at runtime.\n   * - The function must return a non-empty string; otherwise an AnthropicError is thrown.\n   * - If the function throws, the error is wrapped in an AnthropicError with the original\n   *   error available as `cause`.\n   */\n  apiKey?: string | ApiKeySetter | null | undefined;\n\n  /**\n   * Defaults to process.env['ANTHROPIC_AUTH_TOKEN'].\n   */\n  authToken?: string | null | undefined;\n\n  /**\n   * Override the default base URL for the API, e.g., \"https://api.example.com/v2/\"\n   *\n   * Defaults to process.env['ANTHROPIC_BASE_URL'].\n   */\n  baseURL?: string | null | undefined;\n\n  /**\n   * The maximum amount of time (in milliseconds) that the client should wait for a response\n   * from the server before timing out a single request.\n   *\n   * Note that request timeouts are retried by default, so in a worst-case scenario you may wait\n   * much longer than this timeout before the promise succeeds or fails.\n   *\n   * @unit milliseconds\n   */\n  timeout?: number | undefined;\n  /**\n   * Additional `RequestInit` options to be passed to `fetch` calls.\n   * Properties will be overridden by per-request `fetchOptions`.\n   */\n  fetchOptions?: MergedRequestInit | undefined;\n\n  /**\n   * Specify a custom `fetch` function implementation.\n   *\n   * If not provided, we expect that `fetch` is defined globally.\n   */\n  fetch?: Fetch | undefined;\n\n  /**\n   * The maximum number of times that the client will retry a request in case of a\n   * temporary failure, like a network error or a 5XX error from the server.\n   *\n   * @default 2\n   */\n  maxRetries?: number | undefined;\n\n  /**\n   * Default headers to include with every request to the API.\n   *\n   * These can be removed in individual requests by explicitly setting the\n   * header to `null` in request options.\n   */\n  defaultHeaders?: HeadersLike | undefined;\n\n  /**\n   * Default query parameters to include with every request to the API.\n   *\n   * These can be removed in individual requests by explicitly setting the\n   * param to `undefined` in request options.\n   */\n  defaultQuery?: Record<string, string | undefined> | undefined;\n\n  /**\n   * By default, client-side use of this library is not allowed, as it risks exposing your secret API credentials to attackers.\n   * Only set this option to `true` if you understand the risks and have appropriate mitigations in place.\n   */\n  dangerouslyAllowBrowser?: boolean | undefined;\n\n  /**\n   * Set the log level.\n   *\n   * Defaults to process.env['ANTHROPIC_LOG'] or 'warn' if it isn't set.\n   */\n  logLevel?: LogLevel | undefined;\n\n  /**\n   * Set the logger.\n   *\n   * Defaults to globalThis.console.\n   */\n  logger?: Logger | undefined;\n}\n\nexport const HUMAN_PROMPT = '\\\\n\\\\nHuman:';\nexport const AI_PROMPT = '\\\\n\\\\nAssistant:';\n\n/**\n * Base class for Anthropic API clients.\n */\nexport class BaseAnthropic {\n  apiKey: string | null;\n  authToken: string | null;\n\n  baseURL: string;\n  maxRetries: number;\n  timeout: number;\n  logger: Logger;\n  logLevel: LogLevel | undefined;\n  fetchOptions: MergedRequestInit | undefined;\n\n  private fetch: Fetch;\n  #encoder: Opts.RequestEncoder;\n  protected idempotencyHeader?: string;\n  protected _options: ClientOptions;\n\n  /**\n   * API Client for interfacing with the Anthropic API.\n   *\n   * @param {string | null | undefined} [opts.apiKey=process.env['ANTHROPIC_API_KEY'] ?? null]\n   * @param {string | null | undefined} [opts.authToken=process.env['ANTHROPIC_AUTH_TOKEN'] ?? null]\n   * @param {string} [opts.baseURL=process.env['ANTHROPIC_BASE_URL'] ?? https://api.anthropic.com] - Override the default base URL for the API.\n   * @param {number} [opts.timeout=10 minutes] - The maximum amount of time (in milliseconds) the client will wait for a response before timing out.\n   * @param {MergedRequestInit} [opts.fetchOptions] - Additional `RequestInit` options to be passed to `fetch` calls.\n   * @param {Fetch} [opts.fetch] - Specify a custom `fetch` function implementation.\n   * @param {number} [opts.maxRetries=2] - The maximum number of times the client will retry a request.\n   * @param {HeadersLike} opts.defaultHeaders - Default headers to include with every request to the API.\n   * @param {Record<string, string | undefined>} opts.defaultQuery - Default query parameters to include with every request to the API.\n   * @param {boolean} [opts.dangerouslyAllowBrowser=false] - By default, client-side use of this library is not allowed, as it risks exposing your secret API credentials to attackers.\n   */\n  constructor({\n    baseURL = readEnv('ANTHROPIC_BASE_URL'),\n    apiKey = readEnv('ANTHROPIC_API_KEY') ?? null,\n    authToken = readEnv('ANTHROPIC_AUTH_TOKEN') ?? null,\n    ...opts\n  }: ClientOptions = {}) {\n    const options: ClientOptions = {\n      apiKey,\n      authToken,\n      ...opts,\n      baseURL: baseURL || `https://api.anthropic.com`,\n    };\n\n    if (!options.dangerouslyAllowBrowser && isRunningInBrowser()) {\n      throw new Errors.AnthropicError(\n        \"It looks like you're running in a browser-like environment.\\n\\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\\nIf you understand the risks and have appropriate mitigations in place,\\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\\n\\nnew Anthropic({ apiKey, dangerouslyAllowBrowser: true });\\n\",\n      );\n    }\n\n    this.baseURL = options.baseURL!;\n    this.timeout = options.timeout ?? BaseAnthropic.DEFAULT_TIMEOUT /* 10 minutes */;\n    this.logger = options.logger ?? console;\n    const defaultLogLevel = 'warn';\n    // Set default logLevel early so that we can log a warning in parseLogLevel.\n    this.logLevel = defaultLogLevel;\n    this.logLevel =\n      parseLogLevel(options.logLevel, 'ClientOptions.logLevel', this) ??\n      parseLogLevel(readEnv('ANTHROPIC_LOG'), \"process.env['ANTHROPIC_LOG']\", this) ??\n      defaultLogLevel;\n    this.fetchOptions = options.fetchOptions;\n    this.maxRetries = options.maxRetries ?? 2;\n    this.fetch = options.fetch ?? Shims.getDefaultFetch();\n    this.#encoder = Opts.FallbackEncoder;\n\n    this._options = options;\n\n    this.apiKey = typeof apiKey === 'string' ? apiKey : null;\n    this.authToken = authToken;\n  }\n\n  /**\n   * Create a new client instance re-using the same options given to the current client with optional overriding.\n   */\n  withOptions(options: Partial<ClientOptions>): this {\n    const client = new (this.constructor as any as new (props: ClientOptions) => typeof this)({\n      ...this._options,\n      baseURL: this.baseURL,\n      maxRetries: this.maxRetries,\n      timeout: this.timeout,\n      logger: this.logger,\n      logLevel: this.logLevel,\n      fetch: this.fetch,\n      fetchOptions: this.fetchOptions,\n      apiKey: this.apiKey,\n      authToken: this.authToken,\n      ...options,\n    });\n    return client;\n  }\n\n  /**\n   * Check whether the base URL is set to its default.\n   */\n  #baseURLOverridden(): boolean {\n    return this.baseURL !== 'https://api.anthropic.com';\n  }\n\n  protected defaultQuery(): Record<string, string | undefined> | undefined {\n    return this._options.defaultQuery;\n  }\n\n  protected validateHeaders({ values, nulls }: NullableHeaders) {\n    if (values.get('x-api-key') || values.get('authorization')) {\n      return;\n    }\n\n    if (this.apiKey && values.get('x-api-key')) {\n      return;\n    }\n    if (nulls.has('x-api-key')) {\n      return;\n    }\n\n    if (this.authToken && values.get('authorization')) {\n      return;\n    }\n    if (nulls.has('authorization')) {\n      return;\n    }\n\n    throw new Error(\n      'Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the \"X-Api-Key\" or \"Authorization\" headers to be explicitly omitted',\n    );\n  }\n\n  protected async authHeaders(opts: FinalRequestOptions): Promise<NullableHeaders | undefined> {\n    return buildHeaders([await this.apiKeyAuth(opts), await this.bearerAuth(opts)]);\n  }\n\n  protected async apiKeyAuth(opts: FinalRequestOptions): Promise<NullableHeaders | undefined> {\n    if (this.apiKey == null) {\n      return undefined;\n    }\n    return buildHeaders([{ 'X-Api-Key': this.apiKey }]);\n  }\n\n  protected async bearerAuth(opts: FinalRequestOptions): Promise<NullableHeaders | undefined> {\n    if (this.authToken == null) {\n      return undefined;\n    }\n    return buildHeaders([{ Authorization: `Bearer ${this.authToken}` }]);\n  }\n\n  /**\n   * Basic re-implementation of `qs.stringify` for primitive types.\n   */\n  protected stringifyQuery(query: Record<string, unknown>): string {\n    return Object.entries(query)\n      .filter(([_, value]) => typeof value !== 'undefined')\n      .map(([key, value]) => {\n        if (typeof value === 'string' || typeof value === 'number' || typeof value === 'boolean') {\n          return `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;\n        }\n        if (value === null) {\n          return `${encodeURIComponent(key)}=`;\n        }\n        throw new Errors.AnthropicError(\n          `Cannot stringify type ${typeof value}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`,\n        );\n      })\n      .join('&');\n  }\n\n  private getUserAgent(): string {\n    return `${this.constructor.name}/JS ${VERSION}`;\n  }\n\n  protected defaultIdempotencyKey(): string {\n    return `stainless-node-retry-${uuid4()}`;\n  }\n\n  protected makeStatusError(\n    status: number,\n    error: Object,\n    message: string | undefined,\n    headers: Headers,\n  ): Errors.APIError {\n    return Errors.APIError.generate(status, error, message, headers);\n  }\n\n  buildURL(\n    path: string,\n    query: Record<string, unknown> | null | undefined,\n    defaultBaseURL?: string | undefined,\n  ): string {\n    const baseURL = (!this.#baseURLOverridden() && defaultBaseURL) || this.baseURL;\n    const url =\n      isAbsoluteURL(path) ?\n        new URL(path)\n      : new URL(baseURL + (baseURL.endsWith('/') && path.startsWith('/') ? path.slice(1) : path));\n\n    const defaultQuery = this.defaultQuery();\n    if (!isEmptyObj(defaultQuery)) {\n      query = { ...defaultQuery, ...query };\n    }\n\n    if (typeof query === 'object' && query && !Array.isArray(query)) {\n      url.search = this.stringifyQuery(query as Record<string, unknown>);\n    }\n\n    return url.toString();\n  }\n\n  _calculateNonstreamingTimeout(maxTokens: number): number {\n    const defaultTimeout = 10 * 60;\n    const expectedTimeout = (60 * 60 * maxTokens) / 128_000;\n    if (expectedTimeout > defaultTimeout) {\n      throw new Errors.AnthropicError(\n        'Streaming is required for operations that may take longer than 10 minutes. ' +\n          'See https://github.com/anthropics/anthropic-sdk-typescript#streaming-responses for more details',\n      );\n    }\n    return defaultTimeout * 1000;\n  }\n\n  /**\n   * Used as a callback for mutating the given `FinalRequestOptions` object.\n   */\n  protected async prepareOptions(options: FinalRequestOptions): Promise<void> {}\n\n  /**\n   * Used as a callback for mutating the given `RequestInit` object.\n   *\n   * This is useful for cases where you want to add certain headers based off of\n   * the request properties, e.g. `method` or `url`.\n   */\n  protected async prepareRequest(\n    request: RequestInit,\n    { url, options }: { url: string; options: FinalRequestOptions },\n  ): Promise<void> {}\n\n  get<Rsp>(path: string, opts?: PromiseOrValue<RequestOptions>): APIPromise<Rsp> {\n    return this.methodRequest('get', path, opts);\n  }\n\n  post<Rsp>(path: string, opts?: PromiseOrValue<RequestOptions>): APIPromise<Rsp> {\n    return this.methodRequest('post', path, opts);\n  }\n\n  patch<Rsp>(path: string, opts?: PromiseOrValue<RequestOptions>): APIPromise<Rsp> {\n    return this.methodRequest('patch', path, opts);\n  }\n\n  put<Rsp>(path: string, opts?: PromiseOrValue<RequestOptions>): APIPromise<Rsp> {\n    return this.methodRequest('put', path, opts);\n  }\n\n  delete<Rsp>(path: string, opts?: PromiseOrValue<RequestOptions>): APIPromise<Rsp> {\n    return this.methodRequest('delete', path, opts);\n  }\n\n  private methodRequest<Rsp>(\n    method: HTTPMethod,\n    path: string,\n    opts?: PromiseOrValue<RequestOptions>,\n  ): APIPromise<Rsp> {\n    return this.request(\n      Promise.resolve(opts).then((opts) => {\n        return { method, path, ...opts };\n      }),\n    );\n  }\n\n  request<Rsp>(\n    options: PromiseOrValue<FinalRequestOptions>,\n    remainingRetries: number | null = null,\n  ): APIPromise<Rsp> {\n    return new APIPromise(this, this.makeRequest(options, remainingRetries, undefined));\n  }\n\n  private async makeRequest(\n    optionsInput: PromiseOrValue<FinalRequestOptions>,\n    retriesRemaining: number | null,\n    retryOfRequestLogID: string | undefined,\n  ): Promise<APIResponseProps> {\n    const options = await optionsInput;\n    const maxRetries = options.maxRetries ?? this.maxRetries;\n    if (retriesRemaining == null) {\n      retriesRemaining = maxRetries;\n    }\n\n    await this.prepareOptions(options);\n\n    const { req, url, timeout } = await this.buildRequest(options, {\n      retryCount: maxRetries - retriesRemaining,\n    });\n\n    await this.prepareRequest(req, { url, options });\n\n    /** Not an API request ID, just for correlating local log entries. */\n    const requestLogID = 'log_' + ((Math.random() * (1 << 24)) | 0).toString(16).padStart(6, '0');\n    const retryLogStr = retryOfRequestLogID === undefined ? '' : `, retryOf: ${retryOfRequestLogID}`;\n    const startTime = Date.now();\n\n    loggerFor(this).debug(\n      `[${requestLogID}] sending request`,\n      formatRequestDetails({\n        retryOfRequestLogID,\n        method: options.method,\n        url,\n        options,\n        headers: req.headers,\n      }),\n    );\n\n    if (options.signal?.aborted) {\n      throw new Errors.APIUserAbortError();\n    }\n\n    const controller = new AbortController();\n    const response = await this.fetchWithTimeout(url, req, timeout, controller).catch(castToError);\n    const headersTime = Date.now();\n\n    if (response instanceof globalThis.Error) {\n      const retryMessage = `retrying, ${retriesRemaining} attempts remaining`;\n      if (options.signal?.aborted) {\n        throw new Errors.APIUserAbortError();\n      }\n      // detect native connection timeout errors\n      // deno throws \"TypeError: error sending request for url (https://example/): client error (Connect): tcp connect error: Operation timed out (os error 60): Operation timed out (os error 60)\"\n      // undici throws \"TypeError: fetch failed\" with cause \"ConnectTimeoutError: Connect Timeout Error (attempted address: example:443, timeout: 1ms)\"\n      // others do not provide enough information to distinguish timeouts from other connection errors\n      const isTimeout =\n        isAbortError(response) ||\n        /timed? ?out/i.test(String(response) + ('cause' in response ? String(response.cause) : ''));\n      if (retriesRemaining) {\n        loggerFor(this).info(\n          `[${requestLogID}] connection ${isTimeout ? 'timed out' : 'failed'} - ${retryMessage}`,\n        );\n        loggerFor(this).debug(\n          `[${requestLogID}] connection ${isTimeout ? 'timed out' : 'failed'} (${retryMessage})`,\n          formatRequestDetails({\n            retryOfRequestLogID,\n            url,\n            durationMs: headersTime - startTime,\n            message: response.message,\n          }),\n        );\n        return this.retryRequest(options, retriesRemaining, retryOfRequestLogID ?? requestLogID);\n      }\n      loggerFor(this).info(\n        `[${requestLogID}] connection ${isTimeout ? 'timed out' : 'failed'} - error; no more retries left`,\n      );\n      loggerFor(this).debug(\n        `[${requestLogID}] connection ${isTimeout ? 'timed out' : 'failed'} (error; no more retries left)`,\n        formatRequestDetails({\n          retryOfRequestLogID,\n          url,\n          durationMs: headersTime - startTime,\n          message: response.message,\n        }),\n      );\n      if (isTimeout) {\n        throw new Errors.APIConnectionTimeoutError();\n      }\n      throw new Errors.APIConnectionError({ cause: response });\n    }\n\n    const specialHeaders = [...response.headers.entries()]\n      .filter(([name]) => name === 'request-id')\n      .map(([name, value]) => ', ' + name + ': ' + JSON.stringify(value))\n      .join('');\n    const responseInfo = `[${requestLogID}${retryLogStr}${specialHeaders}] ${req.method} ${url} ${\n      response.ok ? 'succeeded' : 'failed'\n    } with status ${response.status} in ${headersTime - startTime}ms`;\n\n    if (!response.ok) {\n      const shouldRetry = await this.shouldRetry(response);\n      if (retriesRemaining && shouldRetry) {\n        const retryMessage = `retrying, ${retriesRemaining} attempts remaining`;\n\n        // We don't need the body of this response.\n        await Shims.CancelReadableStream(response.body);\n        loggerFor(this).info(`${responseInfo} - ${retryMessage}`);\n        loggerFor(this).debug(\n          `[${requestLogID}] response error (${retryMessage})`,\n          formatRequestDetails({\n            retryOfRequestLogID,\n            url: response.url,\n            status: response.status,\n            headers: response.headers,\n            durationMs: headersTime - startTime,\n          }),\n        );\n        return this.retryRequest(\n          options,\n          retriesRemaining,\n          retryOfRequestLogID ?? requestLogID,\n          response.headers,\n        );\n      }\n\n      const retryMessage = shouldRetry ? `error; no more retries left` : `error; not retryable`;\n\n      loggerFor(this).info(`${responseInfo} - ${retryMessage}`);\n\n      const errText = await response.text().catch((err: any) => castToError(err).message);\n      const errJSON = safeJSON(errText);\n      const errMessage = errJSON ? undefined : errText;\n\n      loggerFor(this).debug(\n        `[${requestLogID}] response error (${retryMessage})`,\n        formatRequestDetails({\n          retryOfRequestLogID,\n          url: response.url,\n          status: response.status,\n          headers: response.headers,\n          message: errMessage,\n          durationMs: Date.now() - startTime,\n        }),\n      );\n\n      const err = this.makeStatusError(response.status, errJSON, errMessage, response.headers);\n      throw err;\n    }\n\n    loggerFor(this).info(responseInfo);\n    loggerFor(this).debug(\n      `[${requestLogID}] response start`,\n      formatRequestDetails({\n        retryOfRequestLogID,\n        url: response.url,\n        status: response.status,\n        headers: response.headers,\n        durationMs: headersTime - startTime,\n      }),\n    );\n\n    return { response, options, controller, requestLogID, retryOfRequestLogID, startTime };\n  }\n\n  getAPIList<Item, PageClass extends Pagination.AbstractPage<Item> = Pagination.AbstractPage<Item>>(\n    path: string,\n    Page: new (...args: any[]) => PageClass,\n    opts?: RequestOptions,\n  ): Pagination.PagePromise<PageClass, Item> {\n    return this.requestAPIList(Page, { method: 'get', path, ...opts });\n  }\n\n  requestAPIList<\n    Item = unknown,\n    PageClass extends Pagination.AbstractPage<Item> = Pagination.AbstractPage<Item>,\n  >(\n    Page: new (...args: ConstructorParameters<typeof Pagination.AbstractPage>) => PageClass,\n    options: FinalRequestOptions,\n  ): Pagination.PagePromise<PageClass, Item> {\n    const request = this.makeRequest(options, null, undefined);\n    return new Pagination.PagePromise<PageClass, Item>(this as any as Anthropic, request, Page);\n  }\n\n  async fetchWithTimeout(\n    url: RequestInfo,\n    init: RequestInit | undefined,\n    ms: number,\n    controller: AbortController,\n  ): Promise<Response> {\n    const { signal, method, ...options } = init || {};\n    if (signal) signal.addEventListener('abort', () => controller.abort());\n\n    const timeout = setTimeout(() => controller.abort(), ms);\n\n    const isReadableBody =\n      ((globalThis as any).ReadableStream && options.body instanceof (globalThis as any).ReadableStream) ||\n      (typeof options.body === 'object' && options.body !== null && Symbol.asyncIterator in options.body);\n\n    const fetchOptions: RequestInit = {\n      signal: controller.signal as any,\n      ...(isReadableBody ? { duplex: 'half' } : {}),\n      method: 'GET',\n      ...options,\n    };\n    if (method) {\n      // Custom methods like 'patch' need to be uppercased\n      // See https://github.com/nodejs/undici/issues/2294\n      fetchOptions.method = method.toUpperCase();\n    }\n\n    try {\n      // use undefined this binding; fetch errors if bound to something else in browser/cloudflare\n      return await this.fetch.call(undefined, url, fetchOptions);\n    } finally {\n      clearTimeout(timeout);\n    }\n  }\n\n  private async shouldRetry(response: Response): Promise<boolean> {\n    // Note this is not a standard header.\n    const shouldRetryHeader = response.headers.get('x-should-retry');\n\n    // If the server explicitly says whether or not to retry, obey.\n    if (shouldRetryHeader === 'true') return true;\n    if (shouldRetryHeader === 'false') return false;\n\n    // Retry on request timeouts.\n    if (response.status === 408) return true;\n\n    // Retry on lock timeouts.\n    if (response.status === 409) return true;\n\n    // Retry on rate limits.\n    if (response.status === 429) return true;\n\n    // Retry internal errors.\n    if (response.status >= 500) return true;\n\n    return false;\n  }\n\n  private async retryRequest(\n    options: FinalRequestOptions,\n    retriesRemaining: number,\n    requestLogID: string,\n    responseHeaders?: Headers | undefined,\n  ): Promise<APIResponseProps> {\n    let timeoutMillis: number | undefined;\n\n    // Note the `retry-after-ms` header may not be standard, but is a good idea and we'd like proactive support for it.\n    const retryAfterMillisHeader = responseHeaders?.get('retry-after-ms');\n    if (retryAfterMillisHeader) {\n      const timeoutMs = parseFloat(retryAfterMillisHeader);\n      if (!Number.isNaN(timeoutMs)) {\n        timeoutMillis = timeoutMs;\n      }\n    }\n\n    // About the Retry-After header: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After\n    const retryAfterHeader = responseHeaders?.get('retry-after');\n    if (retryAfterHeader && !timeoutMillis) {\n      const timeoutSeconds = parseFloat(retryAfterHeader);\n      if (!Number.isNaN(timeoutSeconds)) {\n        timeoutMillis = timeoutSeconds * 1000;\n      } else {\n        timeoutMillis = Date.parse(retryAfterHeader) - Date.now();\n      }\n    }\n\n    // If the API asks us to wait a certain amount of time (and it's a reasonable amount),\n    // just do what it says, but otherwise calculate a default\n    if (!(timeoutMillis && 0 <= timeoutMillis && timeoutMillis < 60 * 1000)) {\n      const maxRetries = options.maxRetries ?? this.maxRetries;\n      timeoutMillis = this.calculateDefaultRetryTimeoutMillis(retriesRemaining, maxRetries);\n    }\n    await sleep(timeoutMillis);\n\n    return this.makeRequest(options, retriesRemaining - 1, requestLogID);\n  }\n\n  private calculateDefaultRetryTimeoutMillis(retriesRemaining: number, maxRetries: number): number {\n    const initialRetryDelay = 0.5;\n    const maxRetryDelay = 8.0;\n\n    const numRetries = maxRetries - retriesRemaining;\n\n    // Apply exponential backoff, but not more than the max.\n    const sleepSeconds = Math.min(initialRetryDelay * Math.pow(2, numRetries), maxRetryDelay);\n\n    // Apply some jitter, take up to at most 25 percent of the retry time.\n    const jitter = 1 - Math.random() * 0.25;\n\n    return sleepSeconds * jitter * 1000;\n  }\n\n  public calculateNonstreamingTimeout(maxTokens: number, maxNonstreamingTokens?: number): number {\n    const maxTime = 60 * 60 * 1000; // 60 minutes\n    const defaultTime = 60 * 10 * 1000; // 10 minutes\n\n    const expectedTime = (maxTime * maxTokens) / 128000;\n    if (expectedTime > defaultTime || (maxNonstreamingTokens != null && maxTokens > maxNonstreamingTokens)) {\n      throw new Errors.AnthropicError(\n        'Streaming is required for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#long-requests for more details',\n      );\n    }\n\n    return defaultTime;\n  }\n\n  async buildRequest(\n    inputOptions: FinalRequestOptions,\n    { retryCount = 0 }: { retryCount?: number } = {},\n  ): Promise<{ req: FinalizedRequestInit; url: string; timeout: number }> {\n    const options = { ...inputOptions };\n    const { method, path, query, defaultBaseURL } = options;\n\n    const url = this.buildURL(path!, query as Record<string, unknown>, defaultBaseURL);\n    if ('timeout' in options) validatePositiveInteger('timeout', options.timeout);\n    options.timeout = options.timeout ?? this.timeout;\n    const { bodyHeaders, body } = this.buildBody({ options });\n    const reqHeaders = await this.buildHeaders({ options: inputOptions, method, bodyHeaders, retryCount });\n\n    const req: FinalizedRequestInit = {\n      method,\n      headers: reqHeaders,\n      ...(options.signal && { signal: options.signal }),\n      ...((globalThis as any).ReadableStream &&\n        body instanceof (globalThis as any).ReadableStream && { duplex: 'half' }),\n      ...(body && { body }),\n      ...((this.fetchOptions as any) ?? {}),\n      ...((options.fetchOptions as any) ?? {}),\n    };\n\n    return { req, url, timeout: options.timeout };\n  }\n\n  private async buildHeaders({\n    options,\n    method,\n    bodyHeaders,\n    retryCount,\n  }: {\n    options: FinalRequestOptions;\n    method: HTTPMethod;\n    bodyHeaders: HeadersLike;\n    retryCount: number;\n  }): Promise<Headers> {\n    let idempotencyHeaders: HeadersLike = {};\n    if (this.idempotencyHeader && method !== 'get') {\n      if (!options.idempotencyKey) options.idempotencyKey = this.defaultIdempotencyKey();\n      idempotencyHeaders[this.idempotencyHeader] = options.idempotencyKey;\n    }\n\n    const headers = buildHeaders([\n      idempotencyHeaders,\n      {\n        Accept: 'application/json',\n        'User-Agent': this.getUserAgent(),\n        'X-Stainless-Retry-Count': String(retryCount),\n        ...(options.timeout ? { 'X-Stainless-Timeout': String(Math.trunc(options.timeout / 1000)) } : {}),\n        ...getPlatformHeaders(),\n        ...(this._options.dangerouslyAllowBrowser ?\n          { 'anthropic-dangerous-direct-browser-access': 'true' }\n        : undefined),\n        'anthropic-version': '2023-06-01',\n      },\n      await this.authHeaders(options),\n      this._options.defaultHeaders,\n      bodyHeaders,\n      options.headers,\n    ]);\n\n    this.validateHeaders(headers);\n\n    return headers.values;\n  }\n\n  private buildBody({ options: { body, headers: rawHeaders } }: { options: FinalRequestOptions }): {\n    bodyHeaders: HeadersLike;\n    body: BodyInit | undefined;\n  } {\n    if (!body) {\n      return { bodyHeaders: undefined, body: undefined };\n    }\n    const headers = buildHeaders([rawHeaders]);\n    if (\n      // Pass raw type verbatim\n      ArrayBuffer.isView(body) ||\n      body instanceof ArrayBuffer ||\n      body instanceof DataView ||\n      (typeof body === 'string' &&\n        // Preserve legacy string encoding behavior for now\n        headers.values.has('content-type')) ||\n      // `Blob` is superset of `File`\n      ((globalThis as any).Blob && body instanceof (globalThis as any).Blob) ||\n      // `FormData` -> `multipart/form-data`\n      body instanceof FormData ||\n      // `URLSearchParams` -> `application/x-www-form-urlencoded`\n      body instanceof URLSearchParams ||\n      // Send chunked stream (each chunk has own `length`)\n      ((globalThis as any).ReadableStream && body instanceof (globalThis as any).ReadableStream)\n    ) {\n      return { bodyHeaders: undefined, body: body as BodyInit };\n    } else if (\n      typeof body === 'object' &&\n      (Symbol.asyncIterator in body ||\n        (Symbol.iterator in body && 'next' in body && typeof body.next === 'function'))\n    ) {\n      return { bodyHeaders: undefined, body: Shims.ReadableStreamFrom(body as AsyncIterable<Uint8Array>) };\n    } else {\n      return this.#encoder({ body, headers });\n    }\n  }\n\n  static Anthropic = this;\n  static HUMAN_PROMPT = HUMAN_PROMPT;\n  static AI_PROMPT = AI_PROMPT;\n  static DEFAULT_TIMEOUT = 600000; // 10 minutes\n\n  static AnthropicError = Errors.AnthropicError;\n  static APIError = Errors.APIError;\n  static APIConnectionError = Errors.APIConnectionError;\n  static APIConnectionTimeoutError = Errors.APIConnectionTimeoutError;\n  static APIUserAbortError = Errors.APIUserAbortError;\n  static NotFoundError = Errors.NotFoundError;\n  static ConflictError = Errors.ConflictError;\n  static RateLimitError = Errors.RateLimitError;\n  static BadRequestError = Errors.BadRequestError;\n  static AuthenticationError = Errors.AuthenticationError;\n  static InternalServerError = Errors.InternalServerError;\n  static PermissionDeniedError = Errors.PermissionDeniedError;\n  static UnprocessableEntityError = Errors.UnprocessableEntityError;\n\n  static toFile = Uploads.toFile;\n}\n\n/**\n * API Client for interfacing with the Anthropic API.\n */\nexport class Anthropic extends BaseAnthropic {\n  completions: API.Completions = new API.Completions(this);\n  messages: API.Messages = new API.Messages(this);\n  models: API.Models = new API.Models(this);\n  beta: API.Beta = new API.Beta(this);\n}\n\nAnthropic.Completions = Completions;\nAnthropic.Messages = Messages;\nAnthropic.Models = Models;\nAnthropic.Beta = Beta;\n\nexport declare namespace Anthropic {\n  export type RequestOptions = Opts.RequestOptions;\n\n  export type { ApiKeySetter };\n\n  export import Page = Pagination.Page;\n  export { type PageParams as PageParams, type PageResponse as PageResponse };\n\n  export import TokenPage = Pagination.TokenPage;\n  export { type TokenPageParams as TokenPageParams, type TokenPageResponse as TokenPageResponse };\n\n  export import PageCursor = Pagination.PageCursor;\n  export { type PageCursorParams as PageCursorParams, type PageCursorResponse as PageCursorResponse };\n\n  export {\n    Completions as Completions,\n    type Completion as Completion,\n    type CompletionCreateParams as CompletionCreateParams,\n    type CompletionCreateParamsNonStreaming as CompletionCreateParamsNonStreaming,\n    type CompletionCreateParamsStreaming as CompletionCreateParamsStreaming,\n  };\n\n  export {\n    Messages as Messages,\n    type Base64ImageSource as Base64ImageSource,\n    type Base64PDFSource as Base64PDFSource,\n    type CacheControlEphemeral as CacheControlEphemeral,\n    type CacheCreation as CacheCreation,\n    type CitationCharLocation as CitationCharLocation,\n    type CitationCharLocationParam as CitationCharLocationParam,\n    type CitationContentBlockLocation as CitationContentBlockLocation,\n    type CitationContentBlockLocationParam as CitationContentBlockLocationParam,\n    type CitationPageLocation as CitationPageLocation,\n    type CitationPageLocationParam as CitationPageLocationParam,\n    type CitationSearchResultLocationParam as CitationSearchResultLocationParam,\n    type CitationWebSearchResultLocationParam as CitationWebSearchResultLocationParam,\n    type CitationsConfigParam as CitationsConfigParam,\n    type CitationsDelta as CitationsDelta,\n    type CitationsSearchResultLocation as CitationsSearchResultLocation,\n    type CitationsWebSearchResultLocation as CitationsWebSearchResultLocation,\n    type ContentBlock as ContentBlock,\n    type ContentBlockDeltaEvent as ContentBlockDeltaEvent,\n    type ContentBlockParam as ContentBlockParam,\n    type ContentBlockStartEvent as ContentBlockStartEvent,\n    type ContentBlockStopEvent as ContentBlockStopEvent,\n    type ContentBlockSource as ContentBlockSource,\n    type ContentBlockSourceContent as ContentBlockSourceContent,\n    type DocumentBlockParam as DocumentBlockParam,\n    type ImageBlockParam as ImageBlockParam,\n    type InputJSONDelta as InputJSONDelta,\n    type Message as Message,\n    type MessageCountTokensTool as MessageCountTokensTool,\n    type MessageDeltaEvent as MessageDeltaEvent,\n    type MessageDeltaUsage as MessageDeltaUsage,\n    type MessageParam as MessageParam,\n    type MessageStartEvent as MessageStartEvent,\n    type MessageStopEvent as MessageStopEvent,\n    type MessageStreamEvent as MessageStreamEvent,\n    type MessageTokensCount as MessageTokensCount,\n    type Metadata as Metadata,\n    type Model as Model,\n    type PlainTextSource as PlainTextSource,\n    type RawContentBlockDelta as RawContentBlockDelta,\n    type RawContentBlockDeltaEvent as RawContentBlockDeltaEvent,\n    type RawContentBlockStartEvent as RawContentBlockStartEvent,\n    type RawContentBlockStopEvent as RawContentBlockStopEvent,\n    type RawMessageDeltaEvent as RawMessageDeltaEvent,\n    type RawMessageStartEvent as RawMessageStartEvent,\n    type RawMessageStopEvent as RawMessageStopEvent,\n    type RawMessageStreamEvent as RawMessageStreamEvent,\n    type RedactedThinkingBlock as RedactedThinkingBlock,\n    type RedactedThinkingBlockParam as RedactedThinkingBlockParam,\n    type SearchResultBlockParam as SearchResultBlockParam,\n    type ServerToolUsage as ServerToolUsage,\n    type ServerToolUseBlock as ServerToolUseBlock,\n    type ServerToolUseBlockParam as ServerToolUseBlockParam,\n    type SignatureDelta as SignatureDelta,\n    type StopReason as StopReason,\n    type TextBlock as TextBlock,\n    type TextBlockParam as TextBlockParam,\n    type TextCitation as TextCitation,\n    type TextCitationParam as TextCitationParam,\n    type TextDelta as TextDelta,\n    type ThinkingBlock as ThinkingBlock,\n    type ThinkingBlockParam as ThinkingBlockParam,\n    type ThinkingConfigDisabled as ThinkingConfigDisabled,\n    type ThinkingConfigEnabled as ThinkingConfigEnabled,\n    type ThinkingConfigParam as ThinkingConfigParam,\n    type ThinkingDelta as ThinkingDelta,\n    type Tool as Tool,\n    type ToolBash20250124 as ToolBash20250124,\n    type ToolChoice as ToolChoice,\n    type ToolChoiceAny as ToolChoiceAny,\n    type ToolChoiceAuto as ToolChoiceAuto,\n    type ToolChoiceNone as ToolChoiceNone,\n    type ToolChoiceTool as ToolChoiceTool,\n    type ToolResultBlockParam as ToolResultBlockParam,\n    type ToolTextEditor20250124 as ToolTextEditor20250124,\n    type ToolTextEditor20250429 as ToolTextEditor20250429,\n    type ToolTextEditor20250728 as ToolTextEditor20250728,\n    type ToolUnion as ToolUnion,\n    type ToolUseBlock as ToolUseBlock,\n    type ToolUseBlockParam as ToolUseBlockParam,\n    type URLImageSource as URLImageSource,\n    type URLPDFSource as URLPDFSource,\n    type Usage as Usage,\n    type WebSearchResultBlock as WebSearchResultBlock,\n    type WebSearchResultBlockParam as WebSearchResultBlockParam,\n    type WebSearchTool20250305 as WebSearchTool20250305,\n    type WebSearchToolRequestError as WebSearchToolRequestError,\n    type WebSearchToolResultBlock as WebSearchToolResultBlock,\n    type WebSearchToolResultBlockContent as WebSearchToolResultBlockContent,\n    type WebSearchToolResultBlockParam as WebSearchToolResultBlockParam,\n    type WebSearchToolResultBlockParamContent as WebSearchToolResultBlockParamContent,\n    type WebSearchToolResultError as WebSearchToolResultError,\n    type MessageCreateParams as MessageCreateParams,\n    type MessageCreateParamsNonStreaming as MessageCreateParamsNonStreaming,\n    type MessageCreateParamsStreaming as MessageCreateParamsStreaming,\n    type MessageStreamParams as MessageStreamParams,\n    type MessageCountTokensParams as MessageCountTokensParams,\n  };\n\n  export {\n    Models as Models,\n    type ModelInfo as ModelInfo,\n    type ModelInfosPage as ModelInfosPage,\n    type ModelRetrieveParams as ModelRetrieveParams,\n    type ModelListParams as ModelListParams,\n  };\n\n  export {\n    Beta as Beta,\n    type AnthropicBeta as AnthropicBeta,\n    type BetaAPIError as BetaAPIError,\n    type BetaAuthenticationError as BetaAuthenticationError,\n    type BetaBillingError as BetaBillingError,\n    type BetaError as BetaError,\n    type BetaErrorResponse as BetaErrorResponse,\n    type BetaGatewayTimeoutError as BetaGatewayTimeoutError,\n    type BetaInvalidRequestError as BetaInvalidRequestError,\n    type BetaNotFoundError as BetaNotFoundError,\n    type BetaOverloadedError as BetaOverloadedError,\n    type BetaPermissionError as BetaPermissionError,\n    type BetaRateLimitError as BetaRateLimitError,\n  };\n\n  export type APIErrorObject = API.APIErrorObject;\n  export type AuthenticationError = API.AuthenticationError;\n  export type BillingError = API.BillingError;\n  export type ErrorObject = API.ErrorObject;\n  export type ErrorResponse = API.ErrorResponse;\n  export type GatewayTimeoutError = API.GatewayTimeoutError;\n  export type InvalidRequestError = API.InvalidRequestError;\n  export type NotFoundError = API.NotFoundError;\n  export type OverloadedError = API.OverloadedError;\n  export type PermissionError = API.PermissionError;\n  export type RateLimitError = API.RateLimitError;\n}\n", "import { Hono } from 'hono';\r\nimport { cors } from 'hono/cors';\r\nimport Anthropic from '@anthropic-ai/sdk';\r\n\r\ntype Bindings = {\r\n    DB: D1Database;\r\n    AI: Ai;\r\n    ANTHROPIC_API_KEY: string;\r\n};\r\n\r\nconst app = new Hono<{ Bindings: Bindings }>();\r\n\r\napp.use('/*', cors());\r\n\r\napp.get('/api/search', async (c) => {\r\n    const {\r\n        q,\r\n        mutation,\r\n        disease,\r\n        tag,\r\n        treatment,\r\n        year_start,\r\n        year_end,\r\n        complex_karyotype,\r\n        limit = '50',\r\n        offset = '0'\r\n    } = c.req.query();\r\n\r\n    let query = `\r\n    SELECT DISTINCT s.* \r\n    FROM studies s\r\n  `;\r\n    const params: any[] = [];\r\n    const constraints: string[] = [];\r\n\r\n    // Joins if filtering by related tables\r\n    if (mutation) {\r\n        query += ` JOIN mutations m ON s.id = m.study_id`;\r\n        // If multiple mutations, we might need GROUP BY and HAVING count, but let's assume ANY mutation for now or do \"IN\".\r\n        // Or if filtered by comma separated list \"FLT3,NPM1\" -> IN ('FLT3', 'NPM1')\r\n        const mutations = mutation.split(',').map(m => m.trim());\r\n        constraints.push(`m.gene_symbol IN (${mutations.map(() => '?').join(',')})`);\r\n        params.push(...mutations);\r\n    }\r\n\r\n    if (tag) {\r\n        query += ` JOIN study_topics t ON s.id = t.study_id`;\r\n        const tags = tag.split(',').map(t => t.trim());\r\n        constraints.push(`t.topic_name IN (${tags.map(() => '?').join(',')})`);\r\n        params.push(...tags);\r\n    }\r\n\r\n    if (treatment) {\r\n        query += ` JOIN treatments tr ON s.id = tr.study_id JOIN ref_treatments rt ON tr.treatment_id = rt.id`;\r\n        const treatments = treatment.split(',').map(t => t.trim());\r\n        constraints.push(`rt.code IN (${treatments.map(() => '?').join(',')})`);\r\n        params.push(...treatments);\r\n    }\r\n\r\n    // Text Search\r\n    if (q) {\r\n        constraints.push(`(s.title LIKE ? OR s.abstract LIKE ?)`);\r\n        params.push(`%${q}%`, `%${q}%`);\r\n    }\r\n\r\n    // Disease Subtype\r\n    if (disease) {\r\n        const diseases = disease.split(',').map(d => d.trim());\r\n        // Assuming disease_subtype col is comma-separated or similar, but usage seems to be single or list.\r\n        // If we store it as \"AML,MDS\", we use LIKE.\r\n        const diseaseConditions = diseases.map(() => `s.disease_subtype LIKE ?`).join(' OR ');\r\n        constraints.push(`(${diseaseConditions})`);\r\n        diseases.forEach(d => params.push(`%${d}%`));\r\n    }\r\n\r\n    // Complex Karyotype\r\n    if (complex_karyotype === 'true') {\r\n        constraints.push(`s.has_complex_karyotype = 1`);\r\n    }\r\n\r\n    // Advanced Filters\r\n    const { author, journal, institution } = c.req.query();\r\n\r\n    if (author) {\r\n        constraints.push(`s.authors LIKE ?`);\r\n        params.push(`%${author}%`);\r\n    }\r\n    if (journal) {\r\n        constraints.push(`s.journal LIKE ?`);\r\n        params.push(`%${journal}%`);\r\n    }\r\n    if (institution) {\r\n        constraints.push(`s.affiliations LIKE ?`);\r\n        params.push(`%${institution}%`);\r\n    }\r\n\r\n    // Date Range\r\n    if (year_start) {\r\n        constraints.push(`s.pub_date >= ?`);\r\n        // If it's just a year (4 digits), append start of year. Otherwise assume full date.\r\n        params.push(/^\\d{4}$/.test(year_start) ? `${year_start}-01-01` : year_start);\r\n    }\r\n    if (year_end) {\r\n        constraints.push(`s.pub_date <= ?`);\r\n        // If it's just a year, append end of year.\r\n        params.push(/^\\d{4}$/.test(year_end) ? `${year_end}-12-31` : year_end);\r\n    }\r\n\r\n    if (constraints.length > 0) {\r\n        query += ` WHERE ` + constraints.join(' AND ');\r\n    }\r\n\r\n    query += ` ORDER BY s.pub_date DESC LIMIT ? OFFSET ?`;\r\n    params.push(parseInt(limit), parseInt(offset));\r\n\r\n    try {\r\n        const { results } = await c.env.DB.prepare(query).bind(...params).run();\r\n\r\n        // Create list of IDs to fetch their mutations efficiently\r\n        if (results.length === 0) return c.json([]);\r\n\r\n        const studyIds = results.map((r: any) => r.id);\r\n\r\n        // D1 has a hard limit of 100 parameters per query (not SQLite's 999!)\r\n        // https://developers.cloudflare.com/d1/platform/limits/\r\n        // Using batch size of 50 to stay well below this limit\r\n        const batchSize = 50;\r\n        const mutationsMap: Record<number, string[]> = {};\r\n        const treatmentsMap: Record<number, any[]> = {};\r\n\r\n        // Process study IDs in batches\r\n        for (let i = 0; i < studyIds.length; i += batchSize) {\r\n            const batchIds = studyIds.slice(i, i + batchSize);\r\n            const idsPlaceholder = batchIds.map(() => '?').join(',');\r\n\r\n            try {\r\n                const [mutationsRes, treatmentsRes] = await Promise.all([\r\n                    c.env.DB.prepare(`\r\n                        SELECT study_id, gene_symbol FROM mutations WHERE study_id IN (${idsPlaceholder})\r\n                    `).bind(...batchIds).run(),\r\n                    c.env.DB.prepare(`\r\n                        SELECT tr.study_id, rt.code, rt.name, rt.type \r\n                        FROM treatments tr \r\n                        JOIN ref_treatments rt ON tr.treatment_id = rt.id \r\n                        WHERE tr.study_id IN (${idsPlaceholder})\r\n                    `).bind(...batchIds).run()\r\n                ]);\r\n\r\n                // Merge batch results into maps\r\n                if (mutationsRes.results) {\r\n                    mutationsRes.results.forEach((m: any) => {\r\n                        if (!mutationsMap[m.study_id]) mutationsMap[m.study_id] = [];\r\n                        mutationsMap[m.study_id].push(m.gene_symbol);\r\n                    });\r\n                }\r\n\r\n                if (treatmentsRes.results) {\r\n                    treatmentsRes.results.forEach((t: any) => {\r\n                        if (!treatmentsMap[t.study_id]) treatmentsMap[t.study_id] = [];\r\n                        treatmentsMap[t.study_id].push({ code: t.code, name: t.name, type: t.type });\r\n                    });\r\n                }\r\n            } catch (batchError: any) {\r\n                console.error(`Batch query error for batch starting at ${i}, batchSize: ${batchIds.length}`, batchError);\r\n                throw new Error(`Batch query failed: ${batchError.message} (batch size: ${batchIds.length})`);\r\n            }\r\n        }\r\n\r\n        const enhancedResults = results.map((r: any) => ({\r\n            ...r,\r\n            mutations: mutationsMap[r.id] || [],\r\n            treatments: treatmentsMap[r.id] || []\r\n        }));\r\n\r\n        return c.json(enhancedResults);\r\n    } catch (e: any) {\r\n        return c.json({ error: e.message }, 500);\r\n    }\r\n});\r\n\r\n// NLP-powered query parsing using Workers AI\r\napp.post('/api/parse-query', async (c) => {\r\n    const body = await c.req.json().catch(() => ({}));\r\n    const { query } = body;\r\n\r\n    if (!query || typeof query !== 'string') {\r\n        return c.json({ error: 'Query is required' }, 400);\r\n    }\r\n\r\n    const systemPrompt = `You are a search filter extractor for a leukemia research database.\r\nGiven a natural language query, extract structured filters as JSON.\r\n\r\nAvailable filters:\r\n- q: ONLY for keywords that do NOT match any other filter category below. Do not put gene names, disease names, treatments, or other recognized terms here.\r\n- mutations: gene symbols like FLT3, NPM1, IDH1, IDH2, TP53, DNMT3A, TET2, ASXL1, RUNX1, CEBPA, KRAS, NRAS, WT1, SF3B1, GATA2, BCR-ABL1, PML-RARA, KIT\r\n- diseases: AML (Acute Myeloid Leukemia), ALL (Acute Lymphoblastic Leukemia), CML (Chronic Myeloid Leukemia), CLL (Chronic Lymphocytic Leukemia), MDS (Myelodysplastic Syndromes), MPN (Myeloproliferative Neoplasms), DLBCL, MM\r\n- treatments: chemotherapy drugs and protocols like \"7+3\", azacitidine (AZA), venetoclax (VEN), decitabine, cytarabine, daunorubicin, idarubicin\r\n- tags: study topics like Prognosis, Biomarkers, MRD (Minimal Residual Disease), Clinical Trial, Transplant, Pediatric, Relapsed, Refractory\r\n- yearStart: publication start year (YYYY format)\r\n- yearEnd: publication end year (YYYY format)\r\n- author: author name\r\n- journal: journal name like Blood, Leukemia, JCO, NEJM\r\n\r\nRules:\r\n1. Only include fields that are clearly indicated in the query\r\n2. Use uppercase for gene symbols and disease codes\r\n3. Recognize synonyms: \"venetoclax\" = \"VEN\", \"azacitidine\" = \"AZA\", \"aza\" = \"AZA\"\r\n4. For date ranges like \"from 2020\" use yearStart, \"until 2023\" use yearEnd, \"in 2024\" use both\r\n5. \"recent\" or \"latest\" means yearStart should be current year minus 2\r\n6. NEVER put terms in \"q\" that belong in another filter category - only unrecognized keywords go in \"q\"\r\n7. Respond ONLY with valid JSON object, no explanation or markdown`;\r\n\r\n    try {\r\n        const response = await c.env.AI.run('@cf/meta/llama-2-7b-chat-int8', {\r\n            messages: [\r\n                { role: 'system', content: systemPrompt },\r\n                { role: 'user', content: query }\r\n            ]\r\n        });\r\n\r\n        // Check if we got a valid response\r\n        if (!response || !response.response) {\r\n            throw new Error('No response from AI model');\r\n        }\r\n\r\n        // Extract JSON from response (handle potential markdown wrapping)\r\n        let jsonStr = response.response.trim();\r\n        if (jsonStr.startsWith('```')) {\r\n            jsonStr = jsonStr.replace(/```json?\\n?/g, '').replace(/```$/g, '').trim();\r\n        }\r\n\r\n        const parsed = JSON.parse(jsonStr);\r\n\r\n        return c.json({\r\n            success: true,\r\n            filters: parsed,\r\n            originalQuery: query\r\n        });\r\n    } catch (e: any) {\r\n        console.error('Parse query error:', e);\r\n        return c.json({\r\n            success: false,\r\n            error: 'Failed to parse query. Try being more specific.',\r\n            originalQuery: query\r\n        }, 500);\r\n    }\r\n});\r\n\r\n// AI-powered research insights summarization using Claude\r\napp.post('/api/summarize', async (c) => {\r\n    const body = await c.req.json().catch(() => ({}));\r\n    const { articles, query } = body;\r\n\r\n    if (!articles || !Array.isArray(articles) || articles.length === 0) {\r\n        return c.json({ error: 'No articles provided' }, 400);\r\n    }\r\n\r\n    // Rate Limiting Logic (IP-based, 25 requests per hour)\r\n    const ip = c.req.header('cf-connecting-ip') || 'unknown';\r\n    const now = Math.floor(Date.now() / 1000);\r\n    const oneHourAgo = now - 3600;\r\n\r\n    try {\r\n        const usage = await c.env.DB.prepare(\r\n            'SELECT count, last_reset FROM api_usage WHERE ip = ?'\r\n        ).bind(ip).first<{ count: number, last_reset: number }>();\r\n\r\n        if (usage) {\r\n            if (usage.last_reset < oneHourAgo) {\r\n                // Reset limit\r\n                await c.env.DB.prepare(\r\n                    'UPDATE api_usage SET count = 1, last_reset = ? WHERE ip = ?'\r\n                ).bind(now, ip).run();\r\n            } else if (usage.count >= 25) {\r\n                const waitMinutes = Math.ceil((usage.last_reset + 3600 - now) / 60);\r\n                return c.json({\r\n                    error: `Rate limit exceeded. Please try again in ${waitMinutes} minutes.`,\r\n                    retryAfter: waitMinutes * 60\r\n                }, 429);\r\n            } else {\r\n                // Increment count\r\n                await c.env.DB.prepare(\r\n                    'UPDATE api_usage SET count = count + 1 WHERE ip = ?'\r\n                ).bind(ip).run();\r\n            }\r\n        } else {\r\n            // First time user\r\n            await c.env.DB.prepare(\r\n                'INSERT INTO api_usage (ip, count, last_reset) VALUES (?, 1, ?)'\r\n            ).bind(ip, now).run();\r\n        }\r\n    } catch (dbError) {\r\n        console.error('Rate limit DB error:', dbError);\r\n        // Continue if DB fails (don't block user)\r\n    }\r\n\r\n    // With Claude's 200k context, we can analyze many more articles\r\n    const maxArticles = 50;\r\n    const maxAbstractLength = 3000;\r\n\r\n    const truncatedArticles = articles.slice(0, maxArticles).map((a: any, idx: number) => ({\r\n        num: idx + 1,\r\n        title: a.title || 'Untitled',\r\n        abstract: a.abstract ? a.abstract.substring(0, maxAbstractLength) + (a.abstract.length > maxAbstractLength ? '...' : '') : 'No abstract',\r\n        mutations: Array.isArray(a.mutations) ? a.mutations.join(', ') : '',\r\n        diseases: Array.isArray(a.diseases) ? a.diseases.join(', ') : '',\r\n        treatments: Array.isArray(a.treatments) ? a.treatments.map((t: any) => t.name).join(', ') : '',\r\n        year: a.pub_date?.substring(0, 4) || 'Unknown'\r\n    }));\r\n\r\n    const systemPrompt = `You are a medical research synthesis expert specializing in leukemia and hematological malignancies. Your goal is to provide a high-level scientific synthesis that extracts specific metrics, identifies shared findings across studies, and distinguishes the quality of evidence.\r\n\r\nPlease provide a synthesis with these specific sections:\r\n\r\n## Key Findings & Comparative Efficacy\r\n- Extract specific metrics/stats (e.g., ORR, OS, HR, CI, p-values) whenever available in the abstracts.\r\n- Identify common themes or conflicting results across multiple articles.\r\n- Explicitly distinguish between:\r\n    - **Clinical Evidence**: Findings from randomized controlled trials (RCTs), Phase I/II/III studies, or retrospective patient cohorts.\r\n    - **Laboratory/Pre-clinical**: Findings from \"wet work,\" cell lines, mouse models, or in-vitro molecular studies.\r\n- Cite article numbers for EVERY claim (e.g., \"Combination therapy showed 85% ORR [#1, #4], whereas monotherapy was less effective [#2]\").\r\n\r\n## Therapeutic Landscapes\r\n- Synthesize trends in drug development, dosages, and combinations.\r\n- Note any specific toxicity or safety signals mentioned.\r\n\r\n## Molecular & Biomarker Profiles\r\n- Deep dive into mutation-specific responses or prognostic biomarkers.\r\n- How do genetic profiles influence the outcomes seen in the therapeutic section?\r\n\r\n## Critical Gaps & Evidence Strength\r\n- Which findings are preliminary (lab-only) vs. ready for clinical consideration?\r\n- What specific questions remain unanswered based on the provided data?\r\n\r\nGuidelines:\r\n- Do not just mirror titles; read into the abstracts for data.\r\n- Use scientific but accessible language.\r\n- Use markdown formatting: ## for headers, **bold** for emphasis, and - for bullets.`;\r\n\r\n    const userContent = query\r\n        ? `Research query context: \"${query}\"\\n\\nPlease synthesize insights from the following ${truncatedArticles.length} articles:\\n\\n${JSON.stringify(truncatedArticles, null, 2)}`\r\n        : `Please synthesize insights from the following ${truncatedArticles.length} articles:\\n\\n${JSON.stringify(truncatedArticles, null, 2)}`;\r\n\r\n    try {\r\n        const anthropic = new Anthropic({\r\n            apiKey: c.env.ANTHROPIC_API_KEY,\r\n        });\r\n\r\n        const response = await anthropic.messages.create({\r\n            model: 'claude-3-5-sonnet-latest',\r\n            max_tokens: 8192,\r\n            messages: [\r\n                { role: 'user', content: userContent }\r\n            ],\r\n            system: systemPrompt,\r\n        });\r\n\r\n        const textContent = response.content.find(block => block.type === 'text');\r\n        if (!textContent || textContent.type !== 'text') {\r\n            throw new Error('No text response from Claude');\r\n        }\r\n\r\n        return c.json({\r\n            success: true,\r\n            summary: textContent.text,\r\n            articleCount: truncatedArticles.length,\r\n            totalArticles: articles.length,\r\n            model: 'claude-3-5-sonnet-latest'\r\n        });\r\n    } catch (e: any) {\r\n        console.error('Summarize error:', e);\r\n\r\n        // Fallback to Workers AI if Claude fails\r\n        try {\r\n            const fallbackArticles = articles.slice(0, 15).map((a: any, idx: number) => ({\r\n                num: idx + 1,\r\n                title: a.title?.substring(0, 150) || 'Untitled',\r\n                abstract: a.abstract ? a.abstract.substring(0, 200) + '...' : 'No abstract',\r\n                mutations: Array.isArray(a.mutations) ? a.mutations.join(', ') : '',\r\n                diseases: Array.isArray(a.diseases) ? a.diseases.join(', ') : '',\r\n                year: a.pub_date?.substring(0, 4) || 'Unknown'\r\n            }));\r\n\r\n            const fallbackResponse = await c.env.AI.run('@cf/meta/llama-3-8b-instruct', {\r\n                messages: [\r\n                    { role: 'system', content: 'You are a medical research synthesis expert. Summarize the key findings from these articles briefly.' },\r\n                    { role: 'user', content: JSON.stringify(fallbackArticles, null, 2) }\r\n                ]\r\n            });\r\n\r\n            if (fallbackResponse?.response) {\r\n                return c.json({\r\n                    success: true,\r\n                    summary: fallbackResponse.response,\r\n                    articleCount: fallbackArticles.length,\r\n                    totalArticles: articles.length,\r\n                    model: 'llama-3-8b-instruct (fallback)'\r\n                });\r\n            }\r\n        } catch (fallbackError) {\r\n            console.error('Fallback also failed:', fallbackError);\r\n        }\r\n\r\n        return c.json({\r\n            success: false,\r\n            error: 'Failed to generate summary. Please try again.'\r\n        }, 500);\r\n    }\r\n});\r\n\r\napp.get('/api/export', async (c) => {\r\n    const {\r\n        q,\r\n        mutation,\r\n        disease,\r\n        tag,\r\n        treatment,\r\n        year_start,\r\n        year_end,\r\n        complex_karyotype,\r\n        limit = '1000' // Higher limit for export\r\n    } = c.req.query();\r\n\r\n    let query = `\r\n    SELECT DISTINCT s.* \r\n    FROM studies s\r\n  `;\r\n    const params: any[] = [];\r\n    const constraints: string[] = [];\r\n\r\n    // Joins if filtering by related tables\r\n    if (mutation) {\r\n        query += ` JOIN mutations m ON s.id = m.study_id`;\r\n        const mutations = mutation.split(',').map(m => m.trim());\r\n        constraints.push(`m.gene_symbol IN (${mutations.map(() => '?').join(',')})`);\r\n        params.push(...mutations);\r\n    }\r\n\r\n    if (tag) {\r\n        query += ` JOIN study_topics t ON s.id = t.study_id`;\r\n        const tags = tag.split(',').map(t => t.trim());\r\n        constraints.push(`t.topic_name IN (${tags.map(() => '?').join(',')})`);\r\n        params.push(...tags);\r\n    }\r\n\r\n    if (treatment) {\r\n        query += ` JOIN treatments tr ON s.id = tr.study_id JOIN ref_treatments rt ON tr.treatment_id = rt.id`;\r\n        const treatments = treatment.split(',').map(t => t.trim());\r\n        constraints.push(`rt.code IN (${treatments.map(() => '?').join(',')})`);\r\n        params.push(...treatments);\r\n    }\r\n\r\n    // Text Search\r\n    if (q) {\r\n        constraints.push(`(s.title LIKE ? OR s.abstract LIKE ?)`);\r\n        params.push(`%${q}%`, `%${q}%`);\r\n    }\r\n\r\n    // Disease Subtype\r\n    if (disease) {\r\n        const diseases = disease.split(',').map(d => d.trim());\r\n        const diseaseConditions = diseases.map(() => `s.disease_subtype LIKE ?`).join(' OR ');\r\n        constraints.push(`(${diseaseConditions})`);\r\n        diseases.forEach(d => params.push(`%${d}%`));\r\n    }\r\n\r\n    // Complex Karyotype\r\n    if (complex_karyotype === 'true') {\r\n        constraints.push(`s.has_complex_karyotype = 1`);\r\n    }\r\n\r\n    // Advanced Filters\r\n    const { author, journal, institution } = c.req.query();\r\n\r\n    if (author) {\r\n        constraints.push(`s.authors LIKE ?`);\r\n        params.push(`%${author}%`);\r\n    }\r\n    if (journal) {\r\n        constraints.push(`s.journal LIKE ?`);\r\n        params.push(`%${journal}%`);\r\n    }\r\n    if (institution) {\r\n        constraints.push(`s.affiliations LIKE ?`);\r\n        params.push(`%${institution}%`);\r\n    }\r\n\r\n    // Date Range\r\n    if (year_start) {\r\n        constraints.push(`s.pub_date >= ?`);\r\n        params.push(/^\\d{4}$/.test(year_start) ? `${year_start}-01-01` : year_start);\r\n    }\r\n    if (year_end) {\r\n        constraints.push(`s.pub_date <= ?`);\r\n        params.push(/^\\d{4}$/.test(year_end) ? `${year_end}-12-31` : year_end);\r\n    }\r\n\r\n    if (constraints.length > 0) {\r\n        query += ` WHERE ` + constraints.join(' AND ');\r\n    }\r\n\r\n    query += ` ORDER BY s.pub_date DESC LIMIT ?`;\r\n    params.push(parseInt(limit));\r\n\r\n    try {\r\n        const { results } = await c.env.DB.prepare(query).bind(...params).run();\r\n\r\n        if (results.length === 0) {\r\n            return c.text('No results found', 200, {\r\n                'Content-Type': 'text/csv',\r\n                'Content-Disposition': `attachment; filename=\"leukemialens_export_${new Date().toISOString().split('T')[0]}.csv\"`\r\n            });\r\n        }\r\n\r\n        // Fetch mutations, topics, and treatments for the results\r\n        const studyIds = results.map((r: any) => r.id);\r\n\r\n        // D1 has a hard limit of 100 parameters per query (not SQLite's 999!)\r\n        // https://developers.cloudflare.com/d1/platform/limits/\r\n        // Using batch size of 50 to stay well below this limit\r\n        const batchSize = 50;\r\n        const mutationsMap: Record<number, string[]> = {};\r\n        const topicsMap: Record<number, string[]> = {};\r\n        const treatmentsMap: Record<number, string[]> = {};\r\n\r\n        // Process study IDs in batches\r\n        for (let i = 0; i < studyIds.length; i += batchSize) {\r\n            const batchIds = studyIds.slice(i, i + batchSize);\r\n            const idsPlaceholder = batchIds.map(() => '?').join(',');\r\n\r\n            const [mutationsRes, topicsRes, treatmentsRes] = await Promise.all([\r\n                c.env.DB.prepare(`\r\n                    SELECT study_id, gene_symbol FROM mutations WHERE study_id IN (${idsPlaceholder})\r\n                `).bind(...batchIds).run(),\r\n                c.env.DB.prepare(`\r\n                    SELECT study_id, topic_name FROM study_topics WHERE study_id IN (${idsPlaceholder})\r\n                `).bind(...batchIds).run(),\r\n                c.env.DB.prepare(`\r\n                    SELECT tr.study_id, rt.name\r\n                    FROM treatments tr\r\n                    JOIN ref_treatments rt ON tr.treatment_id = rt.id\r\n                    WHERE tr.study_id IN (${idsPlaceholder})\r\n                `).bind(...batchIds).run()\r\n            ]);\r\n\r\n            // Merge batch results into maps\r\n            mutationsRes.results?.forEach((m: any) => {\r\n                if (!mutationsMap[m.study_id]) mutationsMap[m.study_id] = [];\r\n                mutationsMap[m.study_id].push(m.gene_symbol);\r\n            });\r\n\r\n            topicsRes.results?.forEach((t: any) => {\r\n                if (!topicsMap[t.study_id]) topicsMap[t.study_id] = [];\r\n                topicsMap[t.study_id].push(t.topic_name);\r\n            });\r\n\r\n            treatmentsRes.results?.forEach((t: any) => {\r\n                if (!treatmentsMap[t.study_id]) treatmentsMap[t.study_id] = [];\r\n                treatmentsMap[t.study_id].push(t.name);\r\n            });\r\n        }\r\n\r\n        // Convert to CSV\r\n        const headers = ['ID', 'Title', 'Abstract', 'Publication Date', 'Journal', 'Disease', 'Mutations', 'Treatments', 'Topics', 'Authors', 'Affiliations', 'Link'];\r\n        const csvRows = [headers.join(',')];\r\n\r\n        results.forEach((r: any) => {\r\n            const mutations = mutationsMap[r.id]?.join(', ') || '';\r\n            const topics = topicsMap[r.id]?.join(', ') || '';\r\n            const treatments = treatmentsMap[r.id]?.join(', ') || '';\r\n\r\n            const row = [\r\n                r.source_id || r.id,\r\n                `\"${(r.title || '').replace(/\"/g, '\"\"')}\"`, // Escape quotes\r\n                `\"${(r.abstract || '').replace(/\"/g, '\"\"')}\"`,\r\n                r.pub_date,\r\n                `\"${(r.journal || '').replace(/\"/g, '\"\"')}\"`,\r\n                `\"${(r.disease_subtype || '').replace(/\"/g, '\"\"')}\"`,\r\n                `\"${mutations.replace(/\"/g, '\"\"')}\"`,\r\n                `\"${treatments.replace(/\"/g, '\"\"')}\"`,\r\n                `\"${topics.replace(/\"/g, '\"\"')}\"`,\r\n                `\"${(r.authors || '').replace(/\"/g, '\"\"')}\"`,\r\n                `\"${(r.affiliations || '').replace(/\"/g, '\"\"')}\"`,\r\n                `https://pubmed.ncbi.nlm.nih.gov/${(r.source_id || '').replace('PMID:', '')}/`\r\n            ];\r\n            csvRows.push(row.join(','));\r\n        });\r\n\r\n        return c.text(csvRows.join('\\n'), 200, {\r\n            'Content-Type': 'text/csv',\r\n            'Content-Disposition': `attachment; filename=\"leukemialens_export_${new Date().toISOString().split('T')[0]}.csv\"`\r\n        });\r\n    } catch (e: any) {\r\n        return c.text(`Error exporting: ${e.message}`, 500);\r\n    }\r\n});\r\n\r\napp.get('/api/stats', async (c) => {\r\n    try {\r\n        const mutationStats = await c.env.DB.prepare(`\r\n            SELECT gene_symbol as name, COUNT(*) as count \r\n            FROM mutations \r\n            GROUP BY gene_symbol \r\n            ORDER BY count DESC \r\n            LIMIT 50\r\n        `).all();\r\n\r\n        let topicStats = { results: [] };\r\n        try {\r\n            topicStats = await c.env.DB.prepare(`\r\n                SELECT topic_name as name, COUNT(*) as count\r\n                FROM study_topics\r\n                GROUP BY topic_name\r\n                ORDER BY count DESC\r\n                LIMIT 50\r\n            `).all();\r\n        } catch (e) {\r\n            // Table may not exist yet or be empty\r\n            console.warn('study_topics query failed:', e);\r\n        }\r\n\r\n        let treatmentStats = { results: [] };\r\n        try {\r\n            treatmentStats = await c.env.DB.prepare(`\r\n                SELECT rt.code as name, rt.name as full_name, COUNT(*) as count\r\n                FROM treatments tr\r\n                JOIN ref_treatments rt ON tr.treatment_id = rt.id\r\n                GROUP BY rt.code, rt.name\r\n                ORDER BY count DESC\r\n                LIMIT 50\r\n            `).all();\r\n        } catch (e) {\r\n            // Table may not exist yet or be empty\r\n            console.warn('treatments query failed:', e);\r\n        }\r\n\r\n        // Transform\r\n        const mutations: Record<string, number> = {};\r\n        mutationStats.results?.forEach((r: any) => {\r\n            mutations[r.name] = r.count;\r\n        });\r\n\r\n        const tags: Record<string, number> = {};\r\n        topicStats.results?.forEach((r: any) => {\r\n            tags[r.name] = r.count;\r\n        });\r\n\r\n        const treatments: Record<string, number> = {};\r\n        treatmentStats.results?.forEach((r: any) => {\r\n            treatments[r.name] = r.count;\r\n        });\r\n\r\n        return c.json({\r\n            mutations,\r\n            tags,\r\n            treatments\r\n        });\r\n    } catch (e: any) {\r\n        return c.json({ error: e.message }, 500);\r\n    }\r\n});\r\n\r\napp.get('/api/ontology', async (c) => {\r\n    try {\r\n        const diseases = await c.env.DB.prepare(`\r\n            SELECT code, name \r\n            FROM ref_diseases \r\n            ORDER BY display_order\r\n        `).all();\r\n\r\n        const mutations = await c.env.DB.prepare(`\r\n            SELECT gene_symbol, name, category, risk_class, disease_relevance\r\n            FROM ref_mutations \r\n            ORDER BY display_order, gene_symbol\r\n        `).all();\r\n\r\n        const treatments = await c.env.DB.prepare(`\r\n            SELECT id, code, name, type, description, display_order\r\n            FROM ref_treatments\r\n            ORDER BY display_order, name\r\n        `).all();\r\n\r\n        const treatmentComponents = await c.env.DB.prepare(`\r\n            SELECT tc.protocol_id, tc.drug_id, \r\n                   p.code as protocol_code, \r\n                   d.code as drug_code\r\n            FROM ref_treatment_components tc\r\n            JOIN ref_treatments p ON tc.protocol_id = p.id\r\n            JOIN ref_treatments d ON tc.drug_id = d.id\r\n        `).all();\r\n\r\n        return c.json({\r\n            diseases: diseases.results || [],\r\n            mutations: mutations.results || [],\r\n            treatments: treatments.results || [],\r\n            treatment_components: treatmentComponents.results || []\r\n        });\r\n    } catch (e: any) {\r\n        return c.json({ error: e.message }, 500);\r\n    }\r\n});\r\n\r\napp.get('/api/database-stats', async (c) => {\r\n    try {\r\n        // Run all stats queries in parallel\r\n        const [\r\n            studiesCount,\r\n            mutationsCount,\r\n            topicsCount,\r\n            treatmentsCount,\r\n            refDiseases,\r\n            refMutations,\r\n            refTreatments,\r\n            uniqueMutations,\r\n            uniqueTopics,\r\n            dateRange\r\n        ] = await Promise.all([\r\n            c.env.DB.prepare('SELECT COUNT(*) as count FROM studies').all(),\r\n            c.env.DB.prepare('SELECT COUNT(*) as count FROM mutations').all(),\r\n            c.env.DB.prepare('SELECT COUNT(*) as count FROM study_topics').all(),\r\n            c.env.DB.prepare('SELECT COUNT(*) as count FROM treatments').all(),\r\n            c.env.DB.prepare('SELECT COUNT(*) as count FROM ref_diseases').all(),\r\n            c.env.DB.prepare('SELECT COUNT(*) as count FROM ref_mutations').all(),\r\n            c.env.DB.prepare('SELECT COUNT(*) as count FROM ref_treatments').all(),\r\n            c.env.DB.prepare('SELECT COUNT(DISTINCT gene_symbol) as count FROM mutations').all(),\r\n            c.env.DB.prepare('SELECT COUNT(DISTINCT topic_name) as count FROM study_topics').all(),\r\n            c.env.DB.prepare('SELECT MIN(pub_date) as min_date, MAX(pub_date) as max_date FROM studies WHERE pub_date IS NOT NULL').all()\r\n        ]);\r\n\r\n        const stats = {\r\n            main_tables: {\r\n                studies: studiesCount.results?.[0]?.count || 0,\r\n                mutation_records: mutationsCount.results?.[0]?.count || 0,\r\n                topic_records: topicsCount.results?.[0]?.count || 0,\r\n                treatment_records: treatmentsCount.results?.[0]?.count || 0\r\n            },\r\n            ontology_tables: {\r\n                reference_diseases: refDiseases.results?.[0]?.count || 0,\r\n                reference_mutations: refMutations.results?.[0]?.count || 0,\r\n                reference_treatments: refTreatments.results?.[0]?.count || 0\r\n            },\r\n            unique_values: {\r\n                unique_mutations: uniqueMutations.results?.[0]?.count || 0,\r\n                unique_topics: uniqueTopics.results?.[0]?.count || 0\r\n            },\r\n            date_range: {\r\n                oldest_article: dateRange.results?.[0]?.min_date || null,\r\n                newest_article: dateRange.results?.[0]?.max_date || null\r\n            },\r\n            generated_at: new Date().toISOString()\r\n        };\r\n\r\n        // Cache for 1 hour\r\n        return c.json(stats, 200, {\r\n            'Cache-Control': 'public, max-age=3600'\r\n        });\r\n    } catch (e: any) {\r\n        return c.json({ error: e.message }, 500);\r\n    }\r\n});\r\n\r\n// Monthly coverage statistics for backfill planning\r\napp.get('/api/coverage', async (c) => {\r\n    const { year } = c.req.query();\r\n\r\n    try {\r\n        let monthlyCoverage;\r\n\r\n        if (year) {\r\n            // Get monthly breakdown for a specific year\r\n            monthlyCoverage = await c.env.DB.prepare(`\r\n                SELECT \r\n                    strftime('%Y', pub_date) as year,\r\n                    strftime('%m', pub_date) as month,\r\n                    COUNT(*) as count\r\n                FROM studies \r\n                WHERE pub_date IS NOT NULL \r\n                  AND strftime('%Y', pub_date) = ?\r\n                GROUP BY year, month\r\n                ORDER BY year DESC, month DESC\r\n            `).bind(year).all();\r\n        } else {\r\n            // Get yearly summary with monthly breakdown\r\n            monthlyCoverage = await c.env.DB.prepare(`\r\n                SELECT \r\n                    strftime('%Y', pub_date) as year,\r\n                    strftime('%m', pub_date) as month,\r\n                    COUNT(*) as count\r\n                FROM studies \r\n                WHERE pub_date IS NOT NULL\r\n                GROUP BY year, month\r\n                ORDER BY year DESC, month DESC\r\n            `).all();\r\n        }\r\n\r\n        // Get yearly totals\r\n        const yearlyCoverage = await c.env.DB.prepare(`\r\n            SELECT \r\n                strftime('%Y', pub_date) as year,\r\n                COUNT(*) as count\r\n            FROM studies \r\n            WHERE pub_date IS NOT NULL\r\n            GROUP BY year\r\n            ORDER BY year DESC\r\n        `).all();\r\n\r\n        // Transform monthly data into a more usable structure\r\n        const monthlyByYear: Record<string, Record<string, number>> = {};\r\n        monthlyCoverage.results?.forEach((row: any) => {\r\n            if (!monthlyByYear[row.year]) {\r\n                monthlyByYear[row.year] = {};\r\n            }\r\n            monthlyByYear[row.year][row.month] = row.count;\r\n        });\r\n\r\n        // Build yearly summary with monthly details\r\n        const coverage = yearlyCoverage.results?.map((row: any) => {\r\n            const yearData = monthlyByYear[row.year] || {};\r\n            const months: Record<string, number> = {};\r\n\r\n            // Fill in all 12 months (0 for missing)\r\n            for (let m = 1; m <= 12; m++) {\r\n                const monthKey = m.toString().padStart(2, '0');\r\n                months[monthKey] = yearData[monthKey] || 0;\r\n            }\r\n\r\n            return {\r\n                year: row.year,\r\n                total: row.count,\r\n                months,\r\n                gaps: Object.entries(months)\r\n                    .filter(([_, count]) => count === 0)\r\n                    .map(([month]) => month)\r\n            };\r\n        }) || [];\r\n\r\n        // Calculate overall stats\r\n        const totalArticles = yearlyCoverage.results?.reduce((sum: number, row: any) => sum + row.count, 0) || 0;\r\n        const yearsWithData = yearlyCoverage.results?.length || 0;\r\n        const totalGaps = coverage.reduce((sum, y) => sum + y.gaps.length, 0);\r\n\r\n        return c.json({\r\n            summary: {\r\n                total_articles: totalArticles,\r\n                years_with_data: yearsWithData,\r\n                total_month_gaps: totalGaps\r\n            },\r\n            coverage,\r\n            generated_at: new Date().toISOString()\r\n        }, 200, {\r\n            'Cache-Control': 'public, max-age=1800'  // Cache for 30 minutes\r\n        });\r\n    } catch (e: any) {\r\n        return c.json({ error: e.message }, 500);\r\n    }\r\n});\r\n\r\napp.get('/api/news/:disease', async (c) => {\r\n    const disease = c.req.param('disease');\r\n    // Using a more specific query to get better results\r\n    const query = encodeURIComponent(`${disease} leukemia news`);\r\n    const url = `https://news.google.com/rss/search?q=${query}&hl=en-US&gl=US&ceid=US:en`;\r\n\r\n    try {\r\n        const response = await fetch(url, {\r\n            headers: {\r\n                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'\r\n            }\r\n        });\r\n        const xml = await response.text();\r\n\r\n        // Simple regex parsing for RSS item components\r\n        const items: any[] = [];\r\n        const itemMatches = xml.matchAll(/<item>([\\s\\S]*?)<\\/item>/g);\r\n\r\n        for (const match of itemMatches) {\r\n            const content = match[1];\r\n\r\n            // Helper to unescape XML entities\r\n            const unescape = (str: string) => {\r\n                return str\r\n                    .replace(/&amp;/g, '&')\r\n                    .replace(/&lt;/g, '<')\r\n                    .replace(/&gt;/g, '>')\r\n                    .replace(/&quot;/g, '\"')\r\n                    .replace(/&apos;/g, \"'\")\r\n                    .replace(/<!\\[CDATA\\[([\\s\\S]*?)\\]\\]>/g, '$1');\r\n            };\r\n\r\n            const title = unescape(content.match(/<title>([\\s\\S]*?)<\\/title>/)?.[1] || '');\r\n            const link = content.match(/<link>([\\s\\S]*?)<\\/link>/)?.[1] || '';\r\n            const pubDate = content.match(/<pubDate>([\\s\\S]*?)<\\/pubDate>/)?.[1] || '';\r\n            const source = unescape(content.match(/<source[^>]*>([\\s\\S]*?)<\\/source>/)?.[1] || '');\r\n\r\n            // Clean up titles (Google News often appends \" - Source\")\r\n            let cleanTitle = title;\r\n            if (source && title.endsWith(` - ${source}`)) {\r\n                cleanTitle = title.substring(0, title.length - (source.length + 3));\r\n            }\r\n\r\n            items.push({\r\n                title: cleanTitle,\r\n                link,\r\n                pubDate,\r\n                source\r\n            });\r\n\r\n            if (items.length >= 8) break;\r\n        }\r\n\r\n        return c.json(items, 200, {\r\n            'Cache-Control': 'public, max-age=3600' // Cache news for 1 hour\r\n        });\r\n    } catch (e: any) {\r\n        return c.json({ error: e.message }, 500);\r\n    }\r\n});\r\n\r\nexport default app;\r\n", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "import type { Middleware } from \"./common\";\n\ninterface JsonError {\n\tmessage?: string;\n\tname?: string;\n\tstack?: string;\n\tcause?: JsonError;\n}\n\nfunction reduceError(e: any): JsonError {\n\treturn {\n\t\tname: e?.name,\n\t\tmessage: e?.message ?? String(e),\n\t\tstack: e?.stack,\n\t\tcause: e?.cause === undefined ? undefined : reduceError(e.cause),\n\t};\n}\n\n// See comment in `bundle.ts` for details on why this is needed\nconst jsonError: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} catch (e: any) {\n\t\tconst error = reduceError(e);\n\t\treturn Response.json(error, {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"MF-Experimental-Error-Stack\": \"true\" },\n\t\t});\n\t}\n};\n\nexport default jsonError;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"C:\\\\Users\\\\jrrhi\\\\workspace\\\\LeukemiaLens\\\\workers\\\\api\\\\src\\\\index.ts\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"C:\\\\Users\\\\jrrhi\\\\workspace\\\\LeukemiaLens\\\\workers\\\\api\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-ensure-req-body-drained.ts\";\nimport * as __MIDDLEWARE_1__ from \"C:\\\\Users\\\\jrrhi\\\\workspace\\\\LeukemiaLens\\\\workers\\\\api\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-miniflare3-json-error.ts\";\n\n\t\t\t\texport * from \"C:\\\\Users\\\\jrrhi\\\\workspace\\\\LeukemiaLens\\\\workers\\\\api\\\\src\\\\index.ts\";\n\t\t\t\tconst MIDDLEWARE_TEST_INJECT = \"__INJECT_FOR_TESTING_WRANGLER_MIDDLEWARE__\";\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default,__MIDDLEWARE_1__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"C:\\\\Users\\\\jrrhi\\\\workspace\\\\LeukemiaLens\\\\workers\\\\api\\\\.wrangler\\\\tmp\\\\bundle-IpD7yv\\\\middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"C:\\\\Users\\\\jrrhi\\\\workspace\\\\LeukemiaLens\\\\workers\\\\api\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\common.ts\";\nimport type { WorkerEntrypointConstructor } from \"C:\\\\Users\\\\jrrhi\\\\workspace\\\\LeukemiaLens\\\\workers\\\\api\\\\.wrangler\\\\tmp\\\\bundle-IpD7yv\\\\middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"C:\\\\Users\\\\jrrhi\\\\workspace\\\\LeukemiaLens\\\\workers\\\\api\\\\.wrangler\\\\tmp\\\\bundle-IpD7yv\\\\middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": "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",
  "names": ["path", "match", "path", "path", "raw", "path", "app", "path", "path2", "path", "path", "path2", "path", "Node", "path", "Node", "path", "Hono", "match", "Page", "client", "fetch", "path", "match", "_BetaMessageStream_getFinalMessage", "_BetaMessageStream_getFinalText", "_BetaMessageStream_beginRequest", "_BetaMessageStream_addStreamEvent", "_BetaMessageStream_endRequest", "_BetaMessageStream_accumulateMessage", "chunk", "_BetaToolRunner_checkAndCompact", "_a", "_BetaToolRunner_generateToolResponse", "JSON_BUF_PROPERTY", "tracksToolInput", "_MessageStream_getFinalMessage", "_MessageStream_getFinalText", "_MessageStream_beginRequest", "_MessageStream_addStreamEvent", "checkNever", "_MessageStream_endRequest", "_MessageStream_accumulateMessage", "chunk", "Batches", "Messages", "Batches", "DEPRECATED_MODELS", "Models", "path", "opts", "retryMessage", "err", "Page", "Messages", "Models", "Hono", "match"]
}
